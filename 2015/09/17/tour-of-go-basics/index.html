<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bing WebMaster -->
  <meta name="msvalidate.01" content="AB2FFF876C37F59D9121882CC8395DE5" />

  <title>Tour of Go - Basics</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://blog.codefarm.me/2015/09/17/tour-of-go-basics/">
  <link rel="alternate" type="application/rss+xml" title="CODE FARM" href="https://blog.codefarm.me/feed.xml">

  <!-- https://cdn.jsdelivr.net/gh/lurongkai/anti-baidu/js/anti-baidu-latest.min.js -->
<script type="text/javascript" src="/js/anti-baidu.min.js" charset="UTF-8"></script>

  
<!-- Google Analytics Website tracking -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83971182-1', 'auto');
  ga('send', 'pageview');

</script>


  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SN88FJ18E5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SN88FJ18E5');
</script>



</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <h2 class="site-title">
      <a class="site-title" href="/">CODE FARM</a>
    </h2>

     <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
        <div class="trigger">
            <ul>
                <li><a href="/">home</a>
                <li><a href="/category">category</a>
                <li><a href="/tag">tag</a>
                <li><a href="/archive">archive</a>
                <li><a href="/about">about</a>
                <li><a href="https://resume.github.io/?qqbuby" target="_blank">R&eacute;sum&eacute;</a>
            </ul>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Tour of Go - Basics</h1>
    
    
    <p class="post-meta"><time datetime="2015-09-17T19:08:50+08:00" itemprop="datePublished">Sep 17, 2015</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h2 id="packages-variables-and-function">Packages, variables, and function</h2>

<h3 id="packages">Packages</h3>

<p>Every Go program is made up of packages.</p>

<p>Programs start running in package <code class="language-plaintext highlighter-rouge">main</code>.</p>

<p>This program is using the packages with import paths <code class="language-plaintext highlighter-rouge">"fmt"</code> and <code class="language-plaintext highlighter-rouge">"math/rand"</code>.</p>

<p>By convention, the package name is the same as the last element of the import path. For instance, the <code class="language-plaintext highlighter-rouge">"math/rand"</code> package comprises files that begin with the statement package <code class="language-plaintext highlighter-rouge">rand</code>.</p>

<p><strong><em>Note</em></strong>: the environment in which these programs are executed is deterministic, so <code class="language-plaintext highlighter-rouge">rand.Intn</code> will always return the same number. (To see a different number, seed the number generator; see <code class="language-plaintext highlighter-rouge">rand.Seed</code>.)</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"fmt"</span>
    <span class="s">"math/rand"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"My favorite number is "</span><span class="p">,</span> <span class="n">rand</span><span class="o">.</span><span class="n">Intn</span><span class="p">(</span><span class="m">10</span><span class="p">))</span>
    <span class="c">//fmt.Println(rand.Seed(1))</span>
<span class="p">}</span></code></pre></figure>

<h3 id="imports">Imports</h3>

<p>This code groups the imports into a parenthesized, “factored” import statement.</p>

<p>You can also write multiple import statements, like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import "fmt"
import "math"
</code></pre></div></div>

<p>But it is good style to use the factored import statement.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"fmt"</span>
    <span class="s">"math"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Now you have %g problems."</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">Nextafter</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">))</span>
<span class="p">}</span></code></pre></figure>

<h3 id="exported-names">Exported names</h3>

<p>After importing a package, you can refer to the names it exports.</p>

<p>In Go, a name is exported if it begins with <em>a capital letter</em>.</p>

<p><code class="language-plaintext highlighter-rouge">Foo</code> is an exported name, as is <code class="language-plaintext highlighter-rouge">FOO</code>. The name foo is not exported.</p>

<p>Run the code. Then rename <code class="language-plaintext highlighter-rouge">math.pi</code> to <code class="language-plaintext highlighter-rouge">math.Pi</code> and try it again.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"fmt"</span>
    <span class="s">"math"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="functions">Functions</h3>

<p>A function can take zero or more arguments.</p>

<p>In this example, add takes two parameters of type int.</p>

<p>Notice that the type comes after the variable name.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">add</span><span class="p">(</span><span class="n">x</span> <span class="kt">int</span><span class="p">,</span> <span class="n">y</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="m">42</span><span class="p">,</span> <span class="m">13</span><span class="p">))</span>
<span class="p">}</span></code></pre></figure>

<h3 id="functions-continued">Functions continued</h3>

<p>When two or more consecutive named function parameters share a type, you can omit the type from all but the last.</p>

<p>In this example, we shortened</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x int, y int
</code></pre></div></div>

<p>to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x, y int
</code></pre></div></div>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="m">42</span><span class="p">,</span> <span class="m">13</span><span class="p">))</span>
<span class="p">}</span></code></pre></figure>

<h3 id="multiple-results">Multiple results</h3>

<p>A function can return any number of results.</p>

<p>The <code class="language-plaintext highlighter-rouge">swap</code> function returns two strings.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">swap</span><span class="p">(</span><span class="s">"hello"</span><span class="p">,</span> <span class="s">"world"</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="named-return-values">Named return values</h3>

<p>Go’s <code class="language-plaintext highlighter-rouge">return</code> values may be named and act just like variables.</p>

<p>These names should be used to document the meaning of the return values.</p>

<p>A return statement without arguments returns the current values of the results. This is known as a “naked” return.</p>

<p>Naked return statements should be used only in short functions, as with the example shown here. They can harm readability in longer functions</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">split</span><span class="p">(</span><span class="n">sum</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">x</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">*</span> <span class="m">4</span> <span class="o">/</span> <span class="m">9</span>
	<span class="n">y</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">-</span> <span class="n">x</span>
	<span class="k">return</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">foo</span><span class="p">()</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">x</span> <span class="o">=</span> <span class="m">1</span>
	<span class="n">y</span> <span class="o">=</span> <span class="m">2</span>
	<span class="n">z</span> <span class="o">=</span> <span class="m">3</span>
	<span class="k">return</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="m">17</span><span class="p">))</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">foo</span><span class="p">())</span>
<span class="p">}</span></code></pre></figure>

<h3 id="variables">Variables</h3>

<p>The <code class="language-plaintext highlighter-rouge">var</code> statement declares a list of variables; as in function argument lists, the type is last.</p>

<p>A <code class="language-plaintext highlighter-rouge">var</code> statement can be at package or function level. We see both in this example.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">var</span> <span class="n">c</span><span class="p">,</span> <span class="n">python</span><span class="p">,</span> <span class="n">java</span> <span class="kt">bool</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">i</span> <span class="kt">int</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">python</span><span class="p">,</span> <span class="n">java</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="variables-with-initializers">Variables with initializers</h3>

<p>A <code class="language-plaintext highlighter-rouge">var</code> declaration can include initializers, one per variable.</p>

<p>If an initializer is present, the type can be omitted; the variable will take the type of the initializer.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">var</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span>
<span class="k">var</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">"hello"</span><span class="p">,</span> <span class="m">100</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">c</span><span class="p">,</span> <span class="n">python</span><span class="p">,</span> <span class="n">java</span> <span class="o">=</span> <span class="no">true</span><span class="p">,</span> <span class="no">false</span><span class="p">,</span> <span class="s">"no!"</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">python</span><span class="p">,</span> <span class="n">java</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="short-variable-declarations">Short variable declarations#</h3>

<p>Inside a function, the <em>:=</em> short assignment statement can be used in place of a <code class="language-plaintext highlighter-rouge">var</code> declaration with implicit type.</p>

<p>Outside a function, every statement begins with a keyword (<code class="language-plaintext highlighter-rouge">var</code>, <code class="language-plaintext highlighter-rouge">func</code>, and so on) and so the <em>:=</em> construct is not available.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="kt">int</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span>
	<span class="n">k</span> <span class="o">:=</span> <span class="m">3</span>
	<span class="n">c</span><span class="p">,</span> <span class="n">python</span><span class="p">,</span> <span class="n">java</span> <span class="o">:=</span> <span class="no">true</span><span class="p">,</span> <span class="no">false</span><span class="p">,</span> <span class="s">"no!"</span>

	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">python</span><span class="p">,</span> <span class="n">java</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="basic-types">Basic types</h3>

<p>Go’s basic types are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bool

string

int  int8  int16  int32  int64
uint uint8 uint16 uint32 uint64 uintptr

byte // alias for uint8

rune // alias for int32
     // represents a Unicode code point

float32 float64

complex64 complex128
</code></pre></div></div>

<p>The example shows variables of several types, and also that variable declarations may be “factored” into blocks, as with import statements.</p>

<p>The <code class="language-plaintext highlighter-rouge">int</code>, <code class="language-plaintext highlighter-rouge">uint</code>, and <code class="language-plaintext highlighter-rouge">uintptr</code> types are usually 32 bits wide on 32-bit systems and 64 bits wide on 64-bit systems. When you need an integer value you should use <code class="language-plaintext highlighter-rouge">int</code> unless you have a specific reason to use a sized or unsigned integer type.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"math/cmplx"</span>
<span class="p">)</span>

<span class="k">var</span> <span class="p">(</span>
	<span class="n">ToBe</span>   <span class="kt">bool</span>       <span class="o">=</span> <span class="no">false</span>
	<span class="n">MaxInt</span> <span class="kt">uint64</span>     <span class="o">=</span> <span class="m">1</span><span class="o">&lt;&lt;</span><span class="m">64</span> <span class="o">-</span> <span class="m">1</span>
	<span class="n">z</span>      <span class="kt">complex128</span> <span class="o">=</span> <span class="n">cmplx</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="o">-</span><span class="m">5</span> <span class="o">+</span> <span class="m">12i</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">const</span> <span class="n">f</span> <span class="o">=</span> <span class="s">"%T(%v)</span><span class="se">\n</span><span class="s">"</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ToBe</span><span class="p">,</span> <span class="n">ToBe</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">MaxInt</span><span class="p">,</span> <span class="n">MaxInt</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="zero-values">Zero values</h3>

<p>Variables declared without an explicit initial value are given their zero value.</p>

<p>The zero value is:</p>

<blockquote>
  <p>0 for numeric types,
false the boolean type, and
“” (the empty string) for strings.</p>
</blockquote>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">i</span> <span class="kt">int</span>
    <span class="k">var</span> <span class="n">f</span> <span class="kt">float64</span>
    <span class="k">var</span> <span class="n">b</span> <span class="kt">bool</span>
    <span class="k">var</span> <span class="n">s</span> <span class="kt">string</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%v %v %v %v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="type-conversions">Type conversions</h3>

<p>The expression <code class="language-plaintext highlighter-rouge">T(v)</code> converts the value <code class="language-plaintext highlighter-rouge">v</code> to the type <code class="language-plaintext highlighter-rouge">T</code>.</p>

<p>Some numeric conversions:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var i int = 42
var f float64 = float64(i)
var u uint = uint(f)
</code></pre></div></div>

<p>Or, put more simply:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>i := 42
f := float64(i)
u := uint(f)
</code></pre></div></div>

<p>Unlike in C, in Go assignment between items of different type requires an explicit conversion. Try removing the <code class="language-plaintext highlighter-rouge">float64</code> or <code class="language-plaintext highlighter-rouge">int</code> conversions in the example and see what happens.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"math"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="kt">int</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span>
	<span class="k">var</span> <span class="n">f</span> <span class="kt">float64</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="kt">float64</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">))</span>
	<span class="k">var</span> <span class="n">z</span> <span class="kt">int</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="type-inference">Type inference</h3>

<p>When declaring a variable without specifying an explicit type (either by using the <code class="language-plaintext highlighter-rouge">:=</code> syntax or <code class="language-plaintext highlighter-rouge">var =</code> expression syntax), the variable’s type is inferred from the value on the right hand side.</p>

<p>When the right hand side of the declaration is typed, the new variable is of that same type:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var i int
j := i // j is an int
</code></pre></div></div>

<p>But when the right hand side contains an untyped numeric constant, the new variable may be an <code class="language-plaintext highlighter-rouge">int</code>, <code class="language-plaintext highlighter-rouge">float64</code>, or <code class="language-plaintext highlighter-rouge">complex128</code> depending on the precision of the constant:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>i := 42           // int
f := 3.142        // float64
g := 0.867 + 0.5i // complex128
</code></pre></div></div>

<p>Try changing the initial value of <code class="language-plaintext highlighter-rouge">v</code> in the example code and observe how its type is affected.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">v</span> <span class="o">:=</span> <span class="s">"pgg"</span> <span class="c">// change me!</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"v is of type %T</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="constants">Constants</h3>

<p>Constants are declared like variables, but with the <code class="language-plaintext highlighter-rouge">const</code> keyword.</p>

<p>Constants can be character, string, boolean, or numeric values.</p>

<p>Constants cannot be declared using the := syntax.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">const</span> <span class="n">Pi</span> <span class="o">=</span> <span class="m">3.14</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">const</span> <span class="n">World</span> <span class="o">=</span> <span class="s">"世界"</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">,</span> <span class="n">World</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Happy"</span><span class="p">,</span> <span class="n">Pi</span><span class="p">,</span> <span class="s">"Day"</span><span class="p">)</span>

	<span class="k">const</span> <span class="n">Truth</span> <span class="o">=</span> <span class="no">true</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Go rules?"</span><span class="p">,</span> <span class="n">Truth</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="numeric-constants">Numeric Constants</h3>

<p>Numeric constants are high-precision values.</p>

<p>An untyped constant takes the type needed by its context.</p>

<p>Try printing <code class="language-plaintext highlighter-rouge">needInt(Big)</code> too.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">const</span> <span class="p">(</span>
	<span class="n">Big</span>   <span class="o">=</span> <span class="m">1</span> <span class="o">&lt;&lt;</span> <span class="m">100</span>
	<span class="n">Small</span> <span class="o">=</span> <span class="n">Big</span> <span class="o">&gt;&gt;</span> <span class="m">99</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">needInt</span><span class="p">(</span><span class="n">x</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span> <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="m">10</span> <span class="o">+</span> <span class="m">1</span> <span class="p">}</span>
<span class="k">func</span> <span class="n">needFloat</span><span class="p">(</span><span class="n">x</span> <span class="kt">float64</span><span class="p">)</span> <span class="kt">float64</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="m">0.1</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">needInt</span><span class="p">(</span><span class="n">Small</span><span class="p">))</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">needFloat</span><span class="p">(</span><span class="n">Small</span><span class="p">))</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">needFloat</span><span class="p">(</span><span class="n">Big</span><span class="p">))</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">needInt</span><span class="p">(</span><span class="kt">int</span><span class="p">(</span><span class="n">Big</span><span class="p">)))</span>
<span class="p">}</span></code></pre></figure>

<h2 id="flow-control-statements-for-if-else-switch-and-defe">Flow control statements: for, if, else, switch and defe</h2>

<h3 id="for">For</h3>

<p>Go has only one looping construct, the <code class="language-plaintext highlighter-rouge">for</code> loop.</p>

<p>The basic for loop looks as it does in C or Java, except that the <em>( )</em> are gone (they are not even optional) and the <code class="language-plaintext highlighter-rouge">{ }</code> are required.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">sum</span> <span class="o">:=</span> <span class="m">0</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">sum</span> <span class="o">+=</span> <span class="m">1</span>
	<span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">sum</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="for-continued">For continued</h3>

<p>As in C or Java, you can leave the pre and post statements empty.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">sum</span> <span class="o">:=</span> <span class="m">1</span>
	<span class="k">for</span> <span class="p">;</span> <span class="n">sum</span> <span class="o">&lt;</span> <span class="m">1000</span> <span class="p">;</span> <span class="p">{</span>
		<span class="n">sum</span> <span class="o">+=</span> <span class="n">sum</span>
	<span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">sum</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="for-is-gos-while">For is Go’s “while”</h3>

<p>At that point you can drop the semicolons: C’s while is spelled for in Go.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">sum</span> <span class="o">:=</span> <span class="m">1</span>
	<span class="k">for</span> <span class="n">sum</span> <span class="o">&lt;</span> <span class="m">1000</span> <span class="p">{</span>
		<span class="n">sum</span> <span class="o">+=</span> <span class="n">sum</span>
	<span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">sum</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="forever">Forever</h3>

<p>If you omit the loop condition it loops forever, so an infinite loop is compactly expressed.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">i</span> <span class="kt">int</span> <span class="o">=</span> <span class="m">10</span>
	<span class="k">for</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Hello TOM!"</span><span class="p">)</span>
		<span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="m">1</span>
		<span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="p">{</span>
			<span class="k">break</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="if">If</h3>

<p>The <code class="language-plaintext highlighter-rouge">if</code> statement looks as it does in C or Java, except that the <em>( )</em> are gone and the <em>{ }</em> are required.</p>

<p>(Sound familiar?)</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"math"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="kt">float64</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
	<span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s">"i"</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprint</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="m">2</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="m">4</span><span class="p">))</span>
<span class="p">}</span></code></pre></figure>

<h3 id="if-with-a-short-statement">If with a short statement</h3>

<p>Like for, the <code class="language-plaintext highlighter-rouge">if</code> statement can start with a short statement to execute before the condition.</p>

<p>Variables declared by the statement are only in scope until the end of the <code class="language-plaintext highlighter-rouge">if</code>.</p>

<p>(Try using <code class="language-plaintext highlighter-rouge">v</code> in the last <code class="language-plaintext highlighter-rouge">return</code> statement.)</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"math"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">lim</span> <span class="kt">float64</span><span class="p">)</span> <span class="kt">float64</span> <span class="p">{</span>
	<span class="n">v</span> <span class="o">:=</span> <span class="m">1</span>
	<span class="k">if</span> <span class="n">v</span> <span class="o">:=</span> <span class="n">math</span><span class="o">.</span><span class="n">Pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">lim</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">v</span>
	<span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">lim</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span>
		<span class="n">pow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span>
		<span class="n">pow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">20</span><span class="p">))</span>
<span class="p">}</span></code></pre></figure>

<h3 id="if-and-else">If and else</h3>

<p>Variables declared inside an <code class="language-plaintext highlighter-rouge">if</code> short statement are also available inside any of the <code class="language-plaintext highlighter-rouge">else</code> blocks.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"math"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">lim</span> <span class="kt">float64</span><span class="p">)</span> <span class="kt">float64</span> <span class="p">{</span>
	<span class="k">if</span> <span class="n">v</span> <span class="o">:=</span> <span class="n">math</span><span class="o">.</span><span class="n">Pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">lim</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">v</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">x</span> <span class="o">:=</span> <span class="m">100</span>


		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%g &gt;= %g</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">lim</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="c">// can't use v here, though</span>
	<span class="k">return</span> <span class="n">lim</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span>
		<span class="n">pow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span>
		<span class="n">pow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">20</span><span class="p">),</span>
	<span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="switch">Switch</h3>

<p>You probably knew what <code class="language-plaintext highlighter-rouge">switch</code> was going to look like.</p>

<p>A case body breaks automatically, unless it ends with a <code class="language-plaintext highlighter-rouge">fallthrough</code> statement.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"runtime"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="s">"Go runs on "</span><span class="p">)</span>
	<span class="k">switch</span> <span class="n">os</span> <span class="o">:=</span> <span class="n">runtime</span><span class="o">.</span><span class="n">GOOS</span><span class="p">;</span> <span class="n">os</span> <span class="p">{</span>
	<span class="k">case</span> <span class="s">"darwin"</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"OS X."</span><span class="p">)</span>
	<span class="k">case</span> <span class="s">"linux"</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Linux."</span><span class="p">)</span>
	<span class="k">default</span><span class="o">:</span>
		<span class="c">// freebsd, openbsd,</span>
		<span class="c">// plan9, windows...</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="s">"%s."</span><span class="p">,</span> <span class="n">os</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="switch-evaluation-order">Switch evaluation order</h3>

<p>Switch cases evaluate cases from top to bottom, stopping when a case succeeds.</p>

<p>(For example,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>switch i {
case 0:
case f():
}
</code></pre></div></div>

<p>does not call <code class="language-plaintext highlighter-rouge">f</code> if <code class="language-plaintext highlighter-rouge">i==0</code>.)</p>

<p><strong>Note</strong>: Time in the Go playground always appears to start at 2009-11-10 23:00:00 UTC, a value whose significance is left as an exercise for the reader.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"time"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"When's Saturday?"</span><span class="p">)</span>
	<span class="n">today</span> <span class="o">:=</span> <span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="o">.</span><span class="n">Weekday</span><span class="p">()</span>
	<span class="k">switch</span> <span class="n">time</span><span class="o">.</span><span class="n">Saturday</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">today</span> <span class="o">+</span> <span class="m">0</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Today."</span><span class="p">)</span>
	<span class="k">case</span> <span class="n">today</span> <span class="o">+</span> <span class="m">1</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Tomorrow."</span><span class="p">)</span>
	<span class="k">case</span> <span class="n">today</span> <span class="o">+</span> <span class="m">2</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"In two days."</span><span class="p">)</span>
	<span class="k">default</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Too far away."</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Switch with no condition</p>

<p>Switch without a condition is the same as <code class="language-plaintext highlighter-rouge">switch true</code>.</p>

<p>This construct can be a clean way to write long if-then-else chains.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"time"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">t</span> <span class="o">:=</span> <span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span>
	<span class="k">switch</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">t</span><span class="o">.</span><span class="n">Hour</span><span class="p">()</span> <span class="o">&lt;</span> <span class="m">12</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Good morning!"</span><span class="p">)</span>
	<span class="k">case</span> <span class="n">t</span><span class="o">.</span><span class="n">Hour</span><span class="p">()</span> <span class="o">&lt;</span> <span class="m">17</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Good afternoon!"</span><span class="p">)</span>
	<span class="k">default</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Good evening."</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="defer">Defer</h3>

<p>A <code class="language-plaintext highlighter-rouge">defer</code> statement defers the execution of a function until the surrounding function returns.</p>

<p>The deferred call’s arguments are evaluated immediately, but the function call is not executed until the surrounding function returns.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">defer</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"world"</span><span class="p">)</span>

	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"hello"</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="stacking-defers">Stacking defers</h3>

<p>Deferred function calls are pushed onto a stack. When a function returns, its deferred calls are executed in last-in-first-out order.</p>

<p>To learn more about defer statements read this <a href="http://blog.golang.org/defer-panic-and-recover">blog post</a>.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"counting"</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="k">defer</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"done"</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h2 id="more-types-structs-slices-and-map">More types: structs, slices, and map</h2>

<h3 id="pointers">Pointers</h3>

<p>Go has pointers. A pointer holds the memory address of a variable.</p>

<p>The type <code class="language-plaintext highlighter-rouge">*T</code> is a pointer to a T value. Its zero value is <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var p *int
</code></pre></div></div>

<p>The <em>&amp;</em> operator generates a pointer to its operand.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>i := 42
p = &amp;i
</code></pre></div></div>

<p>The <em>*</em> operator denotes the pointer’s underlying value.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fmt.Println(*p) // read i through the pointer p
*p = 21         // set i through the pointer p
</code></pre></div></div>

<p>This is known as “dereferencing” or “indirecting”.</p>

<p>Unlike C, Go has no pointer arithmetic.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">p</span> <span class="o">*</span><span class="kt">int</span>
	<span class="n">i</span> <span class="o">:=</span> <span class="m">10</span>
	<span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">i</span>
	<span class="o">*</span><span class="n">p</span> <span class="o">+=</span> <span class="m">10</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="structs">Structs</h3>

<p>A <code class="language-plaintext highlighter-rouge">struct</code> is a collection of fields.</p>

<p>(And a <code class="language-plaintext highlighter-rouge">type</code> declaration does what you’d expect.)</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">type</span> <span class="n">Vertex</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">X</span> <span class="kt">int</span>
	<span class="n">Y</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">Foo</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">B</span>    <span class="kt">int</span>
	<span class="n">A</span><span class="p">,</span> <span class="n">R</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">Vertex</span><span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">})</span>
	<span class="k">var</span> <span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="struct-fields">Struct Fields</h3>

<p>Struct fields are accessed using a <em>dot</em>.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">type</span> <span class="n">Vertex</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">X</span> <span class="kt">int</span>
	<span class="n">Y</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">v</span> <span class="o">:=</span> <span class="n">Vertex</span><span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">}</span>
	<span class="n">v</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="m">4</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="pointers-to-structs">Pointers to structs</h3>

<p>Struct fields can be accessed through a struct pointer.</p>

<p>The indirection through the pointer is transparent.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">type</span> <span class="n">Vertex</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">X</span> <span class="kt">int</span>
	<span class="n">Y</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">v</span> <span class="o">:=</span> <span class="n">Vertex</span><span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">}</span>
	<span class="n">p</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">v</span>
	<span class="n">p</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="m">1e9</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<p>Struct Literals</p>

<p>A struct literal denotes a newly allocated struct value by listing the values of its fields.</p>

<p>You can list just a subset of fields by using the <em>Name:</em> syntax. (And the order of named fields is irrelevant.)</p>

<p>The special prefix <em>&amp;</em> returns a pointer to the struct value.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">type</span> <span class="n">Vertex</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="k">var</span> <span class="p">(</span>
	<span class="n">v1</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">}</span>  <span class="c">// has type Vertex</span>
	<span class="n">v2</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">{</span><span class="n">X</span><span class="o">:</span> <span class="m">1</span><span class="p">}</span>  <span class="c">// Y:0 is implicit</span>
	<span class="n">v3</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">{}</span>      <span class="c">// X:0 and Y:0</span>
	<span class="n">p</span>  <span class="o">=</span> <span class="o">&amp;</span><span class="n">Vertex</span><span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">}</span> <span class="c">// has type *Vertex</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
	<span class="k">var</span> <span class="n">v4</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">{</span><span class="n">Y</span><span class="o">:</span> <span class="m">10</span><span class="p">,</span> <span class="n">X</span><span class="o">:</span> <span class="m">11</span><span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v4</span><span class="p">))</span>
<span class="p">}</span></code></pre></figure>

<h3 id="arrays">Arrays</h3>

<p>The type <em>[n]T</em> is an array of n values of type <em>T</em>.</p>

<p>The expression</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var a [10]int
</code></pre></div></div>

<p>declares a variable <em>a</em> as an array of ten integers.</p>

<p>An array’s length is part of its type, so arrays cannot be resized. This seems limiting, but don’t worry; Go provides a convenient way of working with arrays.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">a</span> <span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="kt">string</span>
	<span class="n">a</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Hello"</span>
	<span class="n">a</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">"World"</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="m">1</span><span class="p">])</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
	<span class="k">var</span> <span class="n">b</span> <span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="kt">int</span>
	<span class="n">b</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="o">=</span> <span class="m">1</span>
	<span class="n">b</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">=</span> <span class="m">2</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%T,%v"</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="slices">Slices</h3>

<p>A <em>slice</em> points to an <em>array</em> of values and also includes a length.</p>

<p><em>[]T</em> is a slice with elements of type <em>T</em>.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span><span class="kt">int</span><span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">7</span><span class="p">}</span>
	<span class="k">var</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
	<span class="p">}</span>
	<span class="n">s1</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="o">=</span> <span class="m">10</span>

	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="slicing-slices">Slicing slices</h3>

<p>Slices can be re-sliced, creating a new <em>slice</em> value that points to the same array.</p>

<p>The expression</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s[lo:hi]
</code></pre></div></div>

<p>evaluates to a slice of the elements from <code class="language-plaintext highlighter-rouge">lo</code> through <code class="language-plaintext highlighter-rouge">hi-1</code>, inclusive. Thus</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s[lo:lo]
</code></pre></div></div>

<p>is empty and</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s[lo:lo+1]
</code></pre></div></div>

<p>has one element.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">s</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">13</span><span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"s =="</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"s[1:4] =="</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span>

	<span class="c">// missing low index implies 0</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"s[:3] =="</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="o">:</span><span class="m">3</span><span class="p">])</span>

	<span class="c">// missing high index implies len(s)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"s[4:] =="</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="m">4</span><span class="o">:</span><span class="p">])</span>
<span class="p">}</span></code></pre></figure>

<h3 id="making-slices">Making slices</h3>

<p>Slices are created with the <code class="language-plaintext highlighter-rouge">make</code> function. It works by allocating a zeroed array and returning a slice that refers to that array:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a := make([]int, 5)  // len(a)=5
</code></pre></div></div>

<p>To specify a capacity, pass a third argument to <code class="language-plaintext highlighter-rouge">make</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>b := make([]int, 0, 5) // len(b)=0, cap(b)=5

b = b[:cap(b)] // len(b)=5, cap(b)=5
b = b[1:]      // len(b)=4, cap(b)=4
</code></pre></div></div>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">a</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
	<span class="n">b</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
	<span class="n">c</span> <span class="o">:=</span> <span class="n">a</span><span class="p">[</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
	<span class="n">d</span> <span class="o">:=</span> <span class="n">b</span><span class="p">[</span><span class="o">:</span><span class="m">2</span><span class="p">]</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="nil-slices">Nil slices</h3>

<p>The zero value of a slice is <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<p>A nil slice has a length and capacity of 0.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">z</span> <span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="kt">int</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="nb">cap</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
	<span class="c">//if z == nil {</span>
    	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"nil!"</span><span class="p">)</span>
	<span class="c">//}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="adding-elements-to-a-slice">Adding elements to a slice</h3>

<p>It is common to append new elements to a slice, and so Go provides a built-in <code class="language-plaintext highlighter-rouge">append</code> function. The <a href="http://golang.org/pkg/builtin/#append">documentation</a> of the built-in package describes <code class="language-plaintext highlighter-rouge">append</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func append(s []T, vs ...T) []T
</code></pre></div></div>

<p>The first parameter <code class="language-plaintext highlighter-rouge">s</code> of <code class="language-plaintext highlighter-rouge">append</code> is a slice of type <em>T</em>, and the rest are T values to append to the slice.</p>

<p>The resulting value of <code class="language-plaintext highlighter-rouge">append</code> is a slice containing all the elements of the original slice plus the provided values.</p>

<p>If the backing array of <code class="language-plaintext highlighter-rouge">s</code> is too small to fit all the given values a bigger array will be allocated. The returned slice will point to the newly allocated array.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">a</span> <span class="p">[]</span><span class="kt">int</span>
	<span class="n">printSlice</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

	<span class="c">// append works on nil slices.</span>
	<span class="n">a</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
	<span class="n">printSlice</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

	<span class="c">// the slice grows as needed.</span>
	<span class="n">a</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
	<span class="n">printSlice</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

	<span class="c">// we can add more than one element at a time.</span>
	<span class="n">a</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
	<span class="n">printSlice</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">printSlice</span><span class="p">(</span><span class="n">s</span> <span class="kt">string</span><span class="p">,</span> <span class="n">x</span> <span class="p">[]</span><span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%s len=%d cap=%d %v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span>
		<span class="n">s</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">cap</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="range">Range</h3>

<p>The <code class="language-plaintext highlighter-rouge">range</code> form of the <code class="language-plaintext highlighter-rouge">for</code> loop iterates over a <code class="language-plaintext highlighter-rouge">slice</code> or <code class="language-plaintext highlighter-rouge">map</code>.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">var</span> <span class="n">pow</span> <span class="o">=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">16</span><span class="p">,</span> <span class="m">32</span><span class="p">,</span> <span class="m">64</span><span class="p">,</span> <span class="m">128</span><span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">pow</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"2**%d = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="range-continued">Range continued</h3>

<p>You can skip the index or value by assigning to <em>_</em>.</p>

<p>If you only want the index, drop the “, value” entirely.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">pow</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">float64</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">pow</span> <span class="p">{</span>
		<span class="c">// invalid operation: 1 &lt;&lt; uint(i) (shift of type float64)</span>
		<span class="c">// pow[i] = float64(1&lt;&lt;uint(i)) + 0.1</span>
		<span class="n">j</span> <span class="o">:=</span> <span class="m">1</span> <span class="o">&lt;&lt;</span> <span class="kt">uint</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
		<span class="n">pow</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kt">float64</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="m">0.1</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">pow</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="maps">Maps</h3>

<p>A <code class="language-plaintext highlighter-rouge">map</code> maps keys to values.</p>

<p>Maps must be created with <code class="language-plaintext highlighter-rouge">make</code> (not new) before use; the <code class="language-plaintext highlighter-rouge">nil</code> map is empty and cannot be assigned to.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">type</span> <span class="n">Vertex</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">Lat</span><span class="p">,</span> <span class="n">Long</span> <span class="kt">float64</span>
<span class="p">}</span>

<span class="k">var</span> <span class="n">m</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="n">Vertex</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">m</span> <span class="o">=</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="n">Vertex</span><span class="p">)</span>
	<span class="n">m</span><span class="p">[</span><span class="s">"Bell Labs"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">{</span>
		<span class="m">40.68433</span><span class="p">,</span> <span class="o">-</span><span class="m">74.39967</span><span class="p">,</span>
	<span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s">"Bell Labs"</span><span class="p">])</span>
<span class="p">}</span></code></pre></figure>

<h3 id="map-literals">Map literals</h3>

<p>Map literals are like <code class="language-plaintext highlighter-rouge">struct</code> literals, but the keys are required.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">type</span> <span class="n">Vertex</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">Lat</span><span class="p">,</span> <span class="n">Long</span> <span class="kt">float64</span>
<span class="p">}</span>

<span class="k">var</span> <span class="n">m</span> <span class="o">=</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="n">Vertex</span><span class="p">{</span>
	<span class="s">"Bell Labs"</span><span class="o">:</span> <span class="n">Vertex</span><span class="p">{</span>
		<span class="m">40.68433</span><span class="p">,</span> <span class="o">-</span><span class="m">74.39967</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="s">"Google"</span><span class="o">:</span> <span class="n">Vertex</span><span class="p">{</span>
		<span class="m">37.42202</span><span class="p">,</span> <span class="o">-</span><span class="m">122.08408</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
	<span class="n">m2</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="kt">string</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">m2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Hello"</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="map-literals-continued">Map literals continued</h3>

<p>If the top-level type is just a type name, you can omit it from the elements of the literal.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">type</span> <span class="n">Vertex</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">Lat</span><span class="p">,</span> <span class="n">Long</span> <span class="kt">float64</span>
<span class="p">}</span>

<span class="k">var</span> <span class="n">m</span> <span class="o">=</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="n">Vertex</span><span class="p">{</span>
	<span class="s">"Bell Labs"</span><span class="o">:</span> <span class="p">{</span><span class="m">40.68433</span><span class="p">,</span> <span class="o">-</span><span class="m">74.39967</span><span class="p">},</span>
	<span class="s">"Google"</span><span class="o">:</span>    <span class="p">{</span><span class="m">37.42202</span><span class="p">,</span> <span class="o">-</span><span class="m">122.08408</span><span class="p">},</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="mutating-maps">Mutating Maps</h3>

<p>Insert or update an element in map m:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>m[key] = elem
</code></pre></div></div>

<p>Retrieve an element:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>elem = m[key]
</code></pre></div></div>

<p>Delete an element:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>delete(m, key)
</code></pre></div></div>

<p>Test that a key is present with a two-value assignment:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>elem, ok = m[key]
</code></pre></div></div>

<p>If key is in <code class="language-plaintext highlighter-rouge">m, ok</code> is <code class="language-plaintext highlighter-rouge">true</code>. If not, <code class="language-plaintext highlighter-rouge">ok</code> is <code class="language-plaintext highlighter-rouge">false</code> and <code class="language-plaintext highlighter-rouge">elem</code> is the zero value for the map’s element type.</p>

<p>Similarly, when reading from a map if the key is not present the result is the zero value for the map’s element type.</p>

<p><em>Note</em>: if <code class="language-plaintext highlighter-rouge">elem</code> or ok have not yet been declared you could use a short declaration form:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>elem, ok := m[key]
</code></pre></div></div>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">m</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">)</span>

	<span class="n">m</span><span class="p">[</span><span class="s">"Answer"</span><span class="p">]</span> <span class="o">=</span> <span class="m">42</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"The value:"</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="s">"Answer"</span><span class="p">])</span>

	<span class="n">m</span><span class="p">[</span><span class="s">"Answer"</span><span class="p">]</span> <span class="o">=</span> <span class="m">48</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"The value:"</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="s">"Answer"</span><span class="p">])</span>

	<span class="nb">delete</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">"Answer"</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"The value:"</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="s">"Answer"</span><span class="p">])</span>

	<span class="n">v</span><span class="p">,</span> <span class="n">ok</span> <span class="o">:=</span> <span class="n">m</span><span class="p">[</span><span class="s">"Answer"</span><span class="p">]</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"The value:"</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s">"Present?"</span><span class="p">,</span> <span class="n">ok</span><span class="p">)</span>
	<span class="n">m</span><span class="p">[</span><span class="s">"Question"</span><span class="p">]</span> <span class="o">=</span> <span class="m">100</span>
	<span class="n">v</span><span class="p">,</span> <span class="n">ok</span> <span class="o">:=</span> <span class="n">m</span><span class="p">[</span><span class="s">"Question"</span><span class="p">]</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"The value:"</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s">"Present?"</span><span class="p">,</span> <span class="n">ok</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="function-values">Function values</h3>

<p>Functions are values too.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"math"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">hypot</span> <span class="o">:=</span> <span class="k">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="kt">float64</span><span class="p">)</span> <span class="kt">float64</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">hypot</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span>
<span class="p">}</span></code></pre></figure>

<h3 id="function-closures">Function closures</h3>

<p>Go functions may be closures. A closure is a function value that references variables from outside its body. The function may access and assign to the referenced variables; in this sense the function is “bound” to the variables.</p>

<p>For example, the <code class="language-plaintext highlighter-rouge">adder</code> function returns a <em>closure</em>. Each closure is bound to its own <code class="language-plaintext highlighter-rouge">sum</code> variable.</p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">adder</span><span class="p">()</span> <span class="k">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
	<span class="n">sum</span> <span class="o">:=</span> <span class="m">0</span>
	<span class="k">return</span> <span class="k">func</span><span class="p">(</span><span class="n">x</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
		<span class="n">sum</span> <span class="o">+=</span> <span class="n">x</span>
		<span class="k">return</span> <span class="n">sum</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">pos</span><span class="p">,</span> <span class="n">neg</span> <span class="o">:=</span> <span class="n">adder</span><span class="p">(),</span> <span class="n">adder</span><span class="p">()</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span>
			<span class="n">pos</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
			<span class="n">neg</span><span class="p">(</span><span class="o">-</span><span class="m">2</span><span class="o">*</span><span class="n">i</span><span class="p">),</span>
		<span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<hr />

<h3 id="references">References</h3>

<ul>
  <li>Tour of Go,<a href="http://tour.golang.org/">http://tour.golang.org/</a></li>
</ul>

  </div>

  <ul class="post-navigation">
    <li>
      
      <a href="/2015/08/31/linux-dev-(debian)/">&laquo; Linux Dev (Debian)</a>
      
    </li>
    <li>
      
      <a href="/2015/09/18/tour-of-go-methods-and-interfaces/">Tour of Go - Methods and interfaces &raquo;</a>
      
    </li>
  </ul>
</article>

      </div>
    </div>

    <footer class="site-footer">
  <div class="license">
    <span>Article licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></span>
  </div>
  
  <details open>
    <summary>Extral Links</summary>
    <div>
      
      <a href="https://jekyllrb.com/">Jekyll</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://shopify.github.io/">Liquid</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://docs.asciidoctor.org/">Asciidoctor</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://github.com/qqbuby/">GitHub</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="/feed.xml">RSS</a>
      
      
    </div>
  </details>
  
</footer>


<!-- https://github.com/bryanbraun/anchorjs -->
<script src="/js/anchor.min.js"></script>
<script>
  anchors.add();
  anchors.remove(".site-title");
</script>




  </body>

</html>

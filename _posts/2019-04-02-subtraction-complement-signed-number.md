---
layout: post
title: 补数与减法
date: 2019-04-02 17:48:48 +0800
categories: ['Programming']
tags: ['Programming']
---

“还在这儿，雷欧提斯！上船去，上船去，真好意思！风息在帆顶上，人家都在等你哩。好，我为你祝福！还有几句教训，希望你铭记在记忆之中：不要想到什么就说什么，凡事必须三思而行。对人要和气，可是不要过分狎昵。相知有素的朋友，应该用钢圈箍在你的灵魂上，可是不要对每一个泛泛的新知滥施你的交情。留心避免和你家争吵，可是万一争端已起，就应该让对方知道你不是可以轻侮的。倾听每一个人的意见，可是只对极少人发表你的意见，接受每一个人的批评，可是保留你自己的判断。尽你的财力购置贵重的衣服，可是不要炫新立异，必须富丽而不浮艳，因为服装往往可以表现人格，法国的名流要人，就是在这点上显得最高尚，与众不同。**不要向人告贷，也不要借钱给别人，因为债款放了出去，往往不但丢了本钱，而且会失去朋友，向人告贷的结果，容易养成因循懒惰的习惯。**尤其要紧的，你必须对你自己忠实，正向有了白昼才有黑夜一样，对自己忠实，才不会对别人欺诈。再会，愿我的祝福使这一番话在你的行事中奏效！”这是莎士比亚的《哈姆雷特》中波洛涅斯对儿子雷欧提斯临别时说的话。

我们在小学时都会算下面这道减法题：

```
   253
 - 176
 -----
   ???
```

从十位数5借1，求个位数的差:

```
  2   4  13
- 1   7   6
-----------
  ?   ?   7
```

从百位数2借1，求十位数的差:

```  
  1  14  13
- 1   7   6
-----------
  ?   7   7
```

求百位数的差:

```
  1  14  13
- 1   7   6
-----------
  0   7   7
```

对于减法，我们先明确几个概念，以253减去176等于77为例，其中253我们称为被减数(minuend)，176是减数(subtrahend)，77是差(difference)。对于减法运算，被减数通常会遇到借位操作。如3减去6时，我们需要从被减数的5借1，并用13减去6，结果为7。此时被减数5被借1，所以我们要用4减去7，同样，我们要从2皆1，并用14减去7，结果为7。最后，因为2被借1，只剩下1，1减去1等于0。

那么我们该怎样避免烦琐的借位呢？借位是因为被减数的数字小于减数的数字，所以要避免借位，我们就要规避这种情况。对于253减去176，其实我们可以用下面的公式进行等价替换：

```
253 - 176 = [(999 - 176) + 253] - 999
```

也就是有下面的算法：

```
  999
- 176
-----
  823
```

```
   823
+  253
------
  1076
```

```
  1076
-  999
------
   ???
```

虽然999减去176不用借位，但是我们计算到1076减去999时又遇到了借位。这种情况，我们可以用下面的等价公式替换：

```
1076 - 999 = (1076 - 1000) + 1
```

也就是：

```
  1076
- 1000
------
    76
+    1
------
    77
```

这里用到了补数(complement)的知识，这里用999减去176叫做对176求9的补数(nines' complement)，同样，我们用1000减去176叫做对176求10的补数(ten's complement)。很明显，10的补数，我们可以用9的补数加1得到。对于253减去176，我们先求减数176的9的补数823，再将被减数253和823相加得到1076，最后用1076减去1000再加1后得到差77。通过补数，我们避免掉了减法中烦琐的借位操作。

如果是下面这道减法题呢？

```
  176
- 253
-----
  ???
```

我们发现被减数小于减数，所以按照减法的规则，我们把被减数和减数交换后做减法，然后结果取反，也就是求结果的加法逆元，俗称相反数。

```
  176
- 253
-----
  -77
```

同样，为了不借位做减法，我们先求减数253的9的补数746，再用补数746和被减数176相加得922，最后用922减去1000，哦，好像那里不对呀？对这种情况，我们只需要对922求9的补数，再取反即可，也就是999减去922得到77，再取反得到-77。

那么我们有没有可能不用减法号做减法，也就是用加法做减法呢？

我们知道负数需要一个额外的符号"-"表示，你们的体育老师应该教过你们，正数其实也有个表示正数的符号"+"，，只是平时忽略不写而已。要解决不用减法做减法的这个问题，我需要先解决负数的表示问题。

我们先看下整数的表示：

..., -999, -998, ... , -3, -2, -1, 0, 1, 2, 3, ..., 999, ...


这是有无限多个数字的整数的全集，对于早期的机械计算器只能计算有限位的数字，所以我们从整数中取出固定两位数字范围的子集为例，介绍一下计算器怎么通过加法做减法的，比如我们选取两位数字的集合: -50, -49, ..., -2, -1, 0, 1, 2,  ..., 49。

### 参考

- https://en.wikipedia.org/wiki/Method\_of\_complements
- https://en.wikipedia.org/wiki/Two%27s\_complement
- https://en.wikipedia.org/wiki/Ones%27\_complement
- https://en.wikipedia.org/wiki/Integer\_overflow
- https://en.wikipedia.org/wiki/Signed\_number\_representations

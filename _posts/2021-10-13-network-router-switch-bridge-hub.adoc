= Network Router, Switch, Bridge and Hub
:page-layout: post
:page-categories: ['network']
:page-tags: ['network']
:revdate: 2021-10-13 16:01:41 +0800
:toc:
:sectnums:

:content-addressable_memory: https://en.wikipedia.org/wiki/Content-addressable_memory
:router_computing: https://en.wikipedia.org/wiki/Router_(computing)
:network_switch: https://en.wikipedia.org/wiki/Network_switch
:bridging_networking: https://en.wikipedia.org/wiki/Bridging_(networking)
:ethernet_hub: https://en.wikipedia.org/wiki/Ethernet_hub
:network_host: https://en.wikipedia.org/wiki/Network_host

== Forwarding information base

A *forwarding information base* (*FIB*), also known as a *forwarding table* or *MAC table*, is most commonly used in {bridging_networking}[network bridging], routing, and similar functions to find the proper output network interface to which the input interface should forward a packet. It is a dynamic table that maps MAC addresses to ports. It is the essential mechanism that separates {network_switch}[network switches] from {ethernet_hub}[Ethernet hubs]. {content-addressable_memory}[Content-addressable memory] (CAM) is typically used to efficiently implement the FIB, thus it is sometimes called a *CAM table*. 

== Routing information base

In computer networking, a *routine table*, or *routing information base* (*RIB*), is a data table stored in a {router_computing}[router] or a {network_host}[network host] that lists the routes to particular network destinations, and in some cases, metrics (distances) associated with those routes. The routing table contains information about the topology of the network immediately around it.

The construction of routing tables is the primary goal of routing protocols. Static routes are entries made in a routing table by non-automatic means and which are fixed rather than being the result of routing protocols and associated network topology-discovery procedures. 

== IP routing

*IP routing* is the field of routing methodologies of Internet Protocol (IP) *packets within and across IP networks*. This involves not only protocols and technologies but includes the policies of the worldwide organization and configuration of Internet infrastructure. In each IP network node, IP routing involves the determination of a suitable path for a network packet from a source to its destination in an IP network. The process uses *static configuration rules or dynamically* obtained status information to select specific packet forwarding methods to direct traffic to the next available intermediate network node one hop closer to the desired final destination, a total path potentially spanning multiple computer networks.

Networks are separated from each other by specialized hosts, called *gateways* or *routers* with specialized software support optimized for routing. In routers, packets arriving at an interface are examined for source and destination addressing and queued to the appropriate outgoing interface according to their destination address and a set of rules and performance metrics. Rules are encoded in a *routing table* that contains entries for all interfaces and their connected networks. If no rule satisfies the requirements for a network packet, it is forwarded to a *default route*. Routing tables are maintained either manually by a network administrator, or updated dynamically with a *routing protocol*. Routing rules may contain other parameters than source and destination, such as limitations on available bandwidth, expected packet loss rates, and specific technology requirements.

*IP forwarding* algorithms take into account the size of each packet, the type of service specified in the header, as well as characteristics of the available links to other routers in the network, such as link capacity, utilization rate, and maximum datagram size that is supported on the link. In general, most routing software determines a route through a shortest path algorithm. However, other routing protocols may use other metrics for determining the best path. Based on the metrics required and present for each link, each path has an associated cost. The routing algorithm attempts to minimize the cost when choosing the next hop.

A *routing protocol* is a software mechanism by which routers communicate and share information about the topology of the network, and the capabilities of each routing node. It thus implements the network-global rules by which traffic is directed within a network and across multiple networks. Different protocols are often used for different topologies or different application areas. For example, the *Open Shortest Path First* (*OSPF*) protocol is generally used for routing packets between subnetworks within an enterprise and the *Border Gateway Protocol* (*BGP*) is used on a global scale. BGP is the de facto standard of worldwide Internet routing. 

==== Routing algorithm

The IP forwarding algorithm is a specific implementation of routing for IP networks. In order to achieve a successful transfer of data, the algorithm uses a routing table to select a next-hop router as the next destination for a *datagram*. The IP address of the selected router is known as the *next-hop address*.

When several destinations are matching, the route with *the longest subnet mask* is chosen (the most specific one). If there are multiple routes with the same subnet mask, the route with *the lowest metric* is used. If there are multiple default routes, the metric is also used to determine which to use. If there are multiple routes with the same subnet mask and metric, the system may use *equal-cost multi-path routing* as a forwarding strategy.

When no route is available, an *ICMP* error message is sent to the originator of the packet, to inform that host that the packet could not be delivered, and to avoid unnecessary *retransmission* to avoid *network congestion*. The sending host should either stop transmitting or choose another address or route.  

=== Routing table

The following presents a typical routing table in a Unix-like operating system:

[source,console]
----
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         71.46.14.1      0.0.0.0         UG    0      0        0 ppp0
10.0.0.0        0.0.0.0         255.0.0.0       U     0      0        0 eth0
71.46.14.1      0.0.0.0         255.255.255.255 UH    0      0        0 ppp0
169.254.0.0     0.0.0.0         255.255.0.0     U     0      0        0 eth0
172.16.0.0      0.0.0.0         255.240.0.0     U     0      0        0 eth0
192.168.0.0     0.0.0.0         255.255.0.0     U     0      0        0 eth0
192.168.1.0     192.168.96.1    255.255.255.0   UG    0      0        0 eth0
192.168.96.0    0.0.0.0         255.255.255.0   U     0      0        0 eth0
----

The host has several network interfaces. `eth0` is the interface name of the network interface card representing an *Ethernet port*. `ppp0` is a PPPoE interface, which is configured as the _default route_ in this example.

A *default route* is recognized by the destination `0.0.0.0` and the flag `G`. A *network router* is identified by the network mask `255.255.255.255` and the flag `H`.

.Most common Routing Flags
[%header,cols='1,5']
|====
|Flag
|Description

|G
|Use Gateway (gateway filled in)

|H
|Target is a Host (bitmask of 32 bits)

|U
|Route is Up 
|====

== Router

A *router* is a networking device that forwards *data packets* between computer networks. Routers perform the traffic directing functions on the Internet. Data sent through the internet, such as a web page or email, is in the form of data packets. A packet is typically forwarded from one router to another router through the networks that constitute an internetwork (e.g. the Internet) until it reaches its destination node.

*A router is connected to two or more data lines from different IP networks.* When a data packet comes in on one of the lines, the router reads the network address information in the packet header to determine the ultimate destination. Then, using information in its *routing table* or routing policy, it directs the packet to the next network on its journey.

image::/assets/computer-network/Adsl_connections.jpg[35%,35%,title='A typical home or small office DSL router showing the telephone socket (left, white) to connect it to the internet using ADSL, and Ethernet jacks (right, yellow) to connect it to home computers and printers.']

== Network switch

A *network switch* (also called *switching hub*, *bridging hub*, and, by the IEEE, *MAC bridge*) is networking hardware that connects devices on a computer network by using *packet switching* to receive and forward data to the destination device.

A network switch is a *multiport network bridge* that uses *MAC addresses* to forward data at the *data link layer* (layer 2) of the OSI model. Some switches can also forward data at the network layer (layer 3) by additionally incorporating routing functionality. Such switches are commonly known as *layer-3 switches* or *multilayer switches*.

Switches for Ethernet are the most common form of network switch. The first Ethernet switch was introduced by Kalpana in 1990.[3] Switches also exist for other types of networks including Fibre Channel, Asynchronous Transfer Mode, and InfiniBand.

Unlike *repeater hubs*, which *broadcast* the same data out of each port and let the devices pick out the data addressed to them, a network switch learns the identities of connected devices and then only forwards data to the port connected to the device to which it is addressed.

image::/assets/computer-network/555px-2550T-PWR-Front.jpg[35%,35%,title="Avaya ERS 2550T-PWR, a 50-port Ethernet switch"]

== Ethernet hub

An *Ethernet hub*, *active hub*, *network hub*, *repeater hub*, *multiport repeater*, or simply *hub* is a network hardware device for connecting multiple Ethernet devices together and making them act as a single network segment. It has multiple input/output (I/O) ports, in which *a signal introduced at the input of any port appears at the output of every port except the original incoming*. A hub works at the *physical layer* (*layer 1*) of the OSI model. A repeater hub also participates in collision detection, forwarding a jam signal to all ports if it detects a collision. In addition to standard 8P8C ("RJ45") ports, some hubs may also come with a BNC or an Attachment Unit Interface (AUI) connector to allow connection to legacy 10BASE2 or 10BASE5 network segments.

Hubs are now largely obsolete, having been replaced by network switches except in very old installations or specialized applications. As of 2011, connecting network segments by repeaters or hubs is deprecated by IEEE 802.3.

image::/assets/computer-network/450px-4_port_netgear_ethernet_hub.jpg[35%,35%,title="4-port 10BASE-T Ethernet hub with selectable MDI-X/MDI port"]

== Gateway

A *gateway* is a piece of *networking hardware or software* used in telecommunications for telecommunications networks that allows data to flow from one discrete network to another. Gateways are distinct from *routers* or *switches* in that they communicate using *more than one protocol* to connect multiple networks and can *operate at any of the seven layers* of the open systems interconnection model (OSI).

The term gateway can also loosely refer to a computer or computer program configured to perform the tasks of a gateway, such as a *default gateway* or *router*, and in the case of *HTTP*, gateway is also often used as a synonym for *reverse proxy*. 

== References

* https://en.wikipedia.org/wiki/Forwarding_information_base
* https://en.wikipedia.org/wiki/Routing
* https://en.wikipedia.org/wiki/IP_routing
* https://en.wikipedia.org/wiki/Routing_table
* https://en.wikipedia.org/wiki/Router_(computing)
* https://en.wikipedia.org/wiki/Network_switch
* https://en.wikipedia.org/wiki/Bridging_(networking)
* https://en.wikipedia.org/wiki/Ethernet_hub
* https://en.wikipedia.org/wiki/Gateway_(telecommunications)

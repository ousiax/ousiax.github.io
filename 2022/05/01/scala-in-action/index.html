<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bing WebMaster -->
  <meta name="msvalidate.01" content="AB2FFF876C37F59D9121882CC8395DE5" />

  <title>Scala in Action</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://blog.codefarm.me/2022/05/01/scala-in-action/">
  <link rel="alternate" type="application/rss+xml" title="CODE FARM" href="https://blog.codefarm.me/feed.xml">

  <!-- https://cdn.jsdelivr.net/gh/lurongkai/anti-baidu/js/anti-baidu-latest.min.js -->
<script type="text/javascript" src="/js/anti-baidu.min.js" charset="UTF-8"></script>

  
<!-- Google Analytics Website tracking -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83971182-1', 'auto');
  ga('send', 'pageview');

</script>


  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SN88FJ18E5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SN88FJ18E5');
</script>



</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <h2 class="site-title">
      <a class="site-title" href="/">CODE FARM</a>
    </h2>

     <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
        <div class="trigger">
            <ul>
                <li><a href="/">home</a>
                <li><a href="/category">category</a>
                <li><a href="/tag">tag</a>
                <li><a href="/archive">archive</a>
                <li><a href="/about">about</a>
                <li><a href="https://resume.github.io/?qqbuby" target="_blank">R&eacute;sum&eacute;</a>
            </ul>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Scala in Action</h1>
    
    
    <p class="post-meta"><time datetime="2022-05-01T09:10:23+08:00" itemprop="datePublished">May 1, 2022</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#first-steps-in-scala">1. First Steps in Scala</a>
<ul class="sectlevel2">
<li><a href="#learn-to-use-the-scala-interpreter">1.1. Learn to use the Scala interpreter</a></li>
<li><a href="#define-some-variables">1.2. Define some variables</a></li>
<li><a href="#write-some-scala-scripts">1.3. Write some Scala scripts</a></li>
<li><a href="#parameterize-arrays-with-types">1.4. Parameterize arrays with types</a></li>
<li><a href="#use-lists">1.5. Use Lists</a></li>
<li><a href="#use-sets-and-maps">1.6. Use sets and maps</a></li>
<li><a href="#learn-to-recognize-the-functional-style">1.7. Learn to recognize the functional style</a></li>
</ul>
</li>
<li><a href="#classes-and-objects">2. Classes and Objects</a>
<ul class="sectlevel2">
<li><a href="#singleton-object">2.1. Singleton object</a></li>
<li><a href="#companion-object">2.2. Companion object</a></li>
<li><a href="#standalone-object">2.3. Standalone object</a></li>
</ul>
</li>
<li><a href="#basic-types-and-operations">3. Basic Types and Operations</a>
<ul class="sectlevel2">
<li><a href="#some-basic-types">3.1. Some basic types</a></li>
<li><a href="#operators-are-methods">3.2. Operators are methods</a></li>
</ul>
</li>
<li><a href="#functional-objects">4. Functional Objects</a></li>
<li><a href="#built-in-control-structures">5. Built-in Control Structures</a>
<ul class="sectlevel2">
<li><a href="#if-expressions">5.1. If expressions</a></li>
<li><a href="#while-loops">5.2. While loops</a></li>
<li><a href="#for-expressions">5.3. For expressions</a></li>
<li><a href="#exception-handling-with-try-expressions">5.4. Exception handling with try expressions</a></li>
<li><a href="#match-expressions">5.5. Match expressions</a></li>
<li><a href="#living-without-break-and-continue">5.6. Living without break and continue</a></li>
<li><a href="#refactoring-imperative-style-code">5.7. Refactoring imperative-style code</a></li>
</ul>
</li>
<li><a href="#functions-and-closures">6. Functions and Closures</a>
<ul class="sectlevel2">
<li><a href="#methods">6.1. Methods</a></li>
<li><a href="#local-functions">6.2. Local functions</a></li>
<li><a href="#first-class-functions">6.3. First-class functions</a></li>
<li><a href="#short-forms-of-function-literals">6.4. Short forms of function literals</a></li>
<li><a href="#placeholder-syntax">6.5. Placeholder syntax</a></li>
<li><a href="#partially-applied-functions">6.6. Partially applied functions</a></li>
<li><a href="#closures">6.7. Closures</a></li>
<li><a href="#special-function-call-forms">6.8. Special function call forms</a></li>
<li><a href="#tail-recursion">6.9. Tail recursion</a></li>
</ul>
</li>
<li><a href="#control-abstraction-higher-order-function-and-currying">7. Control Abstraction: Higher-order function and Currying</a>
<ul class="sectlevel2">
<li><a href="#reducing-code-duplication">7.1. Reducing code duplication</a></li>
<li><a href="#currying">7.2. Currying</a></li>
<li><a href="#writing-new-control-structures">7.3. Writing new control structures</a></li>
<li><a href="#by-name-parameters">7.4. By-name parameters</a></li>
</ul>
</li>
<li><a href="#composition-and-inheritance">8. Composition and Inheritance</a>
<ul class="sectlevel2">
<li><a href="#abstract-classes">8.1. Abstract classes</a></li>
<li><a href="#defining-parameterless-methods">8.2. Defining parameterless methods</a></li>
<li><a href="#extending-classes">8.3. Extending classes</a></li>
<li><a href="#overriding-methods-and-fields">8.4. Overriding methods and fields</a></li>
<li><a href="#defining-parametric-fields">8.5. Defining parametric fields</a></li>
<li><a href="#invoking-superclass-constructors">8.6. Invoking superclass constructors</a></li>
<li><a href="#using-override-modifiers">8.7. Using override modifiers</a></li>
<li><a href="#polymorphism-and-dynamic-binding">8.8. Polymorphism and dynamic binding</a></li>
<li><a href="#declaring-final-members">8.9. Declaring final members</a></li>
</ul>
</li>
<li><a href="#defining-a-factory-object">9. Defining a factory object</a></li>
<li><a href="#scalas-hierarchy">10. Scala’s Hierarchy</a></li>
<li><a href="#traits">11. Traits</a>
<ul class="sectlevel2">
<li><a href="#how-traits-work">11.1. How traits work</a></li>
<li><a href="#thin-versus-rich-interfaces">11.2. Thin versus rich interfaces</a></li>
<li><a href="#traits-as-stackable-modifications">11.3. Traits as stackable modifications</a></li>
<li><a href="#why-not-multiple-inheritance">11.4. Why not multiple inheritance?</a></li>
<li><a href="#to-trait-or-not-to-trait">11.5. To trait, or not to trait?</a></li>
</ul>
</li>
<li><a href="#packages-and-imports">12. Packages and Imports</a>
<ul class="sectlevel2">
<li><a href="#putting-code-in-packages">12.1. Putting code in packages</a></li>
</ul>
</li>
<li><a href="#concise-access-to-related-code">13. Concise access to related code</a>
<ul class="sectlevel2">
<li><a href="#imports">13.1. Imports</a></li>
<li><a href="#implicit-imports">13.2. Implicit imports</a></li>
<li><a href="#access-modifiers">13.3. Access modifiers</a></li>
<li><a href="#package-objects">13.4. Package objects</a></li>
</ul>
</li>
<li><a href="#assertions-and-unit-testing">14. Assertions and Unit Testing</a>
<ul class="sectlevel2">
<li><a href="#assertions">14.1. Assertions</a></li>
<li><a href="#unit-testing-in-scala">14.2. Unit testing in Scala</a></li>
</ul>
</li>
<li><a href="#case-classes-and-pattern-matching">15. Case Classes and Pattern Matching</a>
<ul class="sectlevel2">
<li><a href="#kinds-of-patterns">15.1. Kinds of patterns</a>
<ul class="sectlevel3">
<li><a href="#wildcard-patterns">15.1.1. Wildcard patterns</a></li>
<li><a href="#constant-patterns">15.1.2. Constant patterns</a></li>
<li><a href="#variable-patterns">15.1.3. Variable patterns</a></li>
<li><a href="#constructor-patterns">15.1.4. Constructor patterns</a></li>
<li><a href="#sequence-patterns">15.1.5. Sequence patterns</a></li>
<li><a href="#tuple-patterns">15.1.6. Tuple patterns</a></li>
<li><a href="#typed-patterns">15.1.7. Typed patterns</a></li>
<li><a href="#variable-binding">15.1.8. Variable binding</a></li>
</ul>
</li>
<li><a href="#pattern-guards">15.2. Pattern guards</a></li>
<li><a href="#sealed-classes">15.3. Sealed classes</a></li>
<li><a href="#the-option-type">15.4. The Option type</a></li>
<li><a href="#patterns-everywhere">15.5. Patterns everywhere</a>
<ul class="sectlevel3">
<li><a href="#patterns-in-variable-definitions">15.5.1. Patterns in variable definitions</a></li>
<li><a href="#case-sequences-as-partial-functions">15.5.2. Case sequences as partial functions</a></li>
<li><a href="#patterns-in-for-expressions">15.5.3. Patterns in for expressions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#working-with-lists">16. Working with Lists</a>
<ul class="sectlevel2">
<li><a href="#list-patterns">16.1. List patterns</a></li>
<li><a href="#first-order-methods-on-class-list">16.2. First-order methods on class List</a>
<ul class="sectlevel3">
<li><a href="#concatenating-two-lists">16.2.1. Concatenating two lists</a></li>
<li><a href="#taking-the-length-of-a-list-length">16.2.2. Taking the length of a list: <code>length</code></a></li>
<li><a href="#accessing-the-end-of-a-list-init-and-last">16.2.3. Accessing the end of a list: <code>init</code> and <code>last</code></a></li>
<li><a href="#reversing-lists-reverse">16.2.4. Reversing lists: <code>reverse</code></a></li>
<li><a href="#prefixes-and-suffixes-drop-take-and-splitat">16.2.5. Prefixes and suffixes: <code>drop</code>, <code>take</code>, and <code>splitAt</code></a></li>
<li><a href="#element-selection-apply-and-indices">16.2.6. Element selection: <code>apply</code> and <code>indices</code></a></li>
<li><a href="#flattening-a-list-of-lists-flatten">16.2.7. Flattening a list of lists: <code>flatten</code></a></li>
<li><a href="#zipping-lists-zip-and-unzip">16.2.8. Zipping lists: <code>zip</code> and <code>unzip</code></a></li>
<li><a href="#displaying-lists-tostring-and-mkstring">16.2.9. Displaying lists: <code>toString</code> and <code>mkString</code></a></li>
<li><a href="#converting-lists-iterator-toarray-copytoarray">16.2.10. Converting lists: <code>iterator</code>, <code>toArray</code>, <code>copyToArray</code></a></li>
<li><a href="#example-merge-sort">16.2.11. Example: Merge sort</a></li>
</ul>
</li>
<li><a href="#higher-order-methods-on-class-list">16.3. Higher-order methods on class List</a>
<ul class="sectlevel3">
<li><a href="#mapping-over-lists-map-flatmap-and-foreach">16.3.1. Mapping over lists: <code>map</code>, <code>flatMap</code> and <code>foreach</code></a></li>
<li><a href="#filtering-lists-filter-partition-find-takewhile-dropwhile-and-span">16.3.2. Filtering lists: <code>filter</code>, <code>partition</code>, <code>find</code>, <code>takeWhile</code>, <code>dropWhile</code>, and <code>span</code></a></li>
<li><a href="#predicates-over-lists-forall-and-exists">16.3.3. Predicates over lists: <code>forall</code> and <code>exists</code></a></li>
<li><a href="#folding-lists-foldleft-and-foldright">16.3.4. Folding lists: <code>foldLeft</code>, <code>/:</code> and <code>foldRight</code>, <code>:\</code></a></li>
<li><a href="#sorting-lists-sortwith">16.3.5. Sorting lists: <code>sortWith</code></a></li>
</ul>
</li>
<li><a href="#methods-of-the-list-object">16.4. Methods of the List object</a></li>
<li><a href="#understanding-scalas-type-inference-algorithm">16.5. Understanding Scala’s type inference algorithm</a></li>
</ul>
</li>
<li><a href="#collections">17. Collections</a>
<ul class="sectlevel2">
<li><a href="#sequences">17.1. Sequences</a></li>
<li><a href="#sets-and-maps">17.2. Sets and maps</a></li>
</ul>
</li>
<li><a href="#stateful-objects">18. Stateful Objects</a>
<ul class="sectlevel2">
<li><a href="#what-makes-an-object-stateful">18.1. What makes an object stateful?</a></li>
<li><a href="#reassignable-variables-and-properties">18.2. Reassignable variables and properties</a></li>
</ul>
</li>
<li><a href="#type-parameterization">19. Type Parameterization</a>
<ul class="sectlevel2">
<li><a href="#functional-queues">19.1. Functional queues</a></li>
<li><a href="#information-hiding">19.2. Information hiding</a>
<ul class="sectlevel3">
<li><a href="#private-constructors-and-factory-methods">19.2.1. Private constructors and factory methods</a></li>
</ul>
</li>
<li><a href="#variance-annotations">19.3. Variance annotations</a></li>
<li><a href="#checking-variance-annotations">19.4. Checking variance annotations</a></li>
<li><a href="#lower-bounds">19.5. Lower bounds</a></li>
<li><a href="#contravariance">19.6. Contravariance</a></li>
<li><a href="#object-private-data">19.7. Object private data</a></li>
<li><a href="#upper-bounds">19.8. Upper bounds</a></li>
</ul>
</li>
<li><a href="#abstract-members">20. Abstract Members</a>
<ul class="sectlevel2">
<li><a href="#a-quick-tour-of-abstract-members">20.1. A quick tour of abstract members</a></li>
<li><a href="#type-members">20.2. Type members</a></li>
<li><a href="#abstract-vals">20.3. Abstract vals</a></li>
<li><a href="#abstract-vars">20.4. Abstract vars</a></li>
<li><a href="#initializing-abstract-vals">20.5. Initializing abstract vals</a>
<ul class="sectlevel3">
<li><a href="#pre-initialized-fields">20.5.1. Pre-initialized fields</a></li>
<li><a href="#lazy-vals">20.5.2. Lazy vals</a></li>
</ul>
</li>
<li><a href="#abstract-types">20.6. Abstract types</a></li>
<li><a href="#path-dependent-types">20.7. Path-dependent types</a></li>
<li><a href="#structural-subtyping">20.8. Structural subtyping</a></li>
<li><a href="#enumerations">20.9. Enumerations</a></li>
</ul>
</li>
<li><a href="#implicit-conversions-and-parameters">21. Implicit Conversions and Parameters</a>
<ul class="sectlevel2">
<li><a href="#rules-for-implicits">21.1. Rules for implicits</a></li>
<li><a href="#implicit-conversion-to-an-expected-type">21.2. Implicit conversion to an expected type</a></li>
<li><a href="#converting-the-receiver">21.3. Converting the receiver</a></li>
<li><a href="#implicit-parameters">21.4. Implicit parameters</a></li>
<li><a href="#view-bounds">21.5. View bounds</a></li>
<li><a href="#debugging-implicits">21.6. Debugging implicits</a></li>
</ul>
</li>
<li><a href="#the-scala-collections-api">22. The Scala Collections API</a>
<ul class="sectlevel2">
<li><a href="#collection-hierarchy">22.1. Collection hierarchy</a></li>
</ul>
</li>
<li><a href="#extractors">23. Extractors</a></li>
<li><a href="#annotations">24. Annotations</a>
<ul class="sectlevel2">
<li><a href="#definition">24.1. Definition</a></li>
<li><a href="#predefined-annotations">24.2. Predefined Annotations</a>
<ul class="sectlevel3">
<li><a href="#java-platform-annotations">24.2.1. Java Platform Annotations</a></li>
<li><a href="#java-beans-annotations">24.2.2. Java Beans Annotations</a></li>
<li><a href="#deprecation-annotations">24.2.3. Deprecation Annotations</a></li>
<li><a href="#scala-compiler-annotations">24.2.4. Scala Compiler Annotations</a></li>
</ul>
</li>
<li><a href="#user-defined-annotations">24.3. User-defined Annotations</a></li>
</ul>
</li>
<li><a href="#object-equality">25. Object Equality</a>
<ul class="sectlevel2">
<li><a href="#equality-in-scala">25.1. Equality in Scala</a></li>
</ul>
</li>
<li><a href="#actors-and-concurrency">26. Actors and Concurrency</a></li>
<li><a href="#bibliography">27. Bibliography</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="first-steps-in-scala">1. First Steps in Scala</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="learn-to-use-the-scala-interpreter">1.1. Learn to use the Scala interpreter</h3>
<div class="paragraph">
<p>The easiest way to get started with Scala is by using the Scala interpreter, an interactive “shell” for writing Scala expressions and programs. Simply type an expression into the interpreter and it will evaluate the expression and print the resulting value. The interactive shell for Scala is simply called <code>scala</code>.</p>
</div>
<div class="paragraph">
<p>You use it by typing <code>scala</code> at a command prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>scala
<span class="go">Welcome to Scala 2.12.14 (OpenJDK 64-Bit Server VM, Java 17.0.2).
Type in expressions for evaluation. Or try :help.

</span><span class="gp">scala&gt;</span><span class="w"> </span>2 + 2
<span class="go">res0: Int = 4

</span><span class="gp">scala&gt;</span><span class="w"> </span>res0
<span class="go">res1: Int = 4

</span><span class="gp">scala&gt;</span><span class="w"> </span>res0 + res0
<span class="go">res2: Int = 8</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="define-some-variables">1.2. Define some variables</h3>
<div class="paragraph">
<p>Scala has two kinds of variables, <strong>vals</strong> and <strong>vars</strong>. A val is similar to a final variable in Java. Once initialized, a val can never be reassigned. A var, by contrast, is similar to a non-final variable in Java. A var can be reassigned throughout its lifetime. Here’s a val definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>val msg <span class="o">=</span> <span class="s2">"Hello, world!"</span>
<span class="go">msg: java.lang.String = Hello, world!

</span><span class="gp">scala&gt;</span><span class="w"> </span>msg <span class="o">=</span> <span class="s2">"Hello, another world!"</span>
<span class="gp">&lt;console&gt;</span>:12: error: reassignment to val
<span class="go">       msg = "Hello, another world!"
           ^

</span><span class="gp">scala&gt;</span><span class="w"> </span>var msg2 <span class="o">=</span> <span class="s2">"foo"</span>
<span class="go">msg2: String = foo

</span><span class="gp">scala&gt;</span><span class="w"> </span>msg2 <span class="o">=</span> <span class="s2">"bar"</span>
<span class="go">msg2: String = bar</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="write-some-scala-scripts">1.3. Write some Scala scripts</h3>
<div class="paragraph">
<p>Although Scala is designed to help programmers build very large-scale systems, it also scales down nicely to scripting. A script is just a sequence of statements in a file that will be executed sequentially. Put this into a file named <em>hello.scala</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span><span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh"> &gt; hello.scala
</span><span class="gp">&gt;</span><span class="w"> </span><span class="sh">println("Hello, world, from a script!")
</span><span class="gp">&gt;</span><span class="w"> </span><span class="no">EOF
</span><span class="go">
</span><span class="gp">$</span><span class="w"> </span>scala hello.scala
<span class="go">Hello, world, from a script!</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Command line arguments to a Scala script are available via a Scala array named <em>args</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span><span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh"> &gt; helloarg.scala
</span><span class="gp">&gt;</span><span class="w"> </span><span class="sh">println("Hello, "+ args(0) +"!")
</span><span class="gp">&gt;</span><span class="w"> </span><span class="no">EOF
</span><span class="go">
</span><span class="gp">$</span><span class="w"> </span>scala helloarg.scala planet
<span class="go">Hello, planet!</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="parameterize-arrays-with-types">1.4. Parameterize arrays with types</h3>
<div class="paragraph">
<p>In Scala, you can instantiate objects, or class instances, using new. When you instantiate an object in Scala, you can parameterize it with values and types. Parameterization means “configuring” an instance when you create it. You parameterize an instance with values by passing objects to a constructor in parentheses. And parameterize an instance with types by specifying one or more types in square brackets.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">val</span> <span class="nv">greetStrings</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="mi">3</span><span class="o">)</span>
  <span class="nf">greetStrings</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="k">=</span> <span class="s">"Hello"</span>
  <span class="nf">greetStrings</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="k">=</span> <span class="s">", "</span>
  <span class="nf">greetStrings</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="k">=</span> <span class="s">"world!\n"</span>
  <span class="nf">for</span> <span class="o">(</span><span class="n">i</span> <span class="k">&lt;-</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">2</span><span class="o">)</span>
    <span class="nf">print</span><span class="o">(</span><span class="nf">greetStrings</span><span class="o">(</span><span class="n">i</span><span class="o">))</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="use-lists">1.5. Use Lists</h3>
<div class="ulist">
<ul>
<li>
<p>One of the big ideas of the functional style of programming is that methods should not have side effects.</p>
</li>
<li>
<p>Applying this functional philosophy to the world of objects means making objects immutable.</p>
</li>
<li>
<p>For an immutable sequence of objects that share the same type you can use Scala’s List class.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>val oneTwo <span class="o">=</span> List<span class="o">(</span>1, 2<span class="o">)</span>
<span class="go">oneTwo: List[Int] = List(1, 2)

</span><span class="gp">scala&gt;</span><span class="w"> </span>val threeFour <span class="o">=</span> List<span class="o">(</span>3, 4<span class="o">)</span>
<span class="go">threeFour: List[Int] = List(3, 4)

</span><span class="gp">scala&gt;</span><span class="w"> </span>val oneTwoThreeFour <span class="o">=</span> oneTwo ::: threeFour
<span class="go">oneTwoThreeFour: List[Int] = List(1, 2, 3, 4)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>val twoThree <span class="o">=</span> List<span class="o">(</span>2, 3<span class="o">)</span>
<span class="go">twoThree: List[Int] = List(2, 3)

</span><span class="gp">scala&gt;</span><span class="w"> </span>val oneTwoThree <span class="o">=</span> 1 :: twoThree
<span class="go">oneTwoThree: List[Int] = List(1, 2, 3)

</span><span class="gp">scala&gt;</span><span class="w"> </span>val oneTwoThree <span class="o">=</span> 1 :: 2 :: 3 :: Nil
<span class="go">oneTwoThree: List[Int] = List(1, 2, 3)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>oneTwoThree<span class="o">(</span>2<span class="o">)</span>
<span class="go">res1: Int = 3</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>oneTwoThree.head
<span class="go">res4: Int = 1

</span><span class="gp">scala&gt;</span><span class="w"> </span>oneTwoThree.tail
<span class="go">res5: List[Int] = List(2, 3)

</span><span class="gp">scala&gt;</span><span class="w"> </span>oneTwoThree.init
<span class="go">res6: List[Int] = List(1, 2)

</span><span class="gp">scala&gt;</span><span class="w"> </span>oneTwoThree.length
<span class="go">res7: Int = 3

</span><span class="gp">scala&gt;</span><span class="w"> </span>oneTwoThree.mkString<span class="o">(</span><span class="s2">", "</span><span class="o">)</span>
<span class="go">res8: String = 1, 2, 3

</span><span class="gp">scala&gt;</span><span class="w"> </span>oneTwoThree.reverse
<span class="go">res9: List[Int] = List(3, 2, 1)</span></code></pre>
</div>
</div>
</li>
<li>
<p>For a mutable sequence of objects that share the same type you can use Scala’s List class.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>val nums <span class="o">=</span> scala.collection.mutable.ListBuffer<span class="o">(</span>1, 2<span class="o">)</span>
<span class="go">nums: scala.collection.mutable.ListBuffer[Int] = ListBuffer(1, 2)

</span><span class="gp">scala&gt;</span><span class="w"> </span>nums +<span class="o">=</span> 3
<span class="go">nums: nums.type = ListBuffer(1, 2, 3)

</span><span class="gp">scala&gt;</span><span class="w"> </span>nums
<span class="go">res15: scala.collection.mutable.ListBuffer[Int] = ListBuffer(1, 2, 3)

</span><span class="gp">scala&gt;</span><span class="w"> </span>nums ++<span class="o">=</span> Seq<span class="o">(</span>4, 5<span class="o">)</span>
<span class="go">res16: nums.type = ListBuffer(1, 2, 3, 4, 5)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="use-sets-and-maps">1.6. Use sets and maps</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>var jetSet <span class="o">=</span> Set<span class="o">(</span><span class="s2">"Boeing"</span>, <span class="s2">"Airbus"</span><span class="o">)</span>
<span class="go">jetSet: scala.collection.immutable.Set[String] = Set(Boeing, Airbus)

</span><span class="gp">scala&gt;</span><span class="w"> </span>jetSet +<span class="o">=</span> <span class="s2">"Lear"</span>
<span class="go">
</span><span class="gp">scala&gt;</span><span class="w"> </span>println<span class="o">(</span>jetSet<span class="o">)</span>
<span class="go">Set(Boeing, Airbus, Lear)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>import scala.collection.mutable.Set
<span class="go">import scala.collection.mutable.Set

</span><span class="gp">scala&gt;</span><span class="w"> </span>val movieSet <span class="o">=</span> Set<span class="o">(</span><span class="s2">"Hitch"</span>, <span class="s2">"Poltergeist"</span><span class="o">)</span>
<span class="go">movieSet: scala.collection.mutable.Set[String] = Set(Poltergeist, Hitch)

</span><span class="gp">scala&gt;</span><span class="w"> </span>movieSet +<span class="o">=</span> <span class="s2">"Shrek"</span>
<span class="go">res4: movieSet.type = Set(Poltergeist, Shrek, Hitch)

</span><span class="gp">scala&gt;</span><span class="w"> </span>println<span class="o">(</span>movieSet<span class="o">)</span>
<span class="go">Set(Poltergeist, Shrek, Hitch)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>val romanNumeral <span class="o">=</span> Map<span class="o">(</span>
<span class="gp">     |     1 -&gt;</span><span class="w"> </span><span class="s2">"I"</span>, 2 -&gt; <span class="s2">"II"</span>, 3 -&gt; <span class="s2">"III"</span>, 4 -&gt; <span class="s2">"IV"</span>, 5 -&gt; <span class="s2">"V"</span>
<span class="go">     |   )
</span><span class="gp">romanNumeral: scala.collection.immutable.Map[Int,String] = Map(5 -&gt;</span><span class="w"> </span>V, 1 -&gt; I, 2 -&gt; II, 3 -&gt; III, 4 -&gt; IV<span class="o">)</span>
<span class="go">
</span><span class="gp">scala&gt;</span><span class="w"> </span>println<span class="o">(</span>romanNumeral<span class="o">)</span>
<span class="gp">Map(5 -&gt;</span><span class="w"> </span>V, 1 -&gt; I, 2 -&gt; II, 3 -&gt; III, 4 -&gt; IV<span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>import scala.collection.mutable.Map
<span class="go">import scala.collection.mutable.Map

</span><span class="gp">scala&gt;</span><span class="w"> </span>val treasureMap <span class="o">=</span> Map[Int, String]<span class="o">()</span>
<span class="go">treasureMap: scala.collection.mutable.Map[Int,String] = Map()

</span><span class="gp">scala&gt;</span><span class="w"> </span>treasureMap +<span class="o">=</span> <span class="o">(</span>1 -&gt; <span class="s2">"Go to island."</span><span class="o">)</span>
<span class="gp">res8: treasureMap.type = Map(1 -&gt;</span><span class="w"> </span>Go to island.<span class="o">)</span>
<span class="go">
</span><span class="gp">scala&gt;</span><span class="w"> </span>treasureMap +<span class="o">=</span> <span class="o">(</span>2 -&gt; <span class="s2">"Find big X on ground."</span><span class="o">)</span>
<span class="gp">res9: treasureMap.type = Map(2 -&gt;</span><span class="w"> </span>Find big X on ground., 1 -&gt; Go to island.<span class="o">)</span>
<span class="go">
</span><span class="gp">scala&gt;</span><span class="w"> </span>treasureMap +<span class="o">=</span> <span class="o">(</span>3 -&gt; <span class="s2">"Dig."</span><span class="o">)</span>
<span class="gp">res10: treasureMap.type = Map(2 -&gt;</span><span class="w"> </span>Find big X on ground., 1 -&gt; Go to island., 3 -&gt; Dig.<span class="o">)</span>
<span class="go">
</span><span class="gp">scala&gt;</span><span class="w"> </span>println<span class="o">(</span>treasureMap<span class="o">(</span>2<span class="o">))</span>
<span class="go">Find big X on ground.</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="learn-to-recognize-the-functional-style">1.7. Learn to recognize the functional style</h3>
<div class="paragraph">
<p>Scala allows you to program in an <strong>imperative style</strong>, but encourages you to adopt a more <strong>functional style</strong>.</p>
</div>
<div class="paragraph">
<p>A balanced attitude for Scala programmers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prefer vals, immutable objects, and methods without side effects. Reach for them first.</p>
</li>
<li>
<p>Use vars, mutable objects, and methods with side effects when you have a specific need and justification for them.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// imperative style</span>
<span class="k">def</span> <span class="nf">printArgs</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">i</span> <span class="k">=</span> <span class="mi">0</span>
  <span class="nf">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="nv">args</span><span class="o">.</span><span class="py">length</span><span class="o">)</span> <span class="o">{</span>
    <span class="nf">println</span><span class="o">(</span><span class="nf">args</span><span class="o">(</span><span class="n">i</span><span class="o">))</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// not purely functional style with side effects—in this case,</span>
<span class="c1">// its side effect is printing to the standard output stream.</span>
<span class="k">def</span> <span class="nf">printArgs</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="nf">for</span> <span class="o">(</span><span class="n">arg</span> <span class="k">&lt;-</span> <span class="n">args</span><span class="o">)</span>
    <span class="nf">println</span><span class="o">(</span><span class="n">arg</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// or this:</span>
<span class="k">def</span> <span class="nf">printArgs</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="nv">args</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// purely functional style without side effects or vars in sight.</span>
<span class="k">def</span> <span class="nf">formatArgs</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">=</span> <span class="nv">args</span><span class="o">.</span><span class="py">mkString</span><span class="o">(</span><span class="s">"\n"</span><span class="o">)</span>

<span class="k">val</span> <span class="nv">res</span> <span class="k">=</span> <span class="nf">formatArgs</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"zero"</span><span class="o">,</span> <span class="s">"one"</span><span class="o">,</span> <span class="s">"two"</span><span class="o">))</span>
<span class="nf">assert</span><span class="o">(</span><span class="n">res</span> <span class="o">==</span> <span class="s">"zero\none\ntwo"</span><span class="o">)</span>

<span class="nf">println</span><span class="o">(</span><span class="nf">formatArgs</span><span class="o">(</span><span class="n">args</span><span class="o">))</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="classes-and-objects">2. Classes and Objects</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A class is a blueprint for objects. Once you define a class, you can create objects from the class blueprint with the keyword <strong>new</strong>.</p>
</div>
<div class="paragraph">
<p>Inside a class definition, you place fields and methods, which are collectively called members.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Fields</strong>, which you define with either val or var, are vari- ables that refer to objects.</p>
</li>
<li>
<p><strong>Methods</strong>, which you define with def, contain executable code.</p>
</li>
<li>
<p>The fields hold the state, or data, of an object, whereas the methods use that data to do the computational work of the object.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>class ChecksumAccumulator <span class="o">{</span>
<span class="go">     |   private var sum = 0
     |   def add(b: Byte) { sum += b }
     |   def checksum(): Int = ~(sum &amp; 0xFF) + 1
     | }
defined class ChecksumAccumulator

</span><span class="gp">scala&gt;</span><span class="w"> </span>val acc <span class="o">=</span> new ChecksumAccumulator
<span class="go">acc: ChecksumAccumulator = ChecksumAccumulator@4756971e

</span><span class="gp">scala&gt;</span><span class="w"> </span>acc.add<span class="o">(</span>22<span class="o">)</span>
<span class="go">
</span><span class="gp">scala&gt;</span><span class="w"> </span>acc.checksum
<span class="go">res13: Int = -22</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="singleton-object">2.1. Singleton object</h3>
<div class="paragraph">
<p>A <strong>singleton object</strong> definition looks like a class definition, except instead of the keyword class you use the keyword object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">import</span> <span class="nn">scala.collection.mutable.Map</span>

<span class="k">object</span> <span class="nc">ChecksumAccumulator</span> <span class="o">{</span>
  <span class="k">private</span> <span class="k">val</span> <span class="nv">cache</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">]()</span>

  <span class="k">def</span> <span class="nf">calculate</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span>
    <span class="nf">if</span> <span class="o">(</span><span class="nv">cache</span><span class="o">.</span><span class="py">contains</span><span class="o">(</span><span class="n">s</span><span class="o">))</span>
      <span class="nf">cache</span><span class="o">(</span><span class="n">s</span><span class="o">)</span>
    <span class="k">else</span> <span class="o">{</span>
      <span class="k">val</span> <span class="nv">acc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ChecksumAccumulator</span>
      <span class="nf">for</span> <span class="o">(</span><span class="n">c</span> <span class="k">&lt;-</span> <span class="n">s</span><span class="o">)</span>
        <span class="nv">acc</span><span class="o">.</span><span class="py">add</span><span class="o">(</span><span class="nv">c</span><span class="o">.</span><span class="py">toByte</span><span class="o">)</span>
        <span class="k">val</span> <span class="nv">cs</span> <span class="k">=</span> <span class="nv">acc</span><span class="o">.</span><span class="py">checksum</span><span class="o">()</span>
        <span class="n">cache</span> <span class="o">+=</span> <span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">cs</span><span class="o">)</span>
        <span class="n">cs</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="companion-object">2.2. Companion object</h3>
<div class="paragraph">
<p>When a singleton object shares the same name with a class, it is called that class’s <strong>companion object</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You must define both the class and its companion object in the same source file.</p>
</li>
<li>
<p>The class is called the <strong>companion class</strong> of the singleton object.</p>
</li>
<li>
<p>A class and its companion object can access each other’s private members.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// In file ChecksumAccumulator.scala</span>
<span class="k">class</span> <span class="nc">ChecksumAccumulator</span> <span class="o">{</span>
  <span class="k">private</span> <span class="k">var</span> <span class="n">sum</span> <span class="k">=</span> <span class="mi">0</span>
  <span class="k">def</span> <span class="nf">add</span><span class="o">(</span><span class="n">b</span><span class="k">:</span> <span class="kt">Byte</span><span class="o">)</span> <span class="o">{</span> <span class="n">sum</span> <span class="o">+=</span> <span class="n">b</span> <span class="o">}</span>
  <span class="k">def</span> <span class="nf">checksum</span><span class="o">()</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">~(</span><span class="n">sum</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="o">}</span>

<span class="k">import</span> <span class="nn">scala.collection.mutable.Map</span>

<span class="k">object</span> <span class="nc">ChecksumAccumulator</span> <span class="o">{</span>
  <span class="k">private</span> <span class="k">val</span> <span class="nv">cache</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">]()</span>

  <span class="k">def</span> <span class="nf">calculate</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span>
    <span class="nf">if</span> <span class="o">(</span><span class="nv">cache</span><span class="o">.</span><span class="py">contains</span><span class="o">(</span><span class="n">s</span><span class="o">))</span>
      <span class="nf">cache</span><span class="o">(</span><span class="n">s</span><span class="o">)</span>
    <span class="k">else</span> <span class="o">{</span>
      <span class="k">val</span> <span class="nv">acc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ChecksumAccumulator</span>
      <span class="nf">for</span> <span class="o">(</span><span class="n">c</span> <span class="k">&lt;-</span> <span class="n">s</span><span class="o">)</span>
        <span class="nv">acc</span><span class="o">.</span><span class="py">add</span><span class="o">(</span><span class="nv">c</span><span class="o">.</span><span class="py">toByte</span><span class="o">)</span>
        <span class="k">val</span> <span class="nv">cs</span> <span class="k">=</span> <span class="nv">acc</span><span class="o">.</span><span class="py">checksum</span><span class="o">()</span>
        <span class="n">cache</span> <span class="o">+=</span> <span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">cs</span><span class="o">)</span>
        <span class="n">cs</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="standalone-object">2.3. Standalone object</h3>
<div class="paragraph">
<p>A singleton object that does not share the same name with a companion class is called a <strong>standalone object</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can use standalone objects for many purposes, including collecting related utility methods together, or defining an entry point to a Scala application.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// In file Summer.scala</span>
<span class="k">import</span> <span class="nn">ChecksumAccumulator.calculate</span>

<span class="k">object</span> <span class="nc">Summer</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="nf">for</span> <span class="o">(</span><span class="n">arg</span> <span class="k">&lt;-</span> <span class="n">args</span><span class="o">)</span>
      <span class="nf">println</span><span class="o">(</span><span class="n">arg</span> <span class="o">+</span><span class="s">": "</span><span class="o">+</span> <span class="nf">calculate</span><span class="o">(</span><span class="n">arg</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>scalac Summer.scala ChecksumAccumulator.scala
<span class="go">
</span><span class="gp">$</span><span class="w"> </span>scala Summer Hello World
<span class="go">Hello: -244
World: -8</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="basic-types-and-operations">3. Basic Types and Operations</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="some-basic-types">3.1. Some basic types</h3>
<div class="paragraph">
<p>Collectively, types <code>Byte</code>, <code>Short</code>, <code>Int</code>, <code>Long</code>, and <code>Char</code> are called integral types. The integral types plus <code>Float</code> and <code>Double</code> are called numeric types.</p>
</div>
<div class="paragraph">
<p>Other than <code>String</code>, which resides in package <code>java.lang</code>, all of the types are members of package scala.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Range</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8-bit signed two’s complement integer (-27 to 27 - 1, inclusive)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Short</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16-bit signed two’s complement integer (-215 to 215 - 1, inclusive)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit signed two’s complement integer (-231 to 231 - 1, inclusive)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-bit signed two’s complement integer (-263 to 263 - 1, inclusive)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Char</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16-bit unsigned Unicode character (0 to 216 - 1, inclusive)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a sequence of Chars</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit IEEE 754 single-precision float</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-bit IEEE 754 double-precision float</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true or false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="operators-are-methods">3.2. Operators are methods</h3>
<div class="paragraph">
<p>Scala provides a rich set of operators for its basic types.</p>
</div>
<div class="paragraph">
<p>These operators are actually just a nice syntax for ordinary method calls.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For example, <code>1 + 2</code> really means the same thing as <code>(1).+(2)</code>.</p>
<div class="paragraph">
<p>In other words, class <code>Int</code> contains a method named <code>+</code> that takes an <code>Int</code> and returns an <code>Int</code> result.</p>
</div>
<div class="paragraph">
<p>This <code>+</code> method is invoked when you add two Ints:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">sum</span> <span class="k">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">sum</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">sumMore</span> <span class="k">=</span> <span class="o">(</span><span class="mi">2</span><span class="o">).+(</span><span class="mi">2</span><span class="o">)</span>
<span class="n">sumMore</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">4</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In fact, <code>Int</code> contains several <strong>overloaded</strong> <code>+</code> methods that take different parameter types.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">longSum</span> <span class="k">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2L</span>
<span class="n">longSum</span><span class="k">:</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="o">(</span><span class="mi">2</span><span class="o">).+(</span><span class="mi">2L</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">longSumMore</span> <span class="k">=</span> <span class="o">(</span><span class="mi">2</span><span class="o">).+(</span><span class="mi">2L</span><span class="o">)</span>
<span class="n">longSumMore</span><span class="k">:</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">4</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>+</code> symbol is an <strong>operator</strong>—an <strong>infix operator</strong> to be specific.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Operator notation is not limited to methods like <code>+</code> that look like operators in other languages.</p>
</li>
<li>
<p>You can use <em>any</em> method in operator notation.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">s</span> <span class="k">=</span> <span class="s">"Hello, world!"</span>
<span class="n">s</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">Hello</span><span class="o">,</span> <span class="n">world</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">s</span> <span class="n">indexOf</span> <span class="sc">'o'</span> <span class="c1">// Scala invokes s.indexOf('o')</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">4</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Any method can be an operator</div>
<div class="paragraph">
<p>In Scala operators are not special language syntax: any method can be an operator.</p>
</div>
<div class="paragraph">
<p>What makes a method an operator is how you use it.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When you write <code>s.indexOf('o')</code>, indexOf is <strong>not an operator</strong>.</p>
</li>
<li>
<p>But when you write <code>s indexOf 'o'</code>, indexOf <strong>is an operator</strong>, because you&#8217;re using it in <strong>operator notation</strong>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <strong>infix</strong> operation notation, which means the method to invoke sits betwwen the object and the parameter or parameters you wish to pass to the method, as "2 + 2". Scala also has two other operation notations: <strong>prefix</strong> and <strong>postfix</strong>.</p>
</div>
<div class="paragraph">
<p>In contrast to the infix operator notation—in which operators take two operands, one to the left and the other to the right—<strong>prefix and postfix operators are unary</strong>: they take just one operand.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In prefix notation, the operand is to the right of the operator.</p>
<div class="paragraph">
<p>Some examples of prefix operators are <code>-2.0</code>, <code>!found</code>, and <code>~0xFF</code>.</p>
</div>
<div class="paragraph">
<p>As with the infix operators, these prefix operators are a shorthand way of invoking methods.</p>
</div>
<div class="paragraph">
<p>In this case, however, the name of the method has "unary_" prepended to the operator character.</p>
</div>
<div class="paragraph">
<p>For instance, Scala will transform the expression <code>-2.0</code> into the method invocation <code>(2.0).unary_-</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="o">-</span><span class="mf">2.0</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="o">(</span><span class="mf">2.0</span><span class="o">).</span><span class="py">unary_-</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The only identifiers that can be used as prefix operators are <code>+</code>, <code>-</code>, <code>!</code>, and <code>~</code>.</p>
</div>
</li>
<li>
<p><strong>Postfix operators are methods that take no arguments</strong>, when they are invoked without a dot or parentheses.</p>
<div class="paragraph">
<p>In Scala, you can leave off empty parentheses on method calls.</p>
</div>
<div class="paragraph">
<p>The convention is that you include parentheses if the method has <strong>side effects</strong>, such as <code>println()</code>,</p>
</div>
<div class="literalblock">
<div class="content">
<pre>but you can leave them off if the method has *no side effects*, such as `toLowerCase` invoked on a String:</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">s</span> <span class="k">=</span> <span class="s">"Hello, world!"</span>
<span class="n">s</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">Hello</span><span class="o">,</span> <span class="n">world</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">s</span><span class="o">.</span><span class="py">toLowerCase</span>
<span class="n">res10</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">hello</span><span class="o">,</span> <span class="n">world</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">s</span> <span class="n">toLowerCase</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">postfix</span> <span class="kt">operator</span> <span class="kt">toLowerCase</span> <span class="kt">should</span> <span class="kt">be</span> <span class="kt">enabled</span>
<span class="n">by</span> <span class="n">making</span> <span class="n">the</span> <span class="k">implicit</span> <span class="n">value</span> <span class="nv">scala</span><span class="o">.</span><span class="py">language</span><span class="o">.</span><span class="py">postfixOps</span> <span class="n">visible</span><span class="o">.</span>
<span class="nc">This</span> <span class="n">can</span> <span class="n">be</span> <span class="n">achieved</span> <span class="n">by</span> <span class="n">adding</span> <span class="n">the</span> <span class="k">import</span> <span class="nn">clause</span> <span class="ss">'import</span> <span class="nv">scala</span><span class="o">.</span><span class="py">language</span><span class="o">.</span><span class="py">postfixOps</span><span class="o">'</span>
<span class="n">or</span> <span class="n">by</span> <span class="n">setting</span> <span class="n">the</span> <span class="n">compiler</span> <span class="n">option</span> <span class="o">-</span><span class="n">language</span><span class="k">:</span><span class="kt">postfixOps.</span>
<span class="kt">See</span> <span class="kt">the</span> <span class="kt">Scaladoc</span> <span class="kt">for</span> <span class="kt">value</span> <span class="kt">scala.language.postfixOps</span> <span class="kt">for</span> <span class="kt">a</span> <span class="kt">discussion</span>
<span class="n">why</span> <span class="n">the</span> <span class="n">feature</span> <span class="n">should</span> <span class="n">be</span> <span class="n">explicitly</span> <span class="n">enabled</span><span class="o">.</span>
       <span class="n">s</span> <span class="n">toLowerCase</span>
         <span class="o">^</span>
<span class="n">res11</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">hello</span><span class="o">,</span> <span class="n">world</span><span class="o">!</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>A simple MyInt type like Int:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">v</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">private</span> <span class="k">val</span> <span class="nv">value</span> <span class="k">=</span> <span class="n">v</span>

  <span class="k">def</span> <span class="nf">+</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">value</span> <span class="o">+</span> <span class="nv">x</span><span class="o">.</span><span class="py">value</span><span class="o">)</span>

  <span class="k">def</span> <span class="nf">+</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">value</span> <span class="o">+</span> <span class="n">x</span><span class="o">)</span>

  <span class="k">def</span> <span class="nf">unary_-</span><span class="o">()</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(-</span><span class="n">value</span><span class="o">)</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">equals</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">v</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">value</span> <span class="o">==</span> <span class="n">v</span>
    <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="kc">false</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="k">=</span> <span class="nv">value</span><span class="o">.</span><span class="py">hashCode</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="n">s</span><span class="s">"$v"</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">MyInt</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">v</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">v</span><span class="o">)</span>
  <span class="k">def</span> <span class="nf">unapply</span><span class="o">(</span><span class="n">v</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="n">v</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">implicit</span> <span class="k">def</span> <span class="nf">covertInttoMyInt</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>

<span class="k">val</span> <span class="nv">x1</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">nums</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="nc">MyInt</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span>
  <span class="n">x1</span> <span class="o">+</span> <span class="n">x1</span><span class="o">,</span>
  <span class="n">x1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">,</span>
  <span class="mi">2</span> <span class="o">+</span> <span class="n">x1</span><span class="o">,</span>
  <span class="o">-</span> <span class="n">x1</span><span class="o">,</span>
  <span class="o">)</span>

<span class="nf">println</span><span class="o">(</span><span class="nv">nums</span><span class="o">.</span><span class="py">mkString</span><span class="o">(</span><span class="s">"("</span><span class="o">,</span> <span class="s">", "</span><span class="o">,</span> <span class="s">")"</span><span class="o">))</span>
<span class="c1">// (2, 4, 4, 4, -2)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="functional-objects">4. Functional Objects</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// a functional objects that do not have any mutable state.</span>
<span class="k">class</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">d</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// class parameters and constructors</span>
  <span class="nf">require</span><span class="o">(</span><span class="n">d</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="c1">// checking preconditions</span>

  <span class="k">private</span> <span class="k">val</span> <span class="nv">g</span> <span class="k">=</span> <span class="nf">gcd</span><span class="o">(</span><span class="nv">n</span><span class="o">.</span><span class="py">abs</span><span class="o">,</span> <span class="nv">d</span><span class="o">.</span><span class="py">abs</span><span class="o">)</span> <span class="c1">// private fields and methods</span>

  <span class="c1">// adding fields</span>
  <span class="k">val</span> <span class="nv">numer</span> <span class="k">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">g</span>
  <span class="k">val</span> <span class="nv">denom</span> <span class="k">=</span> <span class="n">d</span> <span class="o">/</span> <span class="n">g</span>

  <span class="k">def</span> <span class="nf">this</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="nf">this</span><span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="c1">// auxiliary constructor</span>

  <span class="k">def</span> <span class="nf">+</span> <span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Rational</span><span class="o">)</span><span class="k">:</span> <span class="kt">Rational</span> <span class="o">=</span> <span class="c1">// defining operators</span>
    <span class="k">new</span> <span class="nc">Rational</span><span class="o">(</span>
      <span class="k">this</span><span class="o">.</span><span class="py">numer</span> <span class="o">*</span> <span class="nv">that</span><span class="o">.</span><span class="py">denom</span> <span class="o">+</span> <span class="nv">that</span><span class="o">.</span><span class="py">numer</span> <span class="o">*</span> <span class="n">denom</span><span class="o">,</span> <span class="c1">// self references</span>
      <span class="n">denom</span> <span class="o">*</span> <span class="nv">that</span><span class="o">.</span><span class="py">denom</span>
    <span class="o">)</span>

  <span class="k">def</span> <span class="nf">+</span> <span class="o">(</span><span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Rational</span> <span class="o">=</span> <span class="c1">// method overloading</span>
    <span class="k">new</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">numer</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">denom</span><span class="o">,</span> <span class="n">denom</span><span class="o">)</span>

  <span class="k">def</span> <span class="nf">*</span> <span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Rational</span><span class="o">)</span><span class="k">:</span> <span class="kt">Rational</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">numer</span> <span class="o">*</span> <span class="nv">that</span><span class="o">.</span><span class="py">numer</span><span class="o">,</span> <span class="n">denom</span> <span class="o">*</span> <span class="nv">that</span><span class="o">.</span><span class="py">denom</span><span class="o">)</span>

  <span class="c1">// reimplementing the toString method</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="n">numer</span> <span class="o">+</span><span class="s">"/"</span><span class="o">+</span> <span class="n">denom</span>

  <span class="c1">// private fields and methods</span>
  <span class="k">private</span> <span class="k">def</span> <span class="nf">gcd</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="nf">if</span> <span class="o">(</span><span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="n">a</span> <span class="k">else</span> <span class="nf">gcd</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// implicit conversions</span>
<span class="k">object</span> <span class="nc">ImplicitConversions</span> <span class="o">{</span>
  <span class="k">import</span> <span class="nn">scala.language.implicitConversions</span>

  <span class="k">implicit</span> <span class="k">def</span> <span class="nf">intToRational</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">x</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Rational</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
    <span class="k">val</span> <span class="nv">y</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Rational</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
    <span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"${x} + ${y} = ${x + y}"</span><span class="o">)</span>
    <span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"${x} + 2 = ${x + 2}"</span><span class="o">)</span>

    <span class="k">import</span> <span class="nn">ImplicitConversions._</span>
    <span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"2 + ${x} = ${2 + x}"</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="built-in-control-structures">5. Built-in Control Structures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Scala has only a handful of built-in control structures. The only control structures are <strong>if</strong>, <strong>while</strong>, <strong>for</strong>, <strong>try</strong>, <strong>match</strong>, and <strong>function calls</strong>.</p>
</div>
<div class="paragraph">
<p>One thing you will notice is that almost all of Scala’s control structures result in some value.</p>
</div>
<div class="sect2">
<h3 id="if-expressions">5.1. If expressions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// imperative style</span>
<span class="k">var</span> <span class="n">filename</span> <span class="k">=</span> <span class="s">"default.txt"</span>
<span class="nf">if</span> <span class="o">(!</span><span class="nv">args</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span>
  <span class="n">filename</span> <span class="k">=</span> <span class="nf">args</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Scala’s idiom for conditional initialization.</span>
<span class="k">val</span> <span class="nv">filename</span> <span class="k">=</span>
  <span class="nf">if</span> <span class="o">(!</span><span class="nv">args</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span> <span class="nf">args</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
  <span class="k">else</span> <span class="s">"default.txt"</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="while-loops">5.2. While loops</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// while loop</span>
<span class="k">def</span> <span class="nf">gcdLoop</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Long</span><span class="o">)</span><span class="k">:</span> <span class="kt">Long</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">a</span> <span class="k">=</span> <span class="n">x</span>
  <span class="k">var</span> <span class="n">b</span> <span class="k">=</span> <span class="n">y</span>
  <span class="nf">while</span> <span class="o">(</span><span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">temp</span> <span class="k">=</span> <span class="n">a</span> <span class="n">a</span><span class="k">=</span><span class="n">b</span><span class="o">%</span><span class="n">a</span>
    <span class="n">b</span> <span class="k">=</span> <span class="n">temp</span>
  <span class="o">}</span>
  <span class="n">b</span>
<span class="o">}</span>

<span class="c1">// do-while</span>
<span class="k">var</span> <span class="n">line</span> <span class="k">=</span> <span class="s">""</span>
<span class="k">do</span> <span class="o">{</span>
  <span class="n">line</span> <span class="k">=</span> <span class="nf">readLine</span><span class="o">()</span>
  <span class="nf">println</span><span class="o">(</span><span class="s">"Read: "</span><span class="o">+</span> <span class="n">line</span><span class="o">)</span>
<span class="o">}</span> <span class="nf">while</span> <span class="o">(</span><span class="n">line</span> <span class="o">!=</span> <span class="s">""</span><span class="o">)</span>

<span class="c1">// Scala assignment always results in the unit value, ().</span>
<span class="k">var</span> <span class="n">line</span> <span class="k">=</span> <span class="s">""</span>
<span class="nf">while</span> <span class="o">((</span><span class="n">line</span> <span class="k">=</span> <span class="nf">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="s">""</span><span class="o">)</span> <span class="c1">// This doesn’t work!</span>
  <span class="nf">println</span><span class="o">(</span><span class="s">"Read: "</span><span class="o">+</span> <span class="n">line</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="for-expressions">5.3. For expressions</h3>
<div class="ulist">
<ul>
<li>
<p>Iteration through collections</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>val filesHere <span class="o">=</span> <span class="o">(</span>new java.io.File<span class="o">(</span><span class="s2">"."</span><span class="o">))</span>.listFiles
<span class="go">filesHere: Array[java.io.File] = Array(./powerlog)

</span><span class="gp">scala&gt;</span><span class="w"> </span><span class="k">for</span> <span class="o">(</span>file &lt;- filesHere<span class="o">)</span>
<span class="go">     | println(file)
./powerlog

</span><span class="gp">scala&gt;</span><span class="w"> </span><span class="k">for</span> <span class="o">(</span>i &lt;- 1 to 4<span class="o">)</span>
<span class="go">     | println("Iteration "+ i)
Iteration 1
Iteration 2
Iteration 3
Iteration 4

</span><span class="gp">scala&gt;</span><span class="w"> </span><span class="k">for</span> <span class="o">(</span>i &lt;- 1 <span class="k">until </span>4<span class="o">)</span>
<span class="go">     | println("Iteration "+ i)
Iteration 1
Iteration 2
Iteration 3

// Not common in Scala...
</span><span class="gp">scala&gt;</span><span class="w"> </span><span class="k">for</span> <span class="o">(</span>i &lt;- 0 to filesHere.length - 1<span class="o">)</span>
<span class="go">     | println(filesHere(i))
./powerlog</span></code></pre>
</div>
</div>
</li>
<li>
<p>Filtering</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">val</span> <span class="nv">filesHere</span> <span class="k">=</span> <span class="o">(</span><span class="k">new</span> <span class="nv">java</span><span class="o">.</span><span class="py">io</span><span class="o">.</span><span class="py">File</span><span class="o">(</span><span class="s">"."</span><span class="o">)).</span><span class="py">listFiles</span>
<span class="nf">for</span> <span class="o">(</span><span class="n">file</span> <span class="k">&lt;-</span> <span class="n">filesHere</span> <span class="k">if</span> <span class="nv">file</span><span class="o">.</span><span class="py">getName</span><span class="o">.</span><span class="py">endsWith</span><span class="o">(</span><span class="s">".scala"</span><span class="o">))</span>
  <span class="nf">println</span><span class="o">(</span><span class="n">file</span><span class="o">)</span>

<span class="c1">// imperative style</span>
<span class="nf">for</span> <span class="o">(</span><span class="n">file</span> <span class="k">&lt;-</span> <span class="n">filesHere</span><span class="o">)</span>
  <span class="nf">if</span> <span class="o">(</span><span class="nv">file</span><span class="o">.</span><span class="py">getName</span><span class="o">.</span><span class="py">endsWith</span><span class="o">(</span><span class="s">".scala"</span><span class="o">))</span>
    <span class="nf">println</span><span class="o">(</span><span class="n">file</span><span class="o">)</span>

<span class="c1">// keep adding `if` clauses to include more filters</span>
<span class="nf">for</span> <span class="o">(</span>
  <span class="n">file</span> <span class="k">&lt;-</span> <span class="n">filesHere</span>
  <span class="k">if</span> <span class="nv">file</span><span class="o">.</span><span class="py">isFile</span>
  <span class="k">if</span> <span class="nv">file</span><span class="o">.</span><span class="py">getName</span><span class="o">.</span><span class="py">endsWith</span><span class="o">(</span><span class="s">".scala"</span><span class="o">)</span>
<span class="o">)</span> <span class="nf">println</span><span class="o">(</span><span class="n">file</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Nested iteration</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// If you add multiple &lt;- clauses, you will get nested “loops.</span>
<span class="k">def</span> <span class="nf">fileLines</span><span class="o">(</span><span class="n">file</span><span class="k">:</span> <span class="kt">java.io.File</span><span class="o">)</span> <span class="k">=</span>
  <span class="nv">scala</span><span class="o">.</span><span class="py">io</span><span class="o">.</span><span class="py">Source</span><span class="o">.</span><span class="py">fromFile</span><span class="o">(</span><span class="n">file</span><span class="o">).</span><span class="py">getLines</span><span class="o">().</span><span class="py">toList</span>

<span class="k">def</span> <span class="nf">grep</span><span class="o">(</span><span class="n">pattern</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span>
  <span class="nf">for</span> <span class="o">(</span>
     <span class="n">file</span> <span class="k">&lt;-</span> <span class="n">filesHere</span>
     <span class="k">if</span> <span class="nv">file</span><span class="o">.</span><span class="py">getName</span><span class="o">.</span><span class="py">endsWith</span><span class="o">(</span><span class="s">".scala"</span><span class="o">);</span>
     <span class="n">line</span> <span class="k">&lt;-</span> <span class="nf">fileLines</span><span class="o">(</span><span class="n">file</span><span class="o">)</span>
     <span class="k">if</span> <span class="nv">line</span><span class="o">.</span><span class="py">trim</span><span class="o">.</span><span class="py">matches</span><span class="o">(</span><span class="n">pattern</span><span class="o">)</span>
  <span class="o">)</span> <span class="nf">println</span><span class="o">(</span><span class="n">file</span> <span class="o">+</span><span class="s">": "</span><span class="o">+</span> <span class="nv">line</span><span class="o">.</span><span class="py">trim</span><span class="o">)</span>

<span class="nf">grep</span><span class="o">(</span><span class="s">".*gcd.*"</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Mid-stream variable bindings</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">fileLines</span><span class="o">(</span><span class="n">file</span><span class="k">:</span> <span class="kt">java.io.File</span><span class="o">)</span> <span class="k">=</span>
  <span class="nv">scala</span><span class="o">.</span><span class="py">io</span><span class="o">.</span><span class="py">Source</span><span class="o">.</span><span class="py">fromFile</span><span class="o">(</span><span class="n">file</span><span class="o">).</span><span class="py">getLines</span><span class="o">().</span><span class="py">toList</span>

<span class="k">def</span> <span class="nf">grep</span><span class="o">(</span><span class="n">pattern</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span>
  <span class="nf">for</span> <span class="o">(</span>
     <span class="n">file</span> <span class="k">&lt;-</span> <span class="n">filesHere</span>
     <span class="k">if</span> <span class="nv">file</span><span class="o">.</span><span class="py">getName</span><span class="o">.</span><span class="py">endsWith</span><span class="o">(</span><span class="s">".scala"</span><span class="o">);</span>
     <span class="n">line</span> <span class="k">&lt;-</span> <span class="nf">fileLines</span><span class="o">(</span><span class="n">file</span><span class="o">)</span>
     <span class="c1">// You can do this by binding the result to a new variable using an equals sign (=).</span>
     <span class="c1">// The bound variable is introduced and used just like a val, only with the val keyword left out.</span>
     <span class="n">trimmed</span> <span class="k">=</span> <span class="nv">line</span><span class="o">.</span><span class="py">trim</span>
     <span class="k">if</span> <span class="nv">trimmed</span><span class="o">.</span><span class="py">matches</span><span class="o">(</span><span class="n">pattern</span><span class="o">)</span>
  <span class="o">)</span> <span class="nf">println</span><span class="o">(</span><span class="n">file</span> <span class="o">+</span><span class="s">": "</span><span class="o">+</span> <span class="n">trimmed</span><span class="o">)</span>

<span class="nf">grep</span><span class="o">(</span><span class="s">".*gcd.*"</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Producing a new collection</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// for [clauses] yield [body]</span>
<span class="k">def</span> <span class="nf">scalaFiles</span> <span class="k">=</span>
  <span class="k">for</span> <span class="o">{</span>
    <span class="n">file</span> <span class="k">&lt;-</span> <span class="n">filesHere</span>
    <span class="k">if</span> <span class="nv">file</span><span class="o">.</span><span class="py">getName</span><span class="o">.</span><span class="py">endsWith</span><span class="o">(</span><span class="s">".scala"</span><span class="o">)</span>
  <span class="o">}</span> <span class="k">yield</span> <span class="n">file</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nf">for</span> <span class="o">(</span><span class="n">file</span> <span class="k">&lt;-</span> <span class="n">filesHere</span> <span class="k">if</span> <span class="nv">file</span><span class="o">.</span><span class="py">getName</span><span class="o">.</span><span class="py">endsWith</span><span class="o">(</span><span class="s">".scala"</span><span class="o">))</span> <span class="o">{</span>
  <span class="k">yield</span> <span class="n">file</span>  <span class="c1">// Syntax error!</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="exception-handling-with-try-expressions">5.4. Exception handling with try expressions</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Throwing exceptions</strong></p>
<div class="paragraph">
<p>Throwing an exception looks the same as in Java. You create an exception object and then you throw it with the throw keyword:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">throw</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Although it may seem somewhat paradoxical, in Scala, <strong>throw is an expression</strong> that has a result type. Here is an example in which that result type matters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// What happens here is that if n is even, half will be initialized to half of n.</span>
<span class="c1">// If n is not even, an exception will be thrown before half can be initialized to anything at all.</span>
<span class="c1">// Technically, an exception throw has type Nothing.</span>
<span class="k">val</span> <span class="nv">half</span> <span class="k">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">n</span><span class="o">/</span><span class="mi">2</span>
  <span class="o">}</span><span class="k">else</span><span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nc">RuntimeException</span><span class="o">(</span><span class="s">"n must be even"</span><span class="o">)</span>
  <span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Catching exceptions</strong></p>
<div class="paragraph">
<p>The syntax for catch clauses was chosen for its consistency with an important part of Scala: <strong>pattern matching</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">import</span> <span class="nn">java.io.FileReader</span>
<span class="k">import</span> <span class="nn">java.io.FileNotFoundException</span>
<span class="k">import</span> <span class="nn">java.io.IOException</span>

<span class="k">try</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">f</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">FileReader</span><span class="o">(</span><span class="s">"input.txt"</span><span class="o">)</span>
  <span class="c1">// Use and close file</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">ex</span><span class="k">:</span> <span class="kt">FileNotFoundException</span> <span class="o">=&gt;</span> <span class="c1">// Handle missing file</span>
  <span class="k">case</span> <span class="n">ex</span><span class="k">:</span> <span class="kt">IOException</span> <span class="o">=&gt;</span> <span class="c1">// Handle other I/O error</span>
  <span class="k">case</span> <span class="k">_:</span> <span class="kt">Exception</span> <span class="o">=&gt;</span> <span class="c1">// Handle other error</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>The <code>finally</code> clause</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">import</span> <span class="nn">java.io.FileReader</span>

<span class="k">val</span> <span class="nv">file</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">FileReader</span><span class="o">(</span><span class="s">"input.txt"</span><span class="o">)</span>
<span class="k">try</span> <span class="o">{</span>
  <span class="c1">// Use the file</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
  <span class="nv">file</span><span class="o">.</span><span class="py">close</span><span class="o">()</span>  <span class="c1">// Be sure to close the file</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Loan Pattern</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// In file Loan.scala</span>
<span class="k">object</span> <span class="nc">Disposable</span> <span class="o">{</span>
  <span class="c1">// using statement with C# style (disposable pattern)</span>
  <span class="k">def</span> <span class="nf">using</span><span class="o">(</span><span class="n">closer</span><span class="k">:</span> <span class="kt">AutoCloseable</span><span class="o">)(</span><span class="n">op</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">op</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="nv">closer</span><span class="o">.</span><span class="py">close</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="k">import</span> <span class="nn">Disposable._</span>
    <span class="k">import</span> <span class="nn">java.io.</span><span class="o">{</span><span class="nc">BufferedReader</span><span class="o">,</span> <span class="nc">FileReader</span><span class="o">,</span> <span class="nc">PrintWriter</span><span class="o">}</span>
    <span class="k">import</span> <span class="nn">java.util.Date</span>

    <span class="k">val</span> <span class="nv">writer</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PrintWriter</span><span class="o">(</span><span class="s">"date.txt"</span><span class="o">)</span>
    <span class="nf">using</span><span class="o">(</span><span class="n">writer</span><span class="o">)</span> <span class="o">{</span>
      <span class="nv">writer</span><span class="o">.</span><span class="py">println</span><span class="o">(</span><span class="k">new</span> <span class="nc">Date</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="k">val</span> <span class="nv">reader</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">FileReader</span><span class="o">(</span><span class="s">"date.txt"</span><span class="o">))</span>
    <span class="nf">using</span><span class="o">(</span><span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
      <span class="nf">println</span><span class="o">(</span><span class="nv">reader</span><span class="o">.</span><span class="py">readLine</span><span class="o">())</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Yielding a value</strong></p>
<div class="paragraph">
<p>As with most other Scala control structures, try-catch-finally results in a value.</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>The result is that of the <code>try</code> clause if no exception is thrown, or the relevant <code>catch</code> clause if an exception is thrown and caught.</p>
</li>
<li>
<p>If an exception is thrown but not caught, the expression has no result at all.</p>
</li>
<li>
<p>The value computed in the <code>finally</code> clause, if there is one, is dropped.</p>
</li>
<li>
<p>Usually <code>finally</code> clauses do some kind of clean up such as closing a file; they should not normally change the value computed in the main body or a <code>catch</code> clause of the <code>try</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">import java.net.URL

import java.net.MalformedURLException
def urlFor(path: String) =
  try {
    new URL(path)
  } catch {
</span><span class="gp">    case e: MalformedURLException =&gt;</span><span class="w">
</span><span class="go">      new URL("http://www.scala-lang.org")
  }</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">The best way to think of finally clauses is as a way to ensure some side effect happens, such as closing an open file.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">scala&gt;</span><span class="w"> </span>def f<span class="o">()</span>: Int <span class="o">=</span> try <span class="o">{</span> <span class="k">return </span>1 <span class="o">}</span> finally <span class="o">{</span> <span class="k">return </span>2 <span class="o">}</span>
<span class="go">f: ()Int

</span><span class="gp">scala&gt;</span><span class="w"> </span>f
<span class="go">res9: Int = 2

</span><span class="gp">scala&gt;</span><span class="w"> </span>def g<span class="o">()</span>: Int <span class="o">=</span> try <span class="o">{</span> 1 <span class="o">}</span> finally <span class="o">{</span> 2 <span class="o">}</span>
<span class="gp">&lt;console&gt;</span>:11: warning: a pure expression does nothing <span class="k">in </span>statement position
<span class="go">       def g(): Int = try { 1 } finally { 2 }
                                          ^
g: ()Int

</span><span class="gp">scala&gt;</span><span class="w"> </span>g
<span class="go">res10: Int = 1</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="match-expressions">5.5. Match expressions</h3>
<div class="paragraph">
<p>Scala’s match expression lets you select from a number of alternatives, just like switch statements in other languages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">// A match expression that yields a value.
val firstArg = if (!args.isEmpty) args(0) else ""
val friend =
  firstArg match {
</span><span class="gp">    case "salt" =&gt;</span><span class="w"> </span><span class="s2">"pepper"</span>
<span class="gp">    case "chips" =&gt;</span><span class="w"> </span><span class="s2">"salsa"</span>
<span class="gp">    case "eggs" =&gt;</span><span class="w"> </span><span class="s2">"bacon"</span>
<span class="go">    // The default case is specified with an underscore (_), a wildcard symbol
    // frequently used in Scala as a placeholder for a completely unknown value.
</span><span class="gp">    case _ =&gt;</span><span class="w"> </span><span class="s2">"huh?"</span>
<span class="go">  }
println(friend)
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="living-without-break-and-continue">5.6. Living without break and continue</h3>
<div class="paragraph">
<p>You may have noticed that there has been no mention of break or continue. Scala leaves out these commands because they do not mesh well with function literals. It is clear what continue means inside a while loop, but what would it mean inside a function literal? While Scala supports both imperative and functional styles of programming, in this case it leans slightly towards <strong>functional programming</strong> in exchange for simplifying the language. Do not worry, though. There are many ways to program without break and continue, and if you take advantage of function literals, those alternatives can often be shorter than the original code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// searching through an argument list for a string that ends with “.scala”</span>
<span class="c1">// but does not start with a hyphen.</span>
<span class="c1">//</span>
<span class="c1">// int i = 0;                // This is Java</span>
<span class="c1">// boolean foundIt = false;</span>
<span class="c1">// while (i &lt; args.length) {</span>
<span class="c1">//   if (args[i].startsWith("-")) {</span>
<span class="c1">//     i = i + 1;</span>
<span class="c1">//     continue;</span>
<span class="c1">//   }</span>
<span class="c1">//</span>
<span class="c1">//   if (args[i].endsWith(".scala")) {</span>
<span class="c1">//     foundIt = true;</span>
<span class="c1">//     break;</span>
<span class="c1">//   }</span>
<span class="c1">//</span>
<span class="c1">//   i = i + 1;</span>
<span class="c1">// }</span>
<span class="c1">//</span>
<span class="c1">// Looping without break or continue in Scala</span>
<span class="k">var</span> <span class="n">i</span> <span class="k">=</span> <span class="mi">0</span>
<span class="k">var</span> <span class="n">foundIt</span> <span class="k">=</span> <span class="kc">false</span>
<span class="nf">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="nv">args</span><span class="o">.</span><span class="py">length</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">foundIt</span><span class="o">)</span> <span class="o">{</span>
  <span class="nf">if</span> <span class="o">(!</span><span class="nf">args</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="py">startsWith</span><span class="o">(</span><span class="s">"-"</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="nf">args</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="py">endsWith</span><span class="o">(</span><span class="s">".scala"</span><span class="o">))</span> <span class="o">{</span>
    <span class="n">foundIt</span> <span class="k">=</span> <span class="kc">true</span>
  <span class="o">}</span>

  <span class="n">i</span> <span class="k">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<span class="o">}</span>
<span class="nf">println</span><span class="o">(</span><span class="n">foundIt</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wanted to get rid of the vars in the above code snippet, one approach you could try is to rewrite the loop as a <strong>recursive</strong> function.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Rewrite the loop as a recursive function to get rid of the vars</span>
<span class="k">def</span> <span class="nf">searchFrom</span><span class="o">(</span><span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="nv">args</span><span class="o">.</span><span class="py">length</span><span class="o">)</span> <span class="o">-</span><span class="mi">1</span>
  <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="nf">args</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="py">startsWith</span><span class="o">(</span><span class="s">"-"</span><span class="o">))</span> <span class="nf">searchFrom</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
  <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="nf">args</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="py">endsWith</span><span class="o">(</span><span class="s">".scala"</span><span class="o">))</span> <span class="n">i</span>
  <span class="k">else</span> <span class="nf">searchFrom</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
<span class="o">}</span>
<span class="k">val</span> <span class="nv">foundIt</span> <span class="k">=</span> <span class="nf">searchFrom</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="nf">println</span><span class="o">(</span><span class="n">foundIt</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If after all this discussion you still feel the need to use break, there’s help in Scala’s standard library. Class Breaks in package <code>scala.util.control</code> offers a <code>break</code> method, which can be used to exit the an enclosing block that’s marked with <code>breakable</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">import</span> <span class="nn">scala.util.control.Breaks._</span>

<span class="k">import</span> <span class="nn">java.io._</span>

<span class="k">val</span> <span class="nv">in</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="nv">System</span><span class="o">.</span><span class="py">in</span><span class="o">))</span>
<span class="n">breakable</span> <span class="o">{</span>
  <span class="nf">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
    <span class="nf">println</span><span class="o">(</span><span class="s">"? "</span><span class="o">)</span>
    <span class="nf">if</span> <span class="o">(</span><span class="nv">in</span><span class="o">.</span><span class="py">readLine</span><span class="o">()</span> <span class="o">==</span> <span class="s">""</span><span class="o">)</span> <span class="n">break</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Breaks</code> class implements <code>break</code> by throwing an exception that is caught by an enclosing application of the <code>breakable</code> method. Therefore, the call to <code>break</code> does not need to be in the same method as the call to <code>breakable</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="refactoring-imperative-style-code">5.7. Refactoring imperative-style code</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">//   1   2   3   4   5   6   7   8   9</span>
<span class="c1">//   2   4   6   8  10  12  14  16  18</span>
<span class="c1">//   3   6   9  12  15  18  21  24  27</span>
<span class="c1">//   4   8  12  16  20  24  28  32  36</span>
<span class="c1">//   5  10  15  20  25  30  35  40  45</span>
<span class="c1">//   6  12  18  24  30  36  42  48  54</span>
<span class="c1">//   7  14  21  28  35  42  49  56  63</span>
<span class="c1">//   8  16  24  32  40  48  56  64  72</span>
<span class="c1">//   9  18  27  36  45  54  63  72  81</span>
<span class="k">object</span> <span class="nc">MultiTable</span> <span class="o">{</span>
  <span class="c1">// imperative-style code</span>
  <span class="c1">// def printMultiTable() {</span>
  <span class="c1">//   for( row &lt;- 1 to 9) {</span>
  <span class="c1">//     for( col &lt;- 1 to 9) {</span>
  <span class="c1">//       val prod = (row * col).toString</span>
  <span class="c1">//       val padding = " " * (4 - prod.size)</span>
  <span class="c1">//       print(s"${padding}${prod}")</span>
  <span class="c1">//     }</span>
  <span class="c1">//     println()</span>
  <span class="c1">//   }</span>
  <span class="c1">// }</span>

  <span class="c1">// Returns a row as sequence</span>
  <span class="k">def</span> <span class="nf">makeRowSeq</span><span class="o">(</span><span class="n">row</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span> <span class="c1">// ???</span>
    <span class="nf">for</span> <span class="o">(</span><span class="n">col</span> <span class="k">&lt;-</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">9</span><span class="o">)</span> <span class="k">yield</span> <span class="n">row</span> <span class="o">*</span> <span class="n">col</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">makeRow</span><span class="o">(</span><span class="n">row</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span> <span class="c1">// ???</span>
    <span class="nf">makeRowSeq</span><span class="o">(</span><span class="n">row</span><span class="o">).</span>
    <span class="nf">map</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">toString</span><span class="o">()).</span>
    <span class="nf">map</span><span class="o">(</span><span class="n">prod</span> <span class="k">=&gt;</span> <span class="n">s</span><span class="s">"${"</span> <span class="s">" * (4 - prod.size)}${prod}"</span><span class="o">).</span>
    <span class="nf">mkString</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">multiTable</span><span class="o">()</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span> <span class="c1">// ???</span>
    <span class="k">val</span> <span class="nv">tableSeq</span> <span class="k">=</span>
      <span class="nf">for</span> <span class="o">(</span><span class="n">row</span> <span class="k">&lt;-</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">9</span><span class="o">)</span> <span class="k">yield</span> <span class="o">{</span>
        <span class="nf">makeRow</span><span class="o">(</span><span class="n">row</span><span class="o">)</span>
      <span class="o">}</span>
    <span class="nv">tableSeq</span><span class="o">.</span><span class="py">mkString</span><span class="o">(</span><span class="s">"\n"</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">printMultiTable</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="n">multiTable</span>
    <span class="nf">println</span><span class="o">(</span><span class="n">table</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="nf">printMultiTable</span><span class="o">()</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="functions-and-closures">6. Functions and Closures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When programs get larger, you need some way to divide them into smaller, more manageable pieces. For dividing up control flow, Scala offers an approach familiar to all experienced programmers: divide the code into functions. In fact, Scala offers several ways to define functions that are not present in Java. Besides <strong>methods</strong>, which are <strong>functions that are members of some object</strong>, there are also <strong>functions nested within functions</strong>, <strong>function literals</strong>, and <strong>function values</strong>.</p>
</div>
<div class="sect2">
<h3 id="methods">6.1. Methods</h3>
<div class="paragraph">
<p>The most common way to define a function is as a member of some object. Such a function is called a <strong>method</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">import</span> <span class="nn">scala.io.Source</span>

<span class="c1">// LongLines with a private processLine method.</span>
<span class="k">object</span> <span class="nc">LongLines</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">processFile</span><span class="o">(</span><span class="n">filename</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">width</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">source</span> <span class="k">=</span> <span class="nv">Source</span><span class="o">.</span><span class="py">fromFile</span><span class="o">(</span><span class="n">filename</span><span class="o">)</span>
    <span class="nf">for</span> <span class="o">(</span><span class="n">line</span> <span class="k">&lt;-</span> <span class="nv">source</span><span class="o">.</span><span class="py">getLines</span><span class="o">())</span>
      <span class="nf">processLine</span><span class="o">(</span><span class="n">filename</span><span class="o">,</span> <span class="n">width</span><span class="o">,</span> <span class="n">line</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">private</span> <span class="k">def</span> <span class="nf">processLine</span><span class="o">(</span><span class="n">filename</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
    <span class="n">width</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">line</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="o">{</span>
      <span class="nf">if</span> <span class="o">(</span><span class="nv">line</span><span class="o">.</span><span class="py">length</span> <span class="o">&gt;</span> <span class="n">width</span><span class="o">)</span>
        <span class="nf">println</span><span class="o">(</span><span class="n">filename</span> <span class="o">+</span><span class="s">": "</span><span class="o">+</span> <span class="nv">line</span><span class="o">.</span><span class="py">trim</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">FindLongLines</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">width</span> <span class="k">=</span> <span class="nf">args</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="py">toInt</span>
    <span class="nf">for</span> <span class="o">(</span><span class="n">arg</span> <span class="k">&lt;-</span> <span class="nv">args</span><span class="o">.</span><span class="py">drop</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
      <span class="nv">LongLines</span><span class="o">.</span><span class="py">processFile</span><span class="o">(</span><span class="n">arg</span><span class="o">,</span> <span class="n">width</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="local-functions">6.2. Local functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">import</span> <span class="nn">scala.io.Source</span>

<span class="c1">// You can define functions inside other functions.</span>
<span class="c1">// Just like local variables, such local functions</span>
<span class="c1">// are visible only in their enclosing block.</span>
<span class="k">object</span> <span class="nc">LongLines</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">processFile</span><span class="o">(</span><span class="n">filename</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">width</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>

    <span class="c1">// Local functions can access the parameters of their enclosing function.</span>
    <span class="k">def</span> <span class="nf">processLine</span><span class="o">(</span><span class="n">line</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="o">{</span>
      <span class="nf">if</span> <span class="o">(</span><span class="nv">line</span><span class="o">.</span><span class="py">length</span> <span class="o">&gt;</span> <span class="n">width</span><span class="o">)</span>
        <span class="nf">println</span><span class="o">(</span><span class="n">filename</span> <span class="o">+</span><span class="s">": "</span><span class="o">+</span> <span class="n">line</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="k">val</span> <span class="nv">source</span> <span class="k">=</span> <span class="nv">Source</span><span class="o">.</span><span class="py">fromFile</span><span class="o">(</span><span class="n">filename</span><span class="o">)</span>
    <span class="nf">for</span> <span class="o">(</span><span class="n">line</span> <span class="k">&lt;-</span> <span class="nv">source</span><span class="o">.</span><span class="py">getLines</span><span class="o">())</span>
      <span class="nf">processLine</span><span class="o">(</span><span class="n">line</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="first-class-functions">6.3. First-class functions</h3>
<div class="paragraph">
<p>Scala has <strong>first-class functions</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Not only can you define functions and call them,</p>
</li>
<li>
<p>but you can write down functions as unnamed <strong>literals</strong> and then <strong>pass them around as *values</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <strong>function literal</strong> is compiled into a class that when instantiated at runtime is a <strong>function value</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Every function value is an instance of some class that extends one of several <strong>FunctionN</strong> traits in <code>package scala</code>,</p>
</li>
<li>
<p>such as <code>Function0</code> for functions with no parameters, <code>Function1</code> for functions with one parameter, and so on.</p>
</li>
<li>
<p>Each FunctionN trait has an <code>apply</code> method used to invoke the function.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The =&gt; designates that this function converts the thing on the left (any integer x)</span>
<span class="c1">// to the thing on the right (x + 1).</span>
<span class="c1">// So, this is a function mapping any integer x to x + 1.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1469</span><span class="o">/</span><span class="mh">0x00000008011c9838</span><span class="k">@</span><span class="mf">75f</span><span class="n">df03c</span>

<span class="c1">// Function values are objects, so you can store them in variables if you like.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">increase</span> <span class="k">=</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">increase</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1470</span><span class="o">/</span><span class="mh">0x00000008011ca638</span><span class="k">@</span><span class="mf">2d</span><span class="mi">74</span><span class="n">a59b</span>

<span class="c1">// They are functions, too, so you can invoke them using the usual parentheses function-call notation.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">increase</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">11</span>

<span class="c1">// Each FunctionN trait has an `apply` method used to invoke the function.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">increase</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">11</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">someNumbers</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">11</span><span class="o">,</span> <span class="o">-</span><span class="mi">10</span><span class="o">,</span> <span class="o">-</span><span class="mi">5</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>
<span class="n">someNumbers</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">11</span><span class="o">,</span> <span class="o">-</span><span class="mi">10</span><span class="o">,</span> <span class="o">-</span><span class="mi">5</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>

<span class="c1">// Takes a function as an argument and invokes that function on each of its elements.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">someNumbers</span><span class="o">.</span><span class="py">map</span><span class="o">((</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">22</span><span class="o">,</span> <span class="o">-</span><span class="mi">20</span><span class="o">,</span> <span class="o">-</span><span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="short-forms-of-function-literals">6.4. Short forms of function literals</h3>
<div class="paragraph">
<p>Scala provides a number of ways to leave out redundant information and write function literals more briefly.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One way to make a function literal more brief is to <strong>leave off the parameter types</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nv">someNumbers</span><span class="o">.</span><span class="py">map</span><span class="o">((</span><span class="n">x</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">22</span><span class="o">,</span> <span class="o">-</span><span class="mi">20</span><span class="o">,</span> <span class="o">-</span><span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>A second way to remove useless characters is to <strong>leave out parentheses around a parameter whose type is inferred</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nv">someNumbers</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">22</span><span class="o">,</span> <span class="o">-</span><span class="mi">20</span><span class="o">,</span> <span class="o">-</span><span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="placeholder-syntax">6.5. Placeholder syntax</h3>
<div class="paragraph">
<p>To make a function literal even more concise, you can use underscores as placeholders for one or more parameters, so long as <strong>each parameter appears only one time within the function literal</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nv">someNumbers</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="mi">2</span> <span class="o">*</span> <span class="k">_</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">22</span><span class="o">,</span> <span class="o">-</span><span class="mi">20</span><span class="o">,</span> <span class="o">-</span><span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">)</span>

<span class="c1">// Multiple underscores mean multiple parameters, not reuse of a single parameter repeatedly.</span>
<span class="c1">// The first underscore represents the first parameter,</span>
<span class="c1">// the second underscore the second parameter,</span>
<span class="c1">// the third underscore the third parameter, and so on.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">f</span> <span class="k">=</span> <span class="o">(</span><span class="k">_:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">+</span> <span class="o">(</span><span class="k">_:</span> <span class="kt">Int</span><span class="o">)</span>
<span class="n">f</span><span class="k">:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1558</span><span class="o">/</span><span class="mh">0x00000008011d2a88</span><span class="k">@</span><span class="mi">129</span><span class="n">b4b70</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">f</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>
<span class="n">res13</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">15</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">someNumbers</span><span class="o">.</span><span class="py">reduce</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>
<span class="n">res14</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">11</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">someNumbers</span><span class="o">.</span><span class="py">reduce</span><span class="o">(</span><span class="k">_</span> <span class="o">+</span> <span class="k">_</span><span class="o">)</span>
<span class="n">res11</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">11</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="partially-applied-functions">6.6. Partially applied functions</h3>
<div class="paragraph">
<p>Although the previous examples substitute underscores in place of individual parameters, you can also <strong>replace an entire parameter list with an underscore</strong>. For example, rather than writing <code>println(_)</code>, you could write <code>println _</code>. Here’s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Remember that you need to leave a space between the function name and the underscore,</span>
<span class="c1">// because otherwise the compiler will think you are referring to a different symbol,</span>
<span class="c1">// such as for example, a method named `println_`, which likely does not exist.</span>
<span class="nv">someNumbers</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="n">println</span> <span class="k">_</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Scala treats this short form exactly as if you had written the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nv">someNumbers</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="nf">println</span><span class="o">(</span><span class="n">x</span><span class="o">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In Scala, when you invoke a function, passing in any needed arguments, you <strong>apply</strong> that function <strong>to</strong> the arguments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">sum</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">c</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>
<span class="n">sum</span><span class="k">:</span> <span class="o">(</span><span class="kt">a:</span> <span class="kt">Int</span><span class="o">,</span> <span class="kt">b:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">c</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="nc">Int</span>

<span class="c1">// You could apply the function sum to the arguments 1, 2, and 3 like this:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">sum</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">6</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A <strong>partially applied function</strong> is an expression in which you don’t supply all of the arguments needed by the function. Instead, you supply some, or none, of the needed arguments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// create a partially applied function expression involving sum, in which you supply none of the three required</span>
<span class="c1">// arguments.</span>
<span class="c1">//  The resulting function can then be stored in a variable.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">a</span> <span class="k">=</span> <span class="n">sum</span> <span class="k">_</span>
<span class="n">a</span><span class="k">:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">Int</span><span class="o">,</span> <span class="nc">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1560</span><span class="o">/</span><span class="mh">0x00000008011cfc58</span><span class="k">@</span><span class="mi">3</span><span class="n">ba37b4a</span>

<span class="c1">// Given this code, the Scala compiler instantiates a function value</span>
<span class="c1">// that takes the three integer parameters missing from</span>
<span class="c1">// the partially applied function expression, `sum _`, and assigns a reference to</span>
<span class="c1">// that new function value to the variable `a`.</span>
<span class="c1">// When you apply three arguments to this new function value, it will turn around</span>
<span class="c1">// and invoke `sum`, passing in those same three arguments:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">a</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1">// This function value is an instance of a class generated automatically by</span>
<span class="c1">// the Scala compiler from `sum _`, the partially applied function expression.</span>
<span class="c1">// The class generated by the compiler has an apply method that takes three arguments.</span>
<span class="c1">// The generated class extends `trait Function3`, which declares a three-arg apply method.</span>
<span class="c1">// The generated class’s `apply` method takes three arguments because three is the number</span>
<span class="c1">// of arguments missing in the `sum _` expression.</span>
<span class="c1">// The Scala compiler translates the expression `a(1, 2, 3)` into an invocation of the</span>
<span class="c1">// function value’s `apply` method, passing in the three arguments 1, 2, and 3.</span>
<span class="c1">// Thus, `a(1, 2, 3)` is a short form for:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">a</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1">// Another way to think about this kind of expression, in which an underscore is used to represent</span>
<span class="c1">// an entire parameter list, is as a way to *transform a `def` into a `function value`*.</span>
<span class="c1">//  Although you can’t assign a method or nested function to a variable, or pass it as an argument</span>
<span class="c1">// to another function, you can do these things if you wrap the method or nested function in a</span>
<span class="c1">// function value by placing an underscore after its name.</span>

<span class="c1">// In the case of `sum _`, you are applying it to none of its arguments.</span>
<span class="c1">// But you can also express a partially applied function by supplying some but not all of</span>
<span class="c1">// the required arguments.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">b</span> <span class="k">=</span> <span class="nf">sum</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="k">_</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">b</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1566</span><span class="o">/</span><span class="mh">0x00000008011d7690</span><span class="k">@</span><span class="mf">61f</span><span class="mi">38079</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">b</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">9</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are writing a partially applied function expression in which you leave off all parameters, such as <code>println _</code> or <code>sum _</code>, you can express it more concisely by leaving off the underscore if a function is required at that point in the code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nv">someNumbers</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="n">println</span> <span class="k">_</span><span class="o">)</span>

<span class="c1">// You could just write:</span>
<span class="nv">someNumbers</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This last form is allowed only in places where a function is required, such as the invocation of <code>foreach</code> in this example. The compiler knows a function is required in this case, because <code>foreach</code> requires that a function be passed as an argument. In situations where a function is not required, attempting to use this form will cause a compilation error.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">c</span> <span class="k">=</span> <span class="n">sum</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">12</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">missing</span> <span class="kt">argument</span> <span class="kt">list</span> <span class="kt">for</span> <span class="kt">method</span> <span class="kt">sum</span>
<span class="nc">Unapplied</span> <span class="n">methods</span> <span class="n">are</span> <span class="n">only</span> <span class="n">converted</span> <span class="n">to</span> <span class="n">functions</span> <span class="n">when</span> <span class="n">a</span> <span class="n">function</span> <span class="k">type</span> <span class="kt">is</span> <span class="kt">expected.</span>
<span class="kt">You</span> <span class="kt">can</span> <span class="kt">make</span> <span class="kt">this</span> <span class="kt">conversion</span> <span class="kt">explicit</span> <span class="kt">by</span> <span class="kt">writing</span> <span class="kt">`sum</span> <span class="k">_</span><span class="kt">`</span> <span class="kt">or</span> <span class="kt">`sum</span><span class="o">(</span><span class="k">_</span><span class="o">,</span><span class="k">_</span><span class="o">,</span><span class="k">_</span><span class="o">)</span><span class="n">` instead of `sum</span><span class="o">`.</span>
       <span class="k">val</span> <span class="nv">c</span> <span class="k">=</span> <span class="n">sum</span>
               <span class="o">^</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">d</span> <span class="k">=</span> <span class="n">sum</span> <span class="k">_</span>
<span class="n">d</span><span class="k">:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">Int</span><span class="o">,</span> <span class="nc">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1567</span><span class="o">/</span><span class="mh">0x00000008011d8c58</span><span class="k">@</span><span class="mi">19</span><span class="n">ca9708</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">d</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">30</span><span class="o">)</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">60</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="closures">6.7. Closures</h3>
<div class="paragraph">
<p>You can, however, refer to variables in function body defined elsewhere:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">more</span>  <span class="c1">// how much more?</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This function adds “more” to its argument, but what is more? From the point of view of this function, <code>more</code> is a <strong>free variable</strong>, because the function literal does not itself give a meaning to it. The <code>x</code> variable, by contrast, is a <strong>bound variable</strong>, because it does have a meaning in the context of the function: it is defined as the function’s lone parameter, an Int. If you try using this function literal by itself, without any more defined in its scope, the compiler will complain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">more</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">12</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">not</span> <span class="kt">found:</span> <span class="kt">value</span> <span class="kt">more</span>
       <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">more</span>
                       <span class="o">^</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, the same function literal will work fine so long as there is something available named more:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">more</span> <span class="k">=</span> <span class="mi">1</span>
<span class="n">more</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">addMore</span> <span class="k">=</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">more</span>
<span class="n">addMore</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1568</span><span class="o">/</span><span class="mh">0x00000008011dd218</span><span class="k">@</span><span class="mi">2</span><span class="n">a7b81e3</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">addMore</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">11</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The function value (the object) that’s created at runtime from this function literal is called a <strong>closure</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The name arises from the act of “<strong>closing</strong>” the function literal by “<strong>capturing</strong>” the bindings of its free variables.</p>
<div class="paragraph">
<p>A function literal with no free variables, such as <code>(x: Int) &#8658; x + 1</code>, is called a <strong>closed term</strong>, where a term is a bit of source code.</p>
</div>
<div class="paragraph">
<p>Thus a function value created at runtime from this function literal is not a closure in the strictest sense, because <code>(x: Int) &#8658; x + 1</code> is already closed as written.</p>
</div>
<div class="paragraph">
<p>But any function literal with <strong>free variables</strong>, such as <code>(x: Int) &#8658; x + more</code>, is an <strong>open term</strong>.</p>
</div>
<div class="paragraph">
<p>Therefore, any function value created at runtime from <code>(x: Int) &#8658; x + more</code> will by definition require that a binding for its free variable, <code>more</code>, be captured.</p>
</div>
<div class="paragraph">
<p>The resulting function value, which will contain a reference to the captured <code>more</code> variable, is called a <strong>closure</strong>,</p>
</div>
<div class="paragraph">
<p>therefore, because the function value is the end product of the act of closing the open term, <code>(x: Int) &#8658; x + more</code>.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Intuitively, Scala’s closures capture variables themselves, not the value to which variables refer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">more</span> <span class="k">=</span> <span class="mi">9999</span>
<span class="n">more</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">addMore</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">10009</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">import</span> <span class="nn">scala.collection.mutable.ListBuffer</span>

<span class="k">val</span> <span class="nv">funcList</span> <span class="k">=</span> <span class="nc">ListBuffer</span><span class="o">[()</span> <span class="k">=&gt;</span> <span class="kt">Unit</span><span class="o">]()</span>
<span class="k">var</span> <span class="n">x</span> <span class="k">=</span> <span class="mi">0</span>
<span class="nf">for</span> <span class="o">(</span><span class="n">i</span> <span class="k">&lt;-</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">3</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">x</span> <span class="k">=</span> <span class="n">i</span> <span class="c1">// x: reassignment</span>
  <span class="n">funcList</span> <span class="o">+=</span> <span class="o">(()</span> <span class="k">=&gt;</span> <span class="nf">println</span><span class="o">(</span><span class="n">x</span><span class="o">))</span>
<span class="o">}</span>
<span class="nv">funcList</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="nf">_</span><span class="o">())</span>

<span class="c1">// Output:</span>
<span class="c1">// 3</span>
<span class="c1">// 3</span>
<span class="c1">// 3</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Each time this function is called it will create a new closure. Each closure will access the more variable that was active when the closure was created.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">makeIncreaser</span><span class="o">(</span><span class="n">more</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">more</span>
<span class="n">makeIncreaser</span><span class="k">:</span> <span class="o">(</span><span class="kt">more:</span> <span class="kt">Int</span><span class="o">)</span><span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">inc1</span> <span class="k">=</span> <span class="nf">makeIncreaser</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="n">inc1</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1579</span><span class="o">/</span><span class="mh">0x00000008011d20c8</span><span class="k">@</span><span class="mi">7</span><span class="n">b8f6b2c</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">inc9999</span> <span class="k">=</span> <span class="nf">makeIncreaser</span><span class="o">(</span><span class="mi">9999</span><span class="o">)</span>
<span class="n">inc9999</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1579</span><span class="o">/</span><span class="mh">0x00000008011d20c8</span><span class="nd">@bdb64b3</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">inc1</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">11</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">inc9999</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">10009</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="special-function-call-forms">6.8. Special function call forms</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Repeated parameters</strong></p>
<div class="ulist">
<ul>
<li>
<p>Scala allows you to indicate that the last parameter to a function may be repeated.</p>
</li>
<li>
<p>This allows clients to pass <strong>variable length argument lists</strong> to the function.</p>
</li>
<li>
<p>To denote a repeated parameter, place an asterisk after the type of the parameter.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">echo</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">String*</span><span class="o">)</span> <span class="k">=</span>
     <span class="o">|</span> <span class="nf">for</span> <span class="o">(</span><span class="n">arg</span> <span class="k">&lt;-</span> <span class="n">args</span><span class="o">)</span> <span class="nf">println</span><span class="o">(</span><span class="n">arg</span><span class="o">)</span>
<span class="n">echo</span><span class="k">:</span> <span class="o">(</span><span class="kt">args:</span> <span class="kt">String*</span><span class="o">)</span><span class="kt">Unit</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">echo</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">echo</span><span class="o">(</span><span class="s">"one"</span><span class="o">)</span>
<span class="n">one</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">echo</span><span class="o">(</span><span class="s">"hello"</span><span class="o">,</span> <span class="s">"world"</span><span class="o">)</span>
<span class="n">hello</span>
<span class="n">world</span>

<span class="c1">// Nevertheless, if you have an array of the appropriate type, and you attempt</span>
<span class="c1">// to pass it as a repeated parameter, you’ll need to append</span>
<span class="c1">// the array argument with a colon and an _* symbol, like this:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">arr</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"What's"</span><span class="o">,</span> <span class="s">"up"</span><span class="o">,</span> <span class="s">"doc?"</span><span class="o">)</span>
<span class="n">arr</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="nc">What</span><span class="ss">'s</span><span class="o">,</span> <span class="n">up</span><span class="o">,</span> <span class="n">doc</span><span class="o">?)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">echo</span><span class="o">(</span><span class="n">arr</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
<span class="nc">What</span><span class="ss">'s</span>
<span class="n">up</span>
<span class="n">doc</span><span class="o">?</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Named arguments</strong></p>
<div class="paragraph">
<p>In a normal function call, the arguments in the call are matched one by one in the order of the parameters of the called function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">speed</span><span class="o">(</span><span class="n">distance</span><span class="k">:</span> <span class="kt">Float</span><span class="o">,</span> <span class="n">time</span><span class="k">:</span> <span class="kt">Float</span><span class="o">)</span><span class="k">:</span> <span class="kt">Float</span> <span class="o">=</span>
     <span class="o">|</span> <span class="n">distance</span> <span class="o">/</span> <span class="n">time</span>
<span class="n">speed</span><span class="k">:</span> <span class="o">(</span><span class="kt">distance:</span> <span class="kt">Float</span><span class="o">,</span> <span class="kt">time:</span> <span class="kt">Float</span><span class="o">)</span><span class="nc">Float</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">speed</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">Float</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">speed</span><span class="o">(</span><span class="n">distance</span> <span class="k">=</span> <span class="mi">100</span><span class="o">,</span> <span class="n">time</span> <span class="k">=</span> <span class="mi">10</span><span class="o">)</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">Float</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">speed</span><span class="o">(</span><span class="n">time</span> <span class="k">=</span> <span class="mi">10</span><span class="o">,</span> <span class="n">distance</span> <span class="k">=</span> <span class="mi">100</span><span class="o">)</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">Float</span> <span class="o">=</span> <span class="mf">10.0</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Default parameter values</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">printTime</span><span class="o">(</span><span class="n">out</span><span class="k">:</span> <span class="kt">java.io.PrintStream</span> <span class="o">=</span> <span class="nv">Console</span><span class="o">.</span><span class="py">out</span><span class="o">)</span> <span class="k">=</span>
     <span class="o">|</span> <span class="nv">out</span><span class="o">.</span><span class="py">println</span><span class="o">(</span><span class="s">"time = "</span><span class="o">+</span> <span class="nv">System</span><span class="o">.</span><span class="py">currentTimeMillis</span><span class="o">())</span>
<span class="n">printTime</span><span class="k">:</span> <span class="o">(</span><span class="kt">out:</span> <span class="kt">java.io.PrintStream</span><span class="o">)</span><span class="kt">Unit</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">printTime</span><span class="o">()</span>
<span class="n">time</span> <span class="k">=</span> <span class="mi">1651414239220</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="tail-recursion">6.9. Tail recursion</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">approximate</span><span class="o">(</span><span class="n">guess</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="nf">isGoodEnough</span><span class="o">(</span><span class="n">guess</span><span class="o">))</span> <span class="n">guess</span>
  <span class="k">else</span> <span class="nf">approximate</span><span class="o">(</span><span class="nf">improve</span><span class="o">(</span><span class="n">guess</span><span class="o">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Functions like <code>approximate</code>, which call themselves as their last action, are called <strong>tail recursive</strong>.</p>
</div>
<div class="paragraph">
<p>If you want the <code>approximate</code> function to run faster, you might be tempted to write it with a <code>while loop</code> to try and speed it up, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">approximateLoop</span><span class="o">(</span><span class="n">initialGuess</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">guess</span> <span class="k">=</span> <span class="n">initialGuess</span>
  <span class="nf">while</span> <span class="o">(!</span><span class="nf">isGoodEnough</span><span class="o">(</span><span class="n">guess</span><span class="o">))</span>
    <span class="n">guess</span> <span class="k">=</span> <span class="nf">improve</span><span class="o">(</span><span class="n">guess</span><span class="o">)</span>
    <span class="n">guess</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>However, in the case of approximate above, the Scala compiler is able to apply an important <strong>optimization</strong>.</p>
</div>
<div class="paragraph">
<p>The Scala compiler detects tail recursion and replaces it with a jump back to the beginning of the function, after updating the function parameters with the new values.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Tracing tail-recursive functions</strong></p>
<div class="paragraph">
<p>A tail-recursive function will not build a new <strong>stack frame</strong> for each call; all calls will execute in a single frame.</p>
</div>
<div class="paragraph">
<p>This function is not tail recursive, because it performs an increment operation after the recursive call.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">// file in Boom.scala
object Boom {
  def boom(x: Int): Int = {
    if (x == 0) {
      throw new Exception("boom!")
    } else {
      // This function is not tail recursive,
      // because it performs an increment operation after the recursive call.
      boom(x - 1) + 1
    }
  }

  def main(args: Array[String]) {
    boom(3)
  }
}

// Output:
</span><span class="gp">// $</span><span class="w"> </span>scala Boom.scala
<span class="go">// java.lang.Exception: boom!
</span><span class="gp">// 	at Main$</span>.boom<span class="o">(</span>Boom.scala:4<span class="o">)</span>
<span class="gp">// 	at Main$</span>.boom<span class="o">(</span>Boom.scala:8<span class="o">)</span>
<span class="gp">// 	at Main$</span>.boom<span class="o">(</span>Boom.scala:8<span class="o">)</span>
<span class="gp">// 	at Main$</span>.boom<span class="o">(</span>Boom.scala:8<span class="o">)</span>
<span class="gp">// 	at Main$</span>.main<span class="o">(</span>Boom.scala:13<span class="o">)</span>
<span class="go">// 	at Main.main(Boom.scala)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you now modify boom so that it does become tail recursive:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">// file in Bang.scala
object Bang {
  def bang(x: Int): Int = {
    if (x == 0) {
      throw new Exception("bang!")
    } else {
      bang(x - 1)
    }
  }

  def main(args: Array[String]) {
    bang(5)
  }
}

// Output:
</span><span class="gp">// $</span><span class="w"> </span>scala Bang.scala
<span class="go">// java.lang.Exception: bang!
</span><span class="gp">// 	at Main$</span>.bang<span class="o">(</span>Bang.scala:5<span class="o">)</span>
<span class="gp">// 	at Main$</span>.main<span class="o">(</span>Bang.scala:12<span class="o">)</span>
<span class="go">// 	at Main.main(Bang.scala)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you think you might be confused by tail-call optimizations when looking at a stack trace, you can turn them off by giving the following argument to the scala shell or to the scalac compiler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">-g:notailcalls</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With that option specified, you will get a longer stack trace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>scala <span class="nt">-g</span>:notailcalls Bang.scala
<span class="go">java.lang.Exception: bang!
</span><span class="gp">	at Main$</span>.bang<span class="o">(</span>Bang.scala:5<span class="o">)</span>
<span class="gp">	at Main$</span>.bang<span class="o">(</span>Bang.scala:7<span class="o">)</span>
<span class="gp">	at Main$</span>.bang<span class="o">(</span>Bang.scala:7<span class="o">)</span>
<span class="gp">	at Main$</span>.bang<span class="o">(</span>Bang.scala:7<span class="o">)</span>
<span class="gp">	at Main$</span>.bang<span class="o">(</span>Bang.scala:7<span class="o">)</span>
<span class="gp">	at Main$</span>.bang<span class="o">(</span>Bang.scala:7<span class="o">)</span>
<span class="gp">	at Main$</span>.main<span class="o">(</span>Bang.scala:12<span class="o">)</span>
<span class="go">	at Main.main(Bang.scala)</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Limits of tail recursion</strong></p>
<div class="paragraph">
<p>The use of tail recursion in Scala is fairly limited, because the JVM instruction set makes implementing more advanced forms of tail recursion very difficult. Scala only optimizes directly recursive calls back to the same func- tion making the call.</p>
</div>
<div class="paragraph">
<p>If the recursion is indirect, as in the following example of two mutually recursive functions, no optimization is possible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">isEven</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="kc">true</span> <span class="k">else</span> <span class="nf">isOdd</span><span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span>

<span class="k">def</span> <span class="nf">isOdd</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="kc">false</span> <span class="k">else</span> <span class="nf">isEven</span><span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="control-abstraction-higher-order-function-and-currying">7. Control Abstraction: Higher-order function and Currying</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="reducing-code-duplication">7.1. Reducing code duplication</h3>
<div class="paragraph">
<p>These <strong>higher-order functions</strong>—functions that take functions as parameters—give you extra opportunities to condense and simplify code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// object FileMatcher {</span>
<span class="c1">//</span>
<span class="c1">//   private def filesHere = (new java.io.File(".")).listFiles</span>
<span class="c1">//</span>
<span class="c1">//   def filesEnding(query: String) =</span>
<span class="c1">//     for (file &lt;- filesHere; if file.getName.endsWith(query))</span>
<span class="c1">//       yield file</span>
<span class="c1">//</span>
<span class="c1">//   def filesContaining(query: String) =</span>
<span class="c1">//     for (file &lt;- filesHere; if file.getName.contains(query))</span>
<span class="c1">//       yield file</span>
<span class="c1">//</span>
<span class="c1">//   def filesRegex(query: String) =</span>
<span class="c1">//     for (file &lt;- filesHere; if file.getName.matches(query))</span>
<span class="c1">//       yield file</span>
<span class="c1">// }</span>
<span class="c1">//</span>
<span class="c1">// Experienced programmers will notice all of this repetition and wonder</span>
<span class="c1">// if it can be factored into a common helper function. Doing it the obvious</span>
<span class="c1">// way does not work, however. You would like to be able to do the following:</span>
<span class="c1">//</span>
<span class="c1">// def filesMatching(query: String, matcher: (String, String) =&gt; Boolan) =</span>
<span class="c1">//   for (file &lt;- filesHere; if matcher(file.getName, query))</span>
<span class="c1">//     yield file</span>
<span class="c1">//</span>
<span class="c1">// Given this new filesMatching helper method, you can simplify the three</span>
<span class="c1">// searching methods by having them call the helper method, passing in an</span>
<span class="c1">// appropriate function:</span>
<span class="c1">//</span>
<span class="c1">// def filesEnding(query: String) =</span>
<span class="c1">//   filesMatching(query, _.endsWith(_))</span>
<span class="c1">//</span>
<span class="c1">// def filesContaining(query: String) =</span>
<span class="c1">//   filesMatching(query, _.contains(_))</span>
<span class="c1">//</span>
<span class="c1">// def filesRegex(query: String) =</span>
<span class="c1">//   filesMatching(query, _.matches(_))</span>
<span class="c1">//</span>
<span class="c1">// The function literals used in the above, such as `_.endsWith(_)`</span>
<span class="c1">// and `_.contains(_)`, are instantiated at runtime into function values</span>
<span class="c1">// that are not closures, because they don’t capture any free variables.</span>
<span class="c1">//</span>
<span class="c1">// By contrast, the function literal `_.endsWith(query)`, used in the most</span>
<span class="c1">// recent example, contains one bound variable, the argument represented</span>
<span class="c1">// by the underscore, and one free variable named query.</span>
<span class="c1">//</span>
<span class="c1">// Using closures to reduce code duplication.</span>
<span class="k">object</span> <span class="nc">FileMatcher</span> <span class="o">{</span>

  <span class="k">private</span> <span class="k">def</span> <span class="nf">filesHere</span> <span class="k">=</span> <span class="o">(</span><span class="k">new</span> <span class="nv">java</span><span class="o">.</span><span class="py">io</span><span class="o">.</span><span class="py">File</span><span class="o">(</span><span class="s">"."</span><span class="o">)).</span><span class="py">listFiles</span>

  <span class="k">private</span> <span class="k">def</span> <span class="nf">filesMatching</span><span class="o">(</span><span class="n">matcher</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=&gt;</span> <span class="nc">Boolean</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
    <span class="nf">for</span> <span class="o">(</span><span class="n">file</span> <span class="k">&lt;-</span> <span class="n">filesHere</span> <span class="k">if</span> <span class="nf">matcher</span><span class="o">(</span><span class="nv">file</span><span class="o">.</span><span class="py">getName</span><span class="o">))</span>
      <span class="k">yield</span> <span class="n">file</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">filesEnding</span><span class="o">(</span><span class="n">query</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span>
    <span class="c1">// eq. filesMatching((fileName: String) =&gt; fileName.endsWith(query))</span>
    <span class="nf">filesMatching</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">endsWith</span><span class="o">(</span><span class="n">query</span><span class="o">))</span>

  <span class="k">def</span> <span class="nf">filesContaining</span><span class="o">(</span><span class="n">query</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span>
    <span class="c1">// eq. filesMatching((fileName: String) =&gt; fileName.contains(query))</span>
    <span class="nf">filesMatching</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">contains</span><span class="o">(</span><span class="n">query</span><span class="o">))</span>

  <span class="k">def</span> <span class="nf">filesRegex</span><span class="o">(</span><span class="n">query</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span>
    <span class="c1">// eq. filesMatching((fileName: String) =&gt; fileName.matches(query))</span>
    <span class="nf">filesMatching</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">matches</span><span class="o">(</span><span class="n">query</span><span class="o">))</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="currying">7.2. Currying</h3>
<div class="paragraph">
<p>A <strong>curried function</strong> is applied to multiple argument lists, instead of just one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Defining and invoking a “plain old” function.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">plainOldSum</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="n">plainOldSum</span><span class="k">:</span> <span class="o">(</span><span class="kt">x:</span> <span class="kt">Int</span><span class="o">,</span> <span class="kt">y:</span> <span class="kt">Int</span><span class="o">)</span><span class="nc">Int</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">plainOldSum</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1">// Defining and invoking a curried function.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">curriedSum</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)(</span><span class="n">y</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="n">curriedSum</span><span class="k">:</span> <span class="o">(</span><span class="kt">x:</span> <span class="kt">Int</span><span class="o">)(</span><span class="kt">y:</span> <span class="kt">Int</span><span class="o">)</span><span class="kt">Int</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">curriedSum</span><span class="o">(</span><span class="mi">2</span><span class="o">)(</span><span class="mi">2</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">4</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>What’s happening here is that when you invoke <code>curriedSum</code>, you actually get two traditional <strong>function invocations back to back</strong>. The <code>first</code> function invocation takes a single <code>Int</code> parameter named <code>x</code>, and returns a function value for the <code>second</code> function. This <code>second</code> function takes the <code>Int</code> parameter <code>y</code>.</p>
</div>
<div class="paragraph">
<p>You can use the <strong>placeholder notation</strong> to use <code>curriedSum</code> in a partially applied function expression, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">twoPlus</span> <span class="k">=</span> <span class="nf">curriedSum</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="k">_</span>
<span class="n">twoPlus</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1624</span><span class="o">/</span><span class="mh">0x00000008011d0838</span><span class="k">@</span><span class="mf">1f</span><span class="n">cd9ce1</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">twoPlus</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">4</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-new-control-structures">7.3. Writing new control structures</h3>
<div class="paragraph">
<p>Consider now a more widely used coding pattern: open a resource, operate on it, and then close the resource.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// open a resource, operate on it, and then close the resource.</span>
<span class="k">def</span> <span class="nf">withPrintWriter</span><span class="o">(</span><span class="n">file</span><span class="k">:</span> <span class="kt">File</span><span class="o">,</span> <span class="n">op</span><span class="k">:</span> <span class="kt">PrintWriter</span> <span class="o">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">writer</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PrintWriter</span><span class="o">(</span><span class="n">file</span><span class="o">)</span>
  <span class="k">try</span> <span class="o">{</span>
    <span class="nf">op</span><span class="o">(</span><span class="n">writer</span><span class="o">)</span>
  <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="nv">writer</span><span class="o">.</span><span class="py">close</span><span class="o">()</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Given such a method, you can use it like this:</span>
<span class="nf">withPrintWriter</span><span class="o">(</span>
  <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"date.txt"</span><span class="o">),</span>
  <span class="n">writer</span> <span class="k">=&gt;</span> <span class="nv">writer</span><span class="o">.</span><span class="py">println</span><span class="o">(</span><span class="k">new</span> <span class="nv">java</span><span class="o">.</span><span class="py">util</span><span class="o">.</span><span class="py">Date</span><span class="o">)</span>
<span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In any method invocation in Scala in which you’re passing in <strong>exactly one argument</strong>, you can opt to use curly braces to surround the argument instead of parentheses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nf">println</span><span class="o">(</span><span class="s">"Hello, world!"</span><span class="o">)</span>
<span class="nc">Hello</span><span class="o">,</span> <span class="n">world</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">println</span> <span class="o">{</span> <span class="s">"Hello, world!"</span> <span class="o">}</span>
<span class="nc">Hello</span><span class="o">,</span> <span class="n">world</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">g</span> <span class="k">=</span> <span class="s">"Hello, world!"</span>
<span class="n">g</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">Hello</span><span class="o">,</span> <span class="n">world</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">g</span><span class="o">.</span><span class="py">substring</span><span class="o">(</span><span class="mi">7</span><span class="o">,</span> <span class="mi">9</span><span class="o">)</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">wo</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">g</span><span class="o">.</span><span class="py">substring</span> <span class="o">{</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">9</span> <span class="o">}</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">1</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">'</span><span class="o">;'</span> <span class="n">expected</span> <span class="n">but</span> <span class="sc">','</span> <span class="n">found</span><span class="o">.</span>
       <span class="nv">g</span><span class="o">.</span><span class="py">substring</span> <span class="o">{</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">9</span> <span class="o">}</span>
                      <span class="o">^</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The purpose of this ability to substitute curly braces for parentheses for passing in one argument is to enable client programmers to write function literals between curly braces. This can make a method call feel more like a control abstraction.</p>
</div>
<div class="paragraph">
<p>The new version differs from the old one only in that there are now two parameter lists with one parameter each instead of one parameter list with two parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// open a resource, operate on it, and then close the resource.</span>
<span class="k">def</span> <span class="nf">withPrintWriter</span><span class="o">(</span><span class="n">file</span><span class="k">:</span> <span class="kt">File</span><span class="o">)(</span><span class="n">op</span><span class="k">:</span> <span class="kt">PrintWriter</span> <span class="o">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">writer</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PrintWriter</span><span class="o">(</span><span class="n">file</span><span class="o">)</span>
  <span class="k">try</span> <span class="o">{</span>
    <span class="nf">op</span><span class="o">(</span><span class="n">writer</span><span class="o">)</span>
  <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="nv">writer</span><span class="o">.</span><span class="py">close</span><span class="o">()</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Given such a method, you can use it with a more pleasing syntax:</span>
<span class="k">val</span> <span class="nv">file</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"date.txt"</span><span class="o">)</span>
<span class="nf">withPrintWriter</span><span class="o">(</span><span class="n">file</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">writer</span> <span class="k">=&gt;</span> <span class="nv">writer</span><span class="o">.</span><span class="py">println</span><span class="o">(</span><span class="k">new</span> <span class="nv">java</span><span class="o">.</span><span class="py">util</span><span class="o">.</span><span class="py">Date</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="by-name-parameters">7.4. By-name parameters</h3>
<div class="paragraph">
<p>What if you want to implement something more like if or while, however, where there is no value to pass into the code between the curly braces? To help with such situations, Scala provides by-name parameters.</p>
</div>
<div class="paragraph">
<p>The <code>myAssert</code> function will take a function value as input and consult a flag to decide what to do. If the flag is set, <code>myAssert</code> will invoke the passed function and verify that it returns <code>true</code>. If the flag is turned off, <code>myAssert</code> will quietly do nothing at all.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Without using by-name parameters, you could write myAssert like this:</span>
<span class="k">var</span> <span class="n">assertionsEnabled</span> <span class="k">=</span> <span class="kc">true</span>

<span class="k">def</span> <span class="nf">myAssert</span><span class="o">(</span><span class="n">predicate</span><span class="k">:</span> <span class="o">()</span> <span class="o">=&gt;</span> <span class="nc">Boolean</span><span class="o">)</span> <span class="k">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">assertionsEnabled</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nf">predicate</span><span class="o">())</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nc">AssertionError</span>

<span class="c1">// The definition is fine, but using it is a little bit awkward:</span>
<span class="nf">myAssert</span><span class="o">(()</span> <span class="k">=&gt;</span> <span class="mi">5</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="o">)</span>

<span class="c1">// You would really prefer to leave out the empty parameter list and `=&gt;` symbol</span>
<span class="c1">// in the function literal and write the code like this:</span>
<span class="nf">myAssert</span><span class="o">(</span><span class="mi">5</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="o">)</span> <span class="c1">// Won’t work, because missing `() =&gt;`</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By-name parameters exist precisely so that you can do this. <strong>To make a by-name parameter, you give the parameter a type starting with `=>` instead of `() =>`.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Using a by-name parameter.</span>
<span class="k">def</span> <span class="nf">byNameAssert</span><span class="o">(</span><span class="n">predicate</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Boolean</span><span class="o">)</span> <span class="k">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">assertionsEnabled</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">predicate</span><span class="o">)</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nc">AssertionError</span>

<span class="c1">// The result is that using byNameAssert looks exactly like</span>
<span class="c1">// using a built-in control structure:</span>
<span class="nf">byNameAssert</span><span class="o">(</span><span class="mi">5</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A by-name type, in which the empty parameter list, <code>()</code>, is left out, is only allowed for parameters. There is no such thing as a by-name variable or a by-name field.</p>
</div>
<div class="paragraph">
<p>Now, you may be wondering why you couldn’t simply write myAssert using a plain old Boolean for the type of its parameter, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">boolAssert</span><span class="o">(</span><span class="n">predicate</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span> <span class="k">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">assertionsEnabled</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">predicate</span><span class="o">)</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nc">AssertionError</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This formulation is also legal, of course, and the code using this version of <code>boolAssert</code> would still look exactly as before:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nf">boolAssert</span><span class="o">(</span><span class="mi">5</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Nevertheless, one difference exists between these two approaches that is important to note.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Because the type of boolAssert’s parameter is <code>Boolean</code>, the expression inside the parentheses in <code>boolAssert(5 &gt; 3)</code> is <strong>evaluated before the call</strong> to <code>boolAssert</code>.</p>
<div class="paragraph">
<p>The expression <code>5 &gt; 3</code> yields <code>true</code>, which is passed to <code>boolAssert</code>.</p>
</div>
</li>
<li>
<p>By contrast, because the type of byNameAssert&#8217;s predicate parameter is <code>=&gt; Boolean</code>, the expression inside the parentheses in <code>byNameAssert(5 &gt; 3)</code> is <strong>not evaluated before the call</strong> to <code>byNameAssert</code>.</p>
<div class="paragraph">
<p>Instead a function value will be created whose <code>apply</code> method will evaluate <code>5 &gt; 3</code>, and this function value will be passed to <code>byNameAssert</code>.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The difference between the two approaches, therefore, is that if assertions are disabled, you’ll see any <strong>side effects</strong> that the expression inside the parentheses may have in <code>boolAssert</code>, but not in <code>byNameAssert</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">assertionsEnabled</span> <span class="k">=</span> <span class="kc">false</span>
<span class="n">assertionsEnabled</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">byNameAssert</span><span class="o">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">0</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">boolAssert</span><span class="o">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">0</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
<span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">ArithmeticException</span><span class="k">:</span> <span class="kt">/</span> <span class="kt">by</span> <span class="kt">zero</span>
  <span class="o">...</span> <span class="mi">28</span> <span class="n">elided</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="composition-and-inheritance">8. Composition and Inheritance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Scala’s support for object-oriented programming:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>abstract classes</strong>,</p>
</li>
<li>
<p><strong>parameterless methods</strong>,</p>
</li>
<li>
<p><strong>extending classes</strong>,</p>
</li>
<li>
<p><strong>overriding methods and fields</strong>,</p>
</li>
<li>
<p><strong>parametric fields</strong>,</p>
</li>
<li>
<p><strong>invoking superclass constructors</strong>,</p>
</li>
<li>
<p><strong>polymorphism and dynamic binding</strong>,</p>
</li>
<li>
<p><strong>final members and classes</strong>,</p>
</li>
<li>
<p>and <strong>factory objects and methods</strong>.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="abstract-classes">8.1. Abstract classes</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The abstract modifier signifies that the class may have abstract members</span>
<span class="c1">// that do not have an implementation.</span>
<span class="c1">// As a result, you cannot instantiate an abstract class.</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Element</span> <span class="o">{</span>
  <span class="c1">// A method is abstract if it does not have an implementation (i.e., no equals sign or body).</span>
  <span class="k">def</span> <span class="nf">contents</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
<span class="o">}</span>

<span class="c1">// error: class Element is abstract; cannot be instantiated</span>
<span class="k">new</span> <span class="nc">Element</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="defining-parameterless-methods">8.2. Defining parameterless methods</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Defining parameterless methods width and height.</span>
<span class="c1">// Note that none of Element’s three methods has a</span>
<span class="c1">// parameter list, not even an empty one.</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Element</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">contents</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
  <span class="k">def</span> <span class="nf">height</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="nv">contents</span><span class="o">.</span><span class="py">length</span>
  <span class="k">def</span> <span class="nf">width</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="nf">if</span> <span class="o">(</span><span class="n">height</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="mi">0</span> <span class="k">else</span> <span class="nf">contents</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="py">length</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Such <strong>parameterless methods</strong> are quite common in Scala. By contrast, methods defined with empty parentheses, such as <code>def height(): Int</code>, are called <strong>empty-paren methods</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The recommended convention is to use a parameterless method whenever there are no parameters and the method accesses mutable state only by reading fields of the containing object (in particular, it does not change mutable state).</p>
<div class="paragraph">
<p>This convention supports the <strong>uniform access principle</strong>, which says that client code should not be affected by a decision to implement an attribute as a field or method.</p>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Implement width and height as fields instead of methods,</span>
<span class="c1">// simply by changing the def in each definition to a val.</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Element</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">contents</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
  <span class="k">val</span> <span class="nv">height</span> <span class="k">=</span> <span class="nv">contents</span><span class="o">.</span><span class="py">length</span>
  <span class="k">val</span> <span class="nv">width</span> <span class="k">=</span>
    <span class="nf">if</span> <span class="o">(</span><span class="n">height</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="mi">0</span> <span class="k">else</span> <span class="nf">contents</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="py">length</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Scala is very liberal when it comes to mixing parameterless and empty-paren methods.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In particular, you can override a parameterless method with an empty-paren method, and vice versa.</p>
</li>
<li>
<p>You can also leave off the empty parentheses on an invocation of any function that takes no arguments.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nc">Array</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">).</span><span class="py">toString</span>
<span class="s">"abc"</span><span class="o">.</span><span class="py">length</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In principle it’s possible to leave out all empty parentheses in Scala function calls. However, it is recommended to still write the empty parentheses when the invoked method represents more than a property of its receiver ob- ject.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="s">"hello"</span><span class="o">.</span><span class="py">length</span>  <span class="c1">// no () because no side-effect</span>
<span class="nf">println</span><span class="o">()</span>       <span class="c1">// better to not drop the ()</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To summarize,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it is encouraged style in Scala to define methods that take no parameters and have no side effects as parameterless methods, i.e., leaving off the empty parentheses.</p>
</li>
<li>
<p>On the other hand, <strong>you should never define a method that has side-effects without parentheses</strong>, because then invocations of that method would look like a field selection. So your clients might be surprised to see the side effects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Similarly,</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>whenever you invoke a function that has side effects, be sure to include the empty parentheses when you write the invocation.</strong></p>
</li>
<li>
<p>Another way to think about this is if the function you’re calling performs an operation, use the parentheses, but if it merely provides access to a property, leave the parentheses off.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="extending-classes">8.3. Extending classes</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Defining ArrayElement as a subclass of Element.</span>
<span class="c1">//</span>
<span class="c1">// 1. type ArrayElement is a `subtype` of the type Element.</span>
<span class="c1">// 2. class ArrayElement is called a `subclass` of class Element,</span>
<span class="c1">//    that `inherits` all non-private memebers from class Element.</span>
<span class="c1">// 3. Conversely, Element is a `superclass` of ArrayElement.</span>
<span class="k">class</span> <span class="nc">ArrayElement</span><span class="o">(</span><span class="n">conts</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">Element</span> <span class="o">{</span>
  <span class="c1">// The contents method `overrides` (or, alternatively: `implements`)</span>
  <span class="c1">// abstract method contents in class Element.</span>
  <span class="c1">//</span>
  <span class="c1">// NOTE: because the returned array is mutalbe,</span>
  <span class="c1">// consider returning a `defensive copy` of the array instead.</span>
  <span class="c1">//</span>
  <span class="c1">// This's a `composition` relationship between ArrayElement and Array[String]</span>
  <span class="k">def</span> <span class="nf">contents</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">conts</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="overriding-methods-and-fields">8.4. Overriding methods and fields</h3>
<div class="paragraph">
<p>The <strong>uniform access principle</strong> is just one aspect where Scala treats fields and methods more uniformly than Java. Another difference is that in Scala, <strong>fields and methods belong to the same namespace</strong>. This makes <strong>it possible for a field to override a parameterless method</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Overriding a parameterless method with a field.</span>
<span class="k">class</span> <span class="nc">ArrayElement</span><span class="o">(</span><span class="n">conts</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">Element</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">contents</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">conts</span>
<span class="o">}</span>

<span class="c1">// $ javap -p ArrayElement.class</span>
<span class="c1">// public class ArrayElement extends Element {</span>
<span class="c1">//   private final java.lang.String[] contents;</span>
<span class="c1">//   public java.lang.String[] contents();</span>
<span class="c1">//   public ArrayElement(java.lang.String[]);</span>
<span class="c1">// }</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, in Scala it is <strong>forbidden to define a field and method with the same name in the same class</strong>, whereas it is allowed in Java.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// This is Java</span>
<span class="k">class</span> <span class="nc">CompilesFine</span> <span class="o">{</span>
  <span class="k">private</span> <span class="n">int</span> <span class="n">f</span> <span class="k">=</span> <span class="mi">0</span><span class="o">;</span>
  <span class="n">public</span> <span class="n">int</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// But the corresponding Scala class would not compile:</span>
<span class="k">class</span> <span class="nc">WontCompile</span> <span class="o">{</span>
  <span class="k">private</span> <span class="k">var</span> <span class="n">f</span> <span class="k">=</span> <span class="mi">0</span> <span class="c1">// Won’t compile, because a field</span>
  <span class="k">def</span> <span class="nf">f</span> <span class="k">=</span> <span class="mi">1</span>         <span class="c1">// and method have the same name</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Java’s four namespaces are fields, methods, types, and packages. By contrast, Scala has just two namespaces are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>values (fields, methods, packages, and singleton objects)</p>
</li>
<li>
<p>types (class and trait names)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The reason Scala places fields and methods into the same namespace is precisely so you can override a parameterless method with a val, something you can’t do with Java.</p>
</div>
<div class="paragraph">
<p>The reason that packages share the same namespace as fields and methods in Scala is to enable you to import packages in addition to just importing the names of types, and the fields and methods of singleton objects.</p>
</div>
</div>
<div class="sect2">
<h3 id="defining-parametric-fields">8.5. Defining parametric fields</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Defining contents as a parametric field.</span>
<span class="c1">//</span>
<span class="c1">// Note that now the contents parameter is prefixed by val.</span>
<span class="c1">// This is a shorthand that defines at the same time a parameter</span>
<span class="c1">// and field with the same name.</span>
<span class="c1">// Specifically, class ArrayElement now has an (unreassignable) field</span>
<span class="c1">// contents, which can be accessed from outside the class.</span>
<span class="c1">// The field is initialized with the value of the parameter.</span>
<span class="k">class</span> <span class="nc">ArrayElement</span><span class="o">(</span>
  <span class="k">val</span> <span class="nv">contents</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
<span class="o">)</span> <span class="k">extends</span> <span class="nc">Element</span>

<span class="c1">// $ javap -p ArrayElement.class</span>
<span class="c1">// public class ArrayElement extends Element {</span>
<span class="c1">//   private final java.lang.String[] contents;</span>
<span class="c1">//   public java.lang.String[] contents();</span>
<span class="c1">//   public ArrayElement(java.lang.String[]);</span>
<span class="c1">// }</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// You can also prefix a class parameter with var,</span>
<span class="c1">//   in which case the corresponding field would be reassignable.</span>
<span class="c1">// Finally, it is possible to add modifiers</span>
<span class="c1">//   such as private, protected, or override to these parametric fields,</span>
<span class="c1">//   just as you can do for any other class member.</span>
<span class="k">class</span> <span class="nc">Cat</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">dangerous</span> <span class="k">=</span> <span class="kc">false</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Tiger</span><span class="o">(</span>
  <span class="k">override</span> <span class="k">val</span> <span class="nv">dangerous</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">,</span>
  <span class="k">private</span> <span class="k">var</span> <span class="n">age</span><span class="k">:</span> <span class="kt">Int</span>
<span class="o">)</span> <span class="k">extends</span> <span class="nc">Cat</span>

<span class="c1">// $ javap -p Cat.class Tiger.class</span>
<span class="c1">// public class Cat {</span>
<span class="c1">//   private final boolean dangerous;</span>
<span class="c1">//   public boolean dangerous();</span>
<span class="c1">//   public Cat();</span>
<span class="c1">// }</span>
<span class="c1">//</span>
<span class="c1">// public class Tiger extends Cat {</span>
<span class="c1">//   private final boolean dangerous;</span>
<span class="c1">//   private int age;</span>
<span class="c1">//   public boolean dangerous();</span>
<span class="c1">//   private int age();</span>
<span class="c1">//   private void age_$eq(int);</span>
<span class="c1">//   public Tiger(boolean, int);</span>
<span class="c1">// }</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="invoking-superclass-constructors">8.6. Invoking superclass constructors</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Invoking a superclass constructor.</span>
<span class="c1">//</span>
<span class="c1">// To invoke a superclass constructor, you simply place</span>
<span class="c1">//   the argument or arguments you want to pass in parentheses</span>
<span class="c1">//   following the name of the superclass.</span>
<span class="k">class</span> <span class="nc">LineElement</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">ArrayElement</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="n">s</span><span class="o">))</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">width</span> <span class="k">=</span> <span class="nv">s</span><span class="o">.</span><span class="py">length</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">height</span> <span class="k">=</span> <span class="mi">1</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-override-modifiers">8.7. Using override modifiers</h3>
<div class="paragraph">
<p>Scala requires <strong>override</strong>  modifier for all members that override a concrete member in a parent class.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The modifier is optional if a member implements an abstract member with the same name.</p>
</li>
<li>
<p>The modifier is forbidden if a member does not override or implement some other member in a base class.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Alice</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">foo</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span>
  <span class="k">def</span> <span class="nf">bar</span><span class="o">()</span> <span class="o">{}</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Suber</span> <span class="k">extends</span> <span class="nc">Bob</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">foo</span><span class="o">()</span> <span class="o">{}</span>
  <span class="k">def</span> <span class="nf">bar</span><span class="o">()</span> <span class="o">{}</span> <span class="c1">// error: method bar needs `override' modifier</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="polymorphism-and-dynamic-binding">8.8. Polymorphism and dynamic binding</h3>
<div class="paragraph">
<p>You can create more forms of Element by defining new Element subclasses,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>this phenomenon is <strong>polymorphism</strong>,</p>
</li>
<li>
<p>the method invocations on variables and expressions are <strong>dynamically bound</strong>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Element</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="s">"Element"</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">ArrayElement</span> <span class="k">extends</span> <span class="nc">Element</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="s">"ArrayElement"</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">LineElement</span> <span class="k">extends</span> <span class="nc">ArrayElement</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="s">"LineElement"</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">e1</span><span class="k">:</span> <span class="kt">Element</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayElement</span>
<span class="k">val</span> <span class="nv">e2</span><span class="k">:</span> <span class="kt">Element</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LineElement</span>
<span class="nf">println</span><span class="o">(</span><span class="n">e1</span><span class="o">)</span>
<span class="nf">println</span><span class="o">(</span><span class="n">e2</span><span class="o">)</span>
<span class="c1">// Output:</span>
<span class="c1">// ArrayElement</span>
<span class="c1">// LineElement</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="declaring-final-members">8.9. Declaring final members</h3>
<div class="paragraph">
<p>In Scala, as in Java, you do this by adding a <code>final</code> modifier to the member.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Element</span> <span class="o">{</span>
  <span class="k">final</span> <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="s">"Element"</span>
<span class="o">}</span>

<span class="k">final</span> <span class="k">class</span> <span class="nc">ArrayElement</span> <span class="k">extends</span> <span class="nc">Element</span> <span class="o">{</span>
  <span class="c1">// error: method toString cannot override final member</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="s">"ArrayElement"</span>
<span class="o">}</span>

<span class="c1">// error: illegal inheritance from final class ArrayElement</span>
<span class="k">class</span> <span class="nc">LineElement</span> <span class="k">extends</span> <span class="nc">ArrayElement</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="defining-a-factory-object">9. Defining a factory object</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A factory object contains methods that construct other objects.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clients would then use these factory methods for object construction rather than constructing the objects directly with new.</p>
</li>
<li>
<p>An advantage of this approach is that object creation can be centralized and the details of how objects are represented with classes can be hidden.</p>
</li>
<li>
<p>This hiding will both make your library simpler for clients to understand, because less detail is exposed, and provide you with more opportunities to change your library’s implementation later without breaking client code.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="scalas-hierarchy">10. Scala’s Hierarchy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Scala, every class inherits from a common superclass named <strong>Any</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Because every class is a subclass of Any, the methods defined in Any are “universal” methods: they may be invoked on any object.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Class Any at the top of the hierarchy, defines methods that include the following:</span>
<span class="c1">//</span>
<span class="c1">// Because every class inherits from Any, every object in a Scala program can be compared</span>
<span class="c1">//   using `==`, `!=`, or `equals`; hashed using `##` or `hashCode`;</span>
<span class="c1">//   and formatted using `toString`.</span>
<span class="c1">// The equality and inequality methods, `==` and `!=`, are declared `final` in class Any, so</span>
<span class="c1">//   they cannot be overridden in subclasses.</span>
<span class="c1">// The `==` method is essentially the same as `equals` and</span>
<span class="c1">//     `!=` is always the negation of `equals`.</span>
<span class="c1">// So individual classes can tailor what `==` or `!=` means by overriding the `equals` method.</span>
<span class="k">final</span> <span class="k">def</span> <span class="nf">==</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span>

<span class="k">final</span> <span class="k">def</span> <span class="nf">!=</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span>

<span class="k">def</span> <span class="nf">equals</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span>

<span class="k">def</span> <span class="nf">##:</span> <span class="nc">Int</span>

<span class="k">def</span> <span class="nf">hashCode</span><span class="k">:</span> <span class="kt">Int</span>

<span class="k">def</span> <span class="nf">toString</span><span class="k">:</span> <span class="kt">String</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Scala also defines some interesting classes at the bottom of the hierarchy, <strong>Null</strong> and <strong>Nothing</strong>, which essentially act as common subclasses.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For example, just as Any is a superclass of every other class, Nothing is a subclass of every other class.</p>
<div class="ulist">
<ul>
<li>
<p>Class Null is the type of the <strong>null reference</strong>; it is a subclass of every reference class (i.e., every class that itself inherits from AnyRef).</p>
</li>
<li>
<p>Null is not compatible with value types.</p>
</li>
<li>
<p>Type Nothing is at the very bottom of Scala’s class hierarchy; it is a subtype of every other type.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The return type of error is Nothing, which tells users</span>
<span class="c1">// that the method will not return normally (it throws an exception instead).</span>
<span class="k">def</span> <span class="nf">error</span><span class="o">(</span><span class="n">message</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Nothing</span> <span class="o">=</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="nc">RuntimeException</span><span class="o">(</span><span class="n">message</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The root class Any has two subclasses: <strong>AnyVal</strong> and <strong>AnyRef</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AnyVal is the parent class of every built-in value class in Scala.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The other value class, <strong>Unit</strong>, corresponds roughly to Java’s void type; it is used as the result type of a method that does not otherwise return an interesting result. Unit has a single instance value, which is written <strong>()</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nc">Nil</span>
<span class="n">res22</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Nil.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">List</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="kc">null</span>
<span class="n">res23</span><span class="k">:</span> <span class="kt">Null</span> <span class="o">=</span> <span class="kc">null</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">None</span>
<span class="n">res24</span><span class="k">:</span> <span class="kt">None.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">x</span> <span class="k">=</span> <span class="o">(()</span> <span class="k">=&gt;</span> <span class="o">{})()</span>
<span class="n">x</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">()</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="traits">11. Traits</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Traits are a fundamental unit of code reuse in Scala. A trait encapsulates method and field definitions, which can then be reused by mixing them into classes. Unlike class inheritance, in which each class must inherit from just one superclass, a class can mix in any number of traits.</p>
</div>
<div class="sect2">
<h3 id="how-traits-work">11.1. How traits work</h3>
<div class="paragraph">
<p>A trait definition looks just like a class definition except that it uses the keyword <code>trait</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The definition of trait Philosophical.</span>
<span class="k">trait</span> <span class="nc">Philosophical</span> <span class="o">{</span> <span class="c1">//  extends AnyRef</span>
  <span class="k">def</span> <span class="nf">philosophize</span><span class="o">()</span> <span class="o">{</span>
    <span class="nf">println</span><span class="o">(</span><span class="s">"I consume memory, therefore I am!"</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once a trait is defined, it can be mixed in to a class using either the <code>extends</code> or <code>with</code> keywords.</p>
</div>
<div class="paragraph">
<p>Scala programmers “mix in” traits rather than inherit from them, because <strong>mixing</strong> in a trait has important differences from the <strong>multiple inheritance</strong> found in many other languages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Mixing in a trait using extends.</span>
<span class="c1">//</span>
<span class="c1">// Class From subclasses AnyRef (the superclass of Philosophical)</span>
<span class="c1">//   and mixes in Philosophical.</span>
<span class="c1">//</span>
<span class="c1">// Methods inherited from a trait can be used just like</span>
<span class="c1">//   methods inherited from a superclass.</span>
<span class="k">class</span> <span class="nc">Frog</span> <span class="k">extends</span> <span class="nc">Philosophical</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="s">"green"</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">frog</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Frog</span>
<span class="nv">frog</span><span class="o">.</span><span class="py">philosophize</span><span class="o">()</span>
<span class="c1">// Output:</span>
<span class="c1">// I consume memory, therefore I am!</span>

<span class="k">val</span> <span class="nv">phil</span><span class="k">:</span> <span class="kt">Philosophical</span> <span class="o">=</span> <span class="n">frog</span>
<span class="nv">frog</span><span class="o">.</span><span class="py">philosophize</span><span class="o">()</span>
<span class="c1">// Output:</span>
<span class="c1">// I consume memory, therefore I am!</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wish to mix a trait into a class that explicitly extends a superclass, you <strong>use extends to indicate the superclass and with to mix in the trait</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">Animal</span>

<span class="k">trait</span> <span class="nc">HasLegs</span>

<span class="c1">// Mixing in multiple traits using with.</span>
<span class="k">class</span> <span class="nc">Frog</span> <span class="k">extends</span> <span class="nc">Animal</span> <span class="k">with</span> <span class="nc">Philosophical</span> <span class="k">with</span> <span class="nc">HasLegs</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="s">"green"</span>

  <span class="c1">// override philosophize</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">philosophize</span><span class="o">()</span> <span class="o">{</span>
    <span class="nf">println</span><span class="o">(</span><span class="s">"It ain't easy being "</span><span class="o">+</span> <span class="n">toString</span> <span class="o">+</span><span class="s">"!"</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">phrog</span><span class="k">:</span> <span class="kt">Philosophical</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Frog</span>
<span class="nv">phrog</span><span class="o">.</span><span class="py">philosophize</span><span class="o">()</span>
<span class="c1">// Output:</span>
<span class="c1">// It ain't easy being green!</span>

<span class="k">trait</span> <span class="nc">Philosophical</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">philosophize</span><span class="o">()</span> <span class="o">{}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">trait</span> <span class="nc">Philosophical</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">philosophize</span><span class="o">()</span> <span class="o">{</span>
    <span class="nf">println</span><span class="o">(</span><span class="s">"I'm thinking, therefore I am!"</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Zhangsan</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="s">"法外狂徒!"</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">philZhang</span><span class="k">:</span> <span class="kt">Philosophical</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Zhangsan</span> <span class="k">with</span> <span class="nc">Philosophical</span>
<span class="nv">philZhang</span><span class="o">.</span><span class="py">philosophize</span><span class="o">()</span>
<span class="nf">println</span><span class="o">(</span><span class="n">philZhang</span><span class="o">)</span>
<span class="c1">// Output:</span>
<span class="c1">// I'm thinking, therefore I am!</span>
<span class="c1">// 法外狂徒!</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Traits can declare fields and maintain state.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Trait cannot have any “class” parameters, i.e., parameters passed to the primary constructor of a class.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">trait</span> <span class="nc">NoPoint</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="c1">// Does not compile</span></code></pre>
</div>
</div>
</li>
<li>
<p>The other difference between classes and traits is that whereas in classes, super calls are statically bound, in traits, they are dynamically bound.</p>
<div class="paragraph">
<p>If you write “super.toString” in a class, you know exactly which method implementation will be invoked.</p>
</div>
<div class="paragraph">
<p>When you write the same thing in a trait, however, the method implementation to invoke for the super call is undefined when you define the trait.</p>
</div>
<div class="paragraph">
<p>Rather, the implementation to invoke will be determined anew each time the trait is mixed into a concrete class. This curious behavior of <code>super</code> is key to allowing traits to work as <strong>stackable modifications</strong>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="thin-versus-rich-interfaces">11.2. Thin versus rich interfaces</h3>
<div class="paragraph">
<p>One major use of traits is to automatically add methods to a class in terms of methods the class already has. That is, traits can enrich a <strong>thin</strong> interface, making it into a <strong>rich</strong> interface.</p>
</div>
</div>
<div class="sect2">
<h3 id="traits-as-stackable-modifications">11.3. Traits as stackable modifications</h3>
<div class="paragraph">
<p>You have now seen one major use of traits: turning a thin interface into a rich one. Now we’ll turn to a second major use: providing stackable modifications to classes. Traits let you <strong>modify</strong> the methods of a class, and they do so in a way that allows you to <strong>stack</strong> those modifications with each other.</p>
</div>
<div class="paragraph">
<p>Given a class that implements such a queue, you could define traits to perform modifications such as these:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Doubling: double all integers that are put in the queue</p>
</li>
<li>
<p>Incrementing: increment all integers that are put in the queue</p>
</li>
<li>
<p>Filtering: filter out negative integers from a queue</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These three traits represent <strong>modifications</strong>, because they modify the behavior of an underlying queue class rather than defining a full queue class themselves. The three are also <strong>stackable</strong>. You can select any of the three you like, mix them into a class, and obtain a new class that has all of the modifications you chose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Abstract class IntQueue.</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">IntQueue</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">get</span><span class="o">()</span><span class="k">:</span> <span class="kt">Int</span>

  <span class="k">def</span> <span class="nf">put</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">import</span> <span class="nn">scala.collection.mutable.ArrayBuffer</span>

<span class="c1">// A BasicIntQueue implemented with an ArrayBuffer.</span>
<span class="k">class</span> <span class="nc">BasicIntQueue</span> <span class="k">extends</span> <span class="nc">IntQueue</span> <span class="o">{</span>
  <span class="k">private</span> <span class="k">val</span> <span class="nv">buf</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ArrayBuffer</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">get</span><span class="o">()</span> <span class="k">=</span> <span class="nv">buf</span><span class="o">.</span><span class="py">remove</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>

  <span class="k">def</span> <span class="nf">put</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span> <span class="n">buf</span> <span class="o">+=</span> <span class="n">x</span> <span class="o">}</span>
<span class="o">}</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">queue</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BasicIntQueue</span>
<span class="n">queue</span><span class="k">:</span> <span class="kt">BasicIntQueue</span> <span class="o">=</span> <span class="nc">BasicIntQueue</span><span class="k">@</span><span class="mi">9468</span><span class="n">ea6</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="mi">20</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">get</span><span class="o">()</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">get</span><span class="o">()</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">20</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The Doubling stackable modification trait.</span>
<span class="c1">//</span>
<span class="c1">// The Doubling trait has two funny things going on.</span>
<span class="c1">//</span>
<span class="c1">//   1. The first is that it declares a superclass, IntQueue.</span>
<span class="c1">//      This declaration means that the trait can only be mixed into</span>
<span class="c1">//      a class that also extends IntQueue.</span>
<span class="c1">//      Thus, you can mix Doubling into BasicIntQueue, but not into other types.</span>
<span class="c1">//   2. The second funny thing is that the trait has a super call on a method</span>
<span class="c1">//      declared abstract. Such calls are illegal for normal classes, because</span>
<span class="c1">//      they will certainly fail at runtime.</span>
<span class="c1">//      For a trait, however, such a call can actually succeed. Since super calls</span>
<span class="c1">//      in a trait are dynamically bound, the super call in trait Doubling will</span>
<span class="c1">//      work so long as the trait is mixed in after another trait or class that</span>
<span class="c1">//      gives a concrete definition to the method.</span>
<span class="k">trait</span> <span class="nc">Doubling</span> <span class="k">extends</span> <span class="nc">IntQueue</span> <span class="o">{</span>
  <span class="c1">// This arrangement is frequently needed with traits that implement stackable modifications.</span>
  <span class="c1">// To tell the compiler you are doing this on purpose, you must mark</span>
  <span class="c1">//   such methods as `abstract override`.</span>
  <span class="c1">// This combination of modifiers is only allowed for members of traits, not classes,</span>
  <span class="c1">//  and it means that the trait must be mixed into some class that has a concrete definition of</span>
  <span class="c1">//    the method in question.</span>
  <span class="k">abstract</span> <span class="k">override</span> <span class="k">def</span> <span class="nf">put</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span> <span class="nv">super</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">)</span> <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Note that MyQueue defines no new code.</span>
<span class="c1">// It simply identifies a class and mixes in a trait.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">MyQueue</span> <span class="k">extends</span> <span class="nc">BasicIntQueue</span> <span class="k">with</span> <span class="nc">Doubling</span>
<span class="n">defined</span> <span class="k">class</span> <span class="nc">MyQueue</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">queue</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyQueue</span>
<span class="n">queue</span><span class="k">:</span> <span class="kt">MyQueue</span> <span class="o">=</span> <span class="nc">MyQueue</span><span class="k">@</span><span class="mi">130</span><span class="n">a6c5c</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">get</span><span class="o">()</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1">// Mixing in a trait when instantiating with new.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">queue</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BasicIntQueue</span> <span class="k">with</span> <span class="nc">Doubling</span>
<span class="n">queue</span><span class="k">:</span> <span class="kt">BasicIntQueue</span> <span class="kt">with</span> <span class="kt">Doubling</span> <span class="o">=</span> <span class="nc">$anon$1</span><span class="nd">@d050328</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">get</span><span class="o">()</span>
<span class="n">res9</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">20</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To see how to stack modifications, we need to define the other two modification traits, Incrementing and Filtering.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Stackable modification traits Incrementing and Filtering.</span>
<span class="k">trait</span> <span class="nc">Incrementing</span> <span class="k">extends</span> <span class="nc">IntQueue</span> <span class="o">{</span>
  <span class="k">abstract</span> <span class="k">override</span> <span class="k">def</span> <span class="nf">put</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span> <span class="nv">super</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">}</span>
<span class="o">}</span>

<span class="k">trait</span> <span class="nc">Filtering</span> <span class="k">extends</span> <span class="nc">IntQueue</span> <span class="o">{</span>
  <span class="k">abstract</span> <span class="k">override</span> <span class="k">def</span> <span class="nf">put</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
    <span class="nf">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="nv">super</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">queue</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BasicIntQueue</span> <span class="k">with</span> <span class="nc">Incrementing</span> <span class="k">with</span> <span class="nc">Filtering</span>
<span class="n">queue</span><span class="k">:</span> <span class="kt">BasicIntQueue</span> <span class="kt">with</span> <span class="kt">Incrementing</span> <span class="kt">with</span> <span class="kt">Filtering</span> <span class="o">=</span> <span class="nc">$anon$1</span><span class="k">@</span><span class="mi">458</span><span class="n">a5362</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(-</span><span class="mi">1</span><span class="o">);</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">get</span><span class="o">()</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">get</span><span class="o">()</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1">// The order of mixins is significant.</span>
<span class="c1">//  The precise rules, roughly speaking, traits further to the right take effect first.</span>
<span class="c1">//    When you call a method on a class with mixins, the method</span>
<span class="c1">//      in the trait furthest to the right is called first.</span>
<span class="c1">//    If that method calls super, it invokes the method in the next trait to its left,</span>
<span class="c1">//      and so on.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">queue</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BasicIntQueue</span> <span class="k">with</span> <span class="nc">Filtering</span> <span class="k">with</span> <span class="nc">Incrementing</span>
<span class="n">queue</span><span class="k">:</span> <span class="kt">BasicIntQueue</span> <span class="kt">with</span> <span class="kt">Filtering</span> <span class="kt">with</span> <span class="kt">Incrementing</span> <span class="o">=</span> <span class="nc">$anon$1</span><span class="k">@</span><span class="mi">1</span><span class="n">c8d5d80</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(-</span><span class="mi">1</span><span class="o">);</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="nv">queue</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">get</span><span class="o">()</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">get</span><span class="o">()</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">queue</span><span class="o">.</span><span class="py">get</span><span class="o">()</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">2</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="why-not-multiple-inheritance">11.4. Why not multiple inheritance?</h3>
<div class="paragraph">
<p>Traits are a way to inherit from multiple class-like constructs, but they differ in important ways from the multiple inheritance present in many languages.</p>
</div>
<div class="paragraph">
<p>One difference is especially important: <strong>the interpretation of <code>super</code></strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>With multiple inheritance, the method called by a super call can be determined right where the call appears.</p>
</li>
<li>
<p>With traits, the method called is determined by a <strong>linearization</strong> of the classes and traits that are mixed into a class.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="to-trait-or-not-to-trait">11.5. To trait, or not to trait?</h3>
<div class="paragraph">
<p>Whenever you implement a reusable collection of behavior, you will have to decide whether you want to use a trait or an abstract class.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>If the behavior will not be reused, then make it a concrete class.</strong></p>
<div class="paragraph">
<p>It is not reusable behavior after all.</p>
</div>
</li>
<li>
<p><strong>If it might be reused in multiple, unrelated classes, make it a trait.</strong></p>
<div class="paragraph">
<p>Only traits can be mixed into different parts of the class hierarchy.</p>
</div>
</li>
<li>
<p><strong>If you want to inherit from it in Java code, use an abstract class.</strong></p>
<div class="paragraph">
<p>Since traits with code do not have a close Java analog, it tends to be awkward to inherit from a trait in a Java class.+
Inheriting from a Scala class, meanwhile, is exactly like inheriting from a Java class.
*
As one exception, a Scala trait with only abstract members translates directly to a Java interface, so you should feel free to define such traits even if you expect Java code to inherit from it.</p>
</div>
</li>
<li>
<p><strong>If you plan to distribute it in compiled form</strong>, and you expect outside groups to write classes inheriting from it, you might lean towards using an <strong>abstract class</strong>.</p>
<div class="paragraph">
<p>The issue is that when a trait gains or loses a member, any classes that inherit from it must be recompiled, even if they have not changed.</p>
</div>
<div class="paragraph">
<p>If outside clients will only call into the behavior, instead of inheriting from it, then using a trait is fine.</p>
</div>
</li>
<li>
<p><strong>If efficiency is very important, lean towards using a class.</strong></p>
<div class="paragraph">
<p>Most Java runtimes make a virtual method invocation of a class member a faster operation than an interface method invocation.</p>
</div>
<div class="paragraph">
<p>Traits get compiled to interfaces and therefore may pay a slight performance overhead.</p>
</div>
<div class="paragraph">
<p>However, you should make this choice only if you know that the trait in question constitutes a performance bottleneck and have evidence that using a class instead actually solves the problem.</p>
</div>
</li>
<li>
<p><strong>If you still do not know, after considering the above, then start by making it as a trait.</strong></p>
<div class="paragraph">
<p>You can always change it later, and in general using a trait keeps more options open.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="packages-and-imports">12. Packages and Imports</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="putting-code-in-packages">12.1. Putting code in packages</h3>
<div class="paragraph">
<p>Scala code resides in the Java platform’s global hierarchy of packages. The example code you’ve seen so far in this book has been in the unnamed package. You can place code into named packages in Scala in two ways.</p>
</div>
<div class="paragraph">
<p>First, you can place the contents of an entire file into a package by putting a package clause at the top of the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Placing the contents of an entire file into a package.</span>
<span class="k">package</span> <span class="nn">bobsrockets.navigation</span>
<span class="k">class</span> <span class="nc">Navigator</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The other way you can place code into packages in Scala is more like C# namespaces. You follow a package clause by a section in curly braces that contains the definitions that go into the package. This syntax is called a <strong>packaging</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Long form of a simple package declaration.</span>
<span class="k">package</span> <span class="nn">bobsrockets.navigation</span> <span class="o">{</span>
  <span class="k">class</span> <span class="nc">Navigator</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="concise-access-to-related-code">13. Concise access to related code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When code is divided into a package hierarchy, it doesn’t just help people browse through the code. It also tells the compiler that code in the same package is related in some way to each other. Scala takes advantage of this relatedness by allowing short, unqualified names when accessing code that is in the same package.</p>
</div>
<div class="paragraph">
<p>Scala provides a package named <code><em>root</em></code> that is outside any package a user can write. Put another way, every top-level package you can write is treated as a member of <code>package <em>root</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">package</span> <span class="nn">launch</span> <span class="o">{</span>
  <span class="k">class</span> <span class="nc">Booster3</span>
<span class="o">}</span>

<span class="k">package</span> <span class="nn">spaceX</span> <span class="o">{</span>
  <span class="k">package</span> <span class="nn">navigation</span> <span class="o">{</span>
    <span class="k">package</span> <span class="nn">launch</span> <span class="o">{</span>
      <span class="k">class</span> <span class="nc">Booster1</span>

      <span class="k">class</span> <span class="nc">MissionControl</span> <span class="o">{</span>
        <span class="k">val</span> <span class="nv">booster1</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Booster1</span>
        <span class="k">val</span> <span class="nv">booster2</span> <span class="k">=</span> <span class="k">new</span> <span class="nv">spaceX</span><span class="o">.</span><span class="py">launch</span><span class="o">.</span><span class="py">Booster2</span>
        <span class="k">val</span> <span class="nv">booster3</span> <span class="k">=</span> <span class="k">new</span> <span class="nv">_root_</span><span class="o">.</span><span class="py">launch</span><span class="o">.</span><span class="py">Booster3</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">package</span> <span class="nn">launch</span> <span class="o">{</span>
    <span class="k">class</span> <span class="nc">Booster2</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="imports">13.1. Imports</h3>
<div class="paragraph">
<p><strong>In Scala, packages and their members can be imported using import clauses.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Bob’s delightful fruits, ready for import.</span>
<span class="k">package</span> <span class="nn">bobsdelights</span>

<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Fruit</span><span class="o">(</span>
  <span class="k">val</span> <span class="nv">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
  <span class="k">val</span> <span class="nv">color</span><span class="k">:</span> <span class="kt">String</span>
<span class="o">)</span>

<span class="k">object</span> <span class="nc">Fruits</span> <span class="o">{</span>
  <span class="k">object</span> <span class="nc">Apple</span> <span class="k">extends</span> <span class="nc">Fruit</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"red"</span><span class="o">)</span>
  <span class="k">object</span> <span class="nc">Orange</span> <span class="k">extends</span> <span class="nc">Fruit</span><span class="o">(</span><span class="s">"orange"</span><span class="o">,</span> <span class="s">"orange"</span><span class="o">)</span>
  <span class="k">object</span> <span class="nc">Pear</span> <span class="k">extends</span> <span class="nc">Fruit</span><span class="o">(</span><span class="s">"pear"</span><span class="o">,</span> <span class="s">"yellowish"</span><span class="o">)</span>
  <span class="k">val</span> <span class="nv">menu</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">Apple</span><span class="o">,</span> <span class="nc">Orange</span><span class="o">,</span> <span class="nc">Pear</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>An import clause <strong>makes members of a package or object available by their names</strong> alone</p>
<div class="paragraph">
<p>without needing to prefix them by the package or object name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The first of these corresponds to Java’s single type import,</span>
<span class="c1">//</span>
<span class="c1">// the second to Java’s on-demand import.</span>
<span class="c1">//</span>
<span class="c1">// The only difference is that Scala’s on-demand imports are written</span>
<span class="c1">// with a trailing underscore (`_`) instead of an asterisk (`*`) (after all,</span>
<span class="c1">// `*` is a valid identifier in Scala!).</span>
<span class="c1">//</span>
<span class="c1">// The third import clause above corresponds to Java’s import of static class fields.</span>
<span class="c1">//</span>
<span class="c1">// easy access to Fruit</span>
<span class="k">import</span> <span class="nn">bobsdelights.Fruit</span>

<span class="c1">// easy access to all members of bobsdelights</span>
<span class="k">import</span> <span class="nn">bobsdelights._</span>

<span class="c1">// easy access to all members of Fruits</span>
<span class="k">import</span> <span class="nn">bobsdelights.Fruits._</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Imports in Scala can appear anywhere</strong>, not just at the beginning of a compilation unit.</p>
<div class="paragraph">
<p>Also, <strong>they can refer to arbitrary values</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Importing the members of a regular (not singleton) object.</span>
<span class="k">def</span> <span class="nf">showFruit</span><span class="o">(</span><span class="n">fruit</span><span class="k">:</span> <span class="kt">Fruit</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">import</span> <span class="nn">fruit._</span>
  <span class="nf">println</span><span class="o">(</span><span class="n">name</span> <span class="o">+</span><span class="s">"s are "</span><span class="o">+</span> <span class="n">color</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p>Another way Scala’s imports are flexible is that they can <strong>import packages themselves, not just their non-package members</strong>.</p>
<div class="paragraph">
<p>This is only natural if you think of nested packages being contained in their surrounding package.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Importing a package name.</span>
<span class="k">import</span> <span class="nn">java.util.regex</span>

<span class="k">class</span> <span class="nc">AStarB</span> <span class="o">{</span>
  <span class="c1">// Accesses java.util.regex.Pattern</span>
  <span class="k">val</span> <span class="nv">pat</span> <span class="k">=</span> <span class="nv">regex</span><span class="o">.</span><span class="py">Pattern</span><span class="o">.</span><span class="py">compile</span><span class="o">(</span><span class="s">"a*b"</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p>Imports in Scala can also <strong>rename or hide members</strong>.</p>
<div class="paragraph">
<p>This is done with an <strong>import selector clause</strong> enclosed in braces, which follows the object from which members are imported.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// imports just members Apple and Orange from object Fruits.</span>
<span class="k">import</span> <span class="nn">Fruits.</span><span class="o">{</span><span class="nc">Apple</span><span class="o">,</span> <span class="nc">Orange</span><span class="o">}</span>

<span class="c1">// imports the two members Apple and Orange from object Fruits.</span>
<span class="c1">// However, the `Apple` object is renamed to `McIntosh`.</span>
<span class="c1">// So this object can be  accessed with either `Fruits.Apple` or `McIntosh`.</span>
<span class="c1">//  A renaming clause is always of the form “&lt;original-name&gt; =&gt; &lt;new-name&gt;”.</span>
<span class="k">import</span> <span class="nn">Fruits.</span><span class="o">{</span><span class="nc">Apple</span> <span class="k">=&gt;</span> <span class="nc">McIntosh</span><span class="o">,</span> <span class="nc">Orange</span><span class="o">}</span>

<span class="c1">// imports all members from object `Fruits`.</span>
<span class="c1">// It means the same thing as `import Fruits._`.</span>
<span class="k">import</span> <span class="nn">Fruits.</span><span class="o">{</span><span class="k">_</span><span class="o">}</span>
<span class="c1">// import Fruits._</span>

<span class="c1">// imports all members from object Fruits but renames Apple to McIntosh.</span>
<span class="k">import</span> <span class="nn">Fruits.</span><span class="o">{</span><span class="nc">Apple</span> <span class="k">=&gt;</span> <span class="nc">McIntosh</span><span class="o">,</span> <span class="k">_</span><span class="o">}</span>

<span class="c1">// imports all members of `Fruits` except `Pear`.</span>
<span class="c1">// A clause of the form “&lt;original-name&gt; =&gt; _” excludes &lt;original-name&gt; from the names</span>
<span class="c1">//  that are imported.</span>
<span class="c1">// In a sense, renaming something to ‘_’ means hiding it altogether.</span>
<span class="c1">// This is useful to avoid ambiguities.</span>
<span class="k">import</span> <span class="nn">Fruits.</span><span class="o">{</span><span class="nc">Pear</span> <span class="k">=&gt;</span> <span class="k">_</span><span class="o">,</span> <span class="k">_</span><span class="o">}</span>

<span class="c1">// import all Notebooks and all Fruits except for Apple.</span>
<span class="k">import</span> <span class="nn">Notebooks._</span>
<span class="k">import</span> <span class="nn">Fruits.</span><span class="o">{</span><span class="nc">Apple</span> <span class="k">=&gt;</span> <span class="k">_</span><span class="o">,</span> <span class="k">_</span><span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In summary, an <strong>import selector</strong> can consist of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A simple name x.</p>
<div class="paragraph">
<p>This includes x in the set of imported names.</p>
</div>
</li>
<li>
<p>A renaming clause x => y.</p>
<div class="paragraph">
<p>This makes the member named x visible under the name y.</p>
</div>
</li>
<li>
<p>A hiding clause x => _.</p>
<div class="paragraph">
<p>This excludes x from the set of imported names.</p>
</div>
</li>
<li>
<p>A catch-all ‘_’.</p>
<div class="paragraph">
<p>This imports all members except those members mentioned in a preceding clause.</p>
</div>
<div class="paragraph">
<p>If a catch-all is given, it must come last in the list of import selectors.</p>
</div>
</li>
<li>
<p>The <strong>simpler import</strong> clauses can be seen as special abbreviations of import clauses with a selector clause.</p>
<div class="paragraph">
<p>For example, “import p._” is equivalent to “import p.{_}” and “import p.n” is equivalent to “import p.{n}”.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="implicit-imports">13.2. Implicit imports</h3>
<div class="paragraph">
<p>Scala adds some imports implicitly to every program. In essence, it is as if the following three import clauses had been added to the top of every source file with extension “.scala”:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">import</span> <span class="nn">java.lang._</span> <span class="c1">// everything in the java.lang package</span>
<span class="k">import</span> <span class="nn">scala._</span>     <span class="c1">// everything in the scala package</span>
<span class="k">import</span> <span class="nn">Predef._</span>    <span class="c1">// everything in the Predef object</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>java.lang package</strong> contains standard Java classes.</p>
<div class="paragraph">
<p>It is always implicitly imported on the JVM implementation of Scala.</p>
</div>
<div class="paragraph">
<p>The .NET implementation would import package system instead, which is the .NET analogue of java.lang.</p>
</div>
<div class="paragraph">
<p>Because java.lang is imported implicitly, you can write Thread instead of java.lang.Thread, for instance.</p>
</div>
</li>
<li>
<p>As you have no doubt realized by now, the <strong>scala package</strong> contains the standard Scala library, with many common classes and objects.</p>
<div class="paragraph">
<p>Because scala is imported implicitly, you can write List instead of scala.List, for instance.</p>
</div>
</li>
<li>
<p>The <strong>Predef object</strong> contains many definitions of types, methods, and implicit conversions that are commonly used on Scala programs. For example, because Predef is imported implicitly, you can write assert instead of Predef.assert.</p>
</li>
<li>
<p>The three import clauses above are treated a bit specially in that <strong>later imports overshadow earlier ones</strong>.</p>
<div class="paragraph">
<p>For instance, the StringBuilder class is defined both in package scala and, from Java version 1.5 on, also in package java.lang.</p>
</div>
<div class="paragraph">
<p>Because the scala import overshadows the java.lang import, the simple name StringBuilder will refer to scala.StringBuilder, not java.lang.StringBuilder.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="access-modifiers">13.3. Access modifiers</h3>
<div class="paragraph">
<p>Members of packages, classes, or objects can be labeled with the access modifiers <code>private</code> and <code>protected</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Private members</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A member labeled private is visible only inside the class or</span>
<span class="c1">//   object that contains the member definition.</span>
<span class="c1">//</span>
<span class="c1">// Java would permit both accesses because it lets an outer class</span>
<span class="c1">//   access private members of its inner classes.</span>
<span class="k">class</span> <span class="nc">Outer</span> <span class="o">{</span>

  <span class="k">class</span> <span class="nc">Inner</span> <span class="o">{</span>
    <span class="k">private</span> <span class="k">def</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span> <span class="nf">println</span><span class="o">(</span><span class="s">"f"</span><span class="o">)</span> <span class="o">}</span>

    <span class="k">class</span> <span class="nc">InnerMost</span> <span class="o">{</span>
      <span class="nf">f</span><span class="o">()</span> <span class="c1">// OK</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="o">(</span><span class="k">new</span> <span class="nc">Inner</span><span class="o">).</span><span class="py">f</span><span class="o">()</span> <span class="c1">// error: f is not accessible</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Protected members</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// In Scala, a protected member is only accessible from subclasses of</span>
<span class="c1">//   the class in which the member is defined.</span>
<span class="c1">//</span>
<span class="c1">// In Java such accesses are also possible from other classes in</span>
<span class="c1">//   the same package.</span>
<span class="k">package</span> <span class="nn">p</span> <span class="o">{</span>
  <span class="k">class</span> <span class="nc">Super</span> <span class="o">{</span>
    <span class="k">protected</span> <span class="k">def</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span> <span class="nf">println</span><span class="o">(</span><span class="s">"f"</span><span class="o">)</span> <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">class</span> <span class="nc">Sub</span> <span class="k">extends</span> <span class="nc">Super</span> <span class="o">{</span>
    <span class="nf">f</span><span class="o">()</span>
  <span class="o">}</span>

  <span class="k">class</span> <span class="nc">Other</span> <span class="o">{</span>
    <span class="o">(</span><span class="k">new</span> <span class="nc">Super</span><span class="o">).</span><span class="py">f</span><span class="o">()</span>  <span class="c1">// error: f is not accessible</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Public members</strong></p>
<div class="paragraph">
<p><strong>Every member not labeled private or protected is public.</strong></p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>There is no explicit modifier for public members.</p>
</li>
<li>
<p>Such members can be accessed from anywhere.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p><strong>Scope of protection</strong></p>
<div class="paragraph">
<p>Access modifiers in Scala can be augmented with qualifiers.</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>A modifier of the form <strong>private[X]</strong> or <strong>protected[X]</strong> means that access is private or protected “up to” X, where X designates some <strong>enclosing package</strong>, <strong>class</strong> or <strong>singleton object</strong>.</p>
</li>
<li>
<p>Qualified access modifiers give you very finegrained control over visibility.</p>
<div class="ulist">
<ul>
<li>
<p>In particular they enable you to express Java’s accessibility notions such as <strong>package private</strong>, <strong>package protected</strong>, or <strong>private up to outermost class</strong>, which are not directly expressible with simple modifiers in Scala.</p>
</li>
<li>
<p>But they also let you express accessibility rules that cannot be expressed in Java.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">package</span> <span class="nn">bobsrockets</span>

<span class="k">package</span> <span class="nn">navigation</span> <span class="o">{</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">bobsrockets</span><span class="o">]</span> <span class="k">class</span> <span class="nc">Navigator</span> <span class="o">{</span>

    <span class="k">protected</span><span class="o">[</span><span class="kt">navigation</span><span class="o">]</span> <span class="k">def</span> <span class="nf">useStarChart</span><span class="o">()</span> <span class="o">{}</span>

    <span class="k">class</span> <span class="nc">LegOfJourney</span> <span class="o">{</span>
      <span class="k">private</span><span class="o">[</span><span class="kt">Navigator</span><span class="o">]</span> <span class="k">val</span> <span class="nv">distance</span> <span class="k">=</span> <span class="mi">100</span>
    <span class="o">}</span>

    <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">speed</span> <span class="k">=</span> <span class="mi">200</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">package</span> <span class="nn">launch</span> <span class="o">{</span>

  <span class="k">import</span> <span class="nn">navigation._</span>

  <span class="k">object</span> <span class="nc">Vehicle</span> <span class="o">{</span>
    <span class="k">private</span><span class="o">[</span><span class="kt">launch</span><span class="o">]</span> <span class="k">val</span> <span class="nv">guide</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Navigator</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Effects of private qualifiers on LegOfJourney.distance</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>no access modifier</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">public access</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">private[bobsrockets]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">access within outer package</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">private[navigation]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">same as package visibility in Java</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">private[Navigator]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">same as private in Java</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">private[LegOfJourney]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">same as private in Scala</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">private[this]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>access only from same object</p>
</div>
<div class="paragraph">
<p>Such a definition is called <strong>object-private</strong>.</p>
</div>
<div class="paragraph">
<p>Marking a member private[this] is a guarantee that it will not be seen from other objects of the same class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">val</span> <span class="nv">other</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Navigator</span>
<span class="nv">other</span><span class="o">.</span><span class="py">speed</span> <span class="c1">// this line would not compile</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Visibility and companion objects</strong></p>
<div class="paragraph">
<p>In Java, static members and instance members belong to the same class, so access modifiers apply uniformly to them.</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>You have already seen that <strong>in Scala there are no static members; instead you can have a companion object</strong> that contains members that exist only once.</p>
</li>
<li>
<p>Scala’s access rules privilege companion objects and classes when it comes to private or protected accesses.</p>
<div class="paragraph">
<p>A class shares all its access rights with its companion object and vice versa.</p>
</div>
<div class="paragraph">
<p>In particular, an object can access all private members of its companion class, just as a class can access all private members of its companion object.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>One exception where the similarity between Scala and Java breaks down concerns <strong>protected static</strong> members.</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>A protected static member of a Java class C can be accessed in all subclasses of C.</p>
</li>
<li>
<p>By contrast, <strong>a protected member in a companion object makes no sense</strong>, as singleton objects don’t have any subclasses.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="package-objects">13.4. Package objects</h3>
<div class="paragraph">
<p>Any kind of definition that you can put inside a class, you can also put at the top level of a package.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you have some helper method you’d like to be in scope for an entire package, go ahead and put it right at the top level of the package.</p>
</li>
<li>
<p>To do so, put the definitions in a <strong>package object</strong>.</p>
</li>
<li>
<p>Each package is allowed to have one package object.</p>
</li>
<li>
<p>Any definitions placed in a package object are considered members of the package itself.</p>
</li>
<li>
<p>Package objects are compiled to class files named <strong>package.class</strong> that are the located in the directory of the package that they augment.</p>
<div class="paragraph">
<p>It’s useful to keep the same convention for source files named <strong>package.scala</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// File in breaks/package.scala</span>
<span class="c1">//</span>
<span class="c1">// It's a package object, not a package.</span>
<span class="c1">// The contents of the curly braces can include any definitions you like.</span>
<span class="k">package</span> <span class="nn">object</span> <span class="n">breaks</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">breakable</span><span class="o">(</span><span class="n">op</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">op</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">{</span>
      <span class="k">case</span> <span class="k">_:</span> <span class="kt">BreakException</span> <span class="o">=&gt;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">break</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nc">BreakException</span><span class="o">()</span>
  <span class="o">}</span>

  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">BreakException</span><span class="o">()</span> <span class="k">extends</span> <span class="nc">Exception</span><span class="o">()</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// File in Main.scala</span>
<span class="k">object</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="k">import</span> <span class="nn">java.io._</span>
    <span class="k">import</span> <span class="nn">breaks._</span>

    <span class="k">val</span> <span class="nv">in</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="nv">System</span><span class="o">.</span><span class="py">in</span><span class="o">))</span>
    <span class="n">breakable</span> <span class="o">{</span>
      <span class="nf">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
        <span class="nf">println</span><span class="o">(</span><span class="s">"? "</span><span class="o">)</span>
        <span class="nf">if</span> <span class="o">(</span><span class="nv">in</span><span class="o">.</span><span class="py">readLine</span><span class="o">()</span> <span class="o">==</span> <span class="s">""</span><span class="o">)</span> <span class="n">break</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>tree <span class="nb">.</span>
<span class="c">.
</span><span class="go">├── Main.scala
└── breaks
    └── package.scala

1 directory, 2 files
</span><span class="gp">$</span><span class="w"> </span>scalac <span class="k">**</span>/<span class="k">*</span>.scala
<span class="gp">$</span><span class="w"> </span>tree <span class="nb">.</span>
<span class="c">.
</span><span class="go">├── Main.scala
└── breaks
</span><span class="gp">    ├── package$</span>.class
<span class="gp">    ├── package$</span>BreakException<span class="nv">$.</span>class
<span class="gp">    ├── package$</span>BreakException.class
<span class="go">    ├── package.class
    └── package.scala

1 directory, 6 files
</span><span class="gp">$</span><span class="w"> </span>scala Main.scala
<span class="go">?
</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assertions-and-unit-testing">14. Assertions and Unit Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Two important ways to check that the behavior of the software you write is as you expect are <strong>assertions</strong> and <strong>unit tests</strong>.</p>
</div>
<div class="sect2">
<h3 id="assertions">14.1. Assertions</h3>
<div class="paragraph">
<p><strong>Assertions</strong> in Scala are written as calls of a predefined method <code>assert</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The expression <code>assert(condition)</code> throws an <code>AssertionError</code> if condition does not hold.</p>
<div class="ulist">
<ul>
<li>
<p>The expression <code>assert(condition, explanation)</code> tests condition, and, if it does not hold, throws an <code>AssertionError</code> that contains the given <code>explanation</code>.</p>
<div class="paragraph">
<p>The type of <code>explanation</code> is <code>Any</code>, so you can pass any object as the explanation. The <code>assert</code> method will call <code>toString</code> on it to get a string explanation to place inside the <code>AssertionError</code>.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Assertions (and ensuring checks) can be enabled and disabled using the JVM’s <code>-ea</code> and <code>-da</code> command-line flags.</p>
<div class="paragraph">
<p>When enabled, each assertion serves as a little test that uses the actual data encountered as the software runs.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="unit-testing-in-scala">14.2. Unit testing in Scala</h3>
<div class="paragraph">
<p>You have many options for unit testing in Scala, from established Java tools, such as JUnit and TestNG, to new tools written in Scala, such as <strong>ScalaTest</strong>, specs, and ScalaCheck. In the remainder of this chapter, we’ll give you a quick tour of these tools.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="case-classes-and-pattern-matching">15. Case Classes and Pattern Matching</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have programmed in a functional language before, then you will probably recognize pattern matching.</p>
</div>
<div class="paragraph">
<p><strong>Case classes</strong> are Scala’s way to allow <strong>pattern matching</strong> on objects without requiring a large amount of boilerplate.</p>
</div>
<div class="paragraph">
<p>In the common case, all you need to do is add a single <code>case</code> keyword to each class that you want to be pattern matchable.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Case classes</strong></p>
<div class="paragraph">
<p>Classes with a <code>case</code> modifier are called <strong>case classes</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// source: Notification.scala</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Notification</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">SMS</span><span class="o">(</span><span class="n">caller</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">message</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Notification</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Email</span><span class="o">(</span><span class="n">sender</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">title</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">body</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Notification</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">VoiceRecording</span><span class="o">(</span><span class="n">contactName</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">link</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Notification</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// $ scalac Notification.scala &amp;&amp; javap -p SMS.class</span>
<span class="nc">Compiled</span> <span class="n">from</span> <span class="s">"Notification.scala"</span>
<span class="n">public</span> <span class="k">class</span> <span class="nc">SMS</span> <span class="k">extends</span> <span class="nc">Notification</span> <span class="n">implements</span> <span class="nv">scala</span><span class="o">.</span><span class="py">Product</span><span class="o">,</span><span class="nv">scala</span><span class="o">.</span><span class="py">Serializable</span> <span class="o">{</span>
  <span class="c1">// all arguments in the parameter list of a case class</span>
  <span class="c1">//   implicitly get a val prefix</span>
  <span class="k">private</span> <span class="k">final</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span> <span class="n">caller</span><span class="o">;</span>
  <span class="k">private</span> <span class="k">final</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span> <span class="n">message</span><span class="o">;</span>

  <span class="n">public</span> <span class="n">static</span> <span class="nv">scala</span><span class="o">.</span><span class="py">Option</span><span class="o">&lt;</span><span class="nv">scala</span><span class="o">.</span><span class="py">Tuple2</span><span class="o">&lt;</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">,</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">&gt;&gt;</span> <span class="nf">unapply</span><span class="o">(</span><span class="nc">SMS</span><span class="o">);</span>

  <span class="c1">// factory method with the name of the class</span>
  <span class="n">public</span> <span class="n">static</span> <span class="nc">SMS</span> <span class="nf">apply</span><span class="o">(</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">,</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">);</span>

  <span class="n">public</span> <span class="n">static</span> <span class="nv">scala</span><span class="o">.</span><span class="py">Function1</span><span class="o">&lt;</span><span class="nv">scala</span><span class="o">.</span><span class="py">Tuple2</span><span class="o">&lt;</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">,</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">&gt;,</span> <span class="nc">SMS</span><span class="o">&gt;</span> <span class="nf">tupled</span><span class="o">();</span>
  <span class="n">public</span> <span class="n">static</span> <span class="nv">scala</span><span class="o">.</span><span class="py">Function1</span><span class="o">&lt;</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">,</span> <span class="nv">scala</span><span class="o">.</span><span class="py">Function1</span><span class="o">&lt;</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">,</span> <span class="nc">SMS</span><span class="o">&gt;&gt;</span> <span class="nf">curried</span><span class="o">();</span>

  <span class="c1">// all arguments in the parameter list are maintained as</span>
  <span class="c1">//   fields supports uniform access principle</span>
  <span class="n">public</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span> <span class="nf">caller</span><span class="o">();</span>
  <span class="n">public</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span> <span class="nf">message</span><span class="o">();</span>

  <span class="c1">// copy method to make a new instance of the class</span>
  <span class="n">public</span> <span class="nc">SMS</span> <span class="nf">copy</span><span class="o">(</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">,</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">);</span>

  <span class="n">public</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span> <span class="nf">copy$default$1</span><span class="o">();</span>
  <span class="n">public</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span> <span class="nf">copy$default$2</span><span class="o">();</span>
  <span class="n">public</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span> <span class="nf">productPrefix</span><span class="o">();</span>
  <span class="n">public</span> <span class="n">int</span> <span class="nf">productArity</span><span class="o">();</span>
  <span class="n">public</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">Object</span> <span class="nf">productElement</span><span class="o">(</span><span class="n">int</span><span class="o">);</span>
  <span class="n">public</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">Iterator</span><span class="o">&lt;</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">Object</span><span class="o">&gt;</span> <span class="nf">productIterator</span><span class="o">();</span>
  <span class="n">public</span> <span class="n">boolean</span> <span class="nf">canEqual</span><span class="o">(</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">Object</span><span class="o">);</span>

  <span class="c1">// toString, hashCode, and equals</span>
  <span class="n">public</span> <span class="n">int</span> <span class="nf">hashCode</span><span class="o">();</span>
  <span class="n">public</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span> <span class="nf">toString</span><span class="o">();</span>
  <span class="n">public</span> <span class="n">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">Object</span><span class="o">);</span>

  <span class="n">public</span> <span class="nc">SMS</span><span class="o">(</span><span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">,</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">String</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using the modifier makes the Scala compiler add some syntactic conveniences to your class.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, it adds <strong>a factory method with the name of the class</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">sms</span> <span class="k">=</span> <span class="nc">SMS</span><span class="o">(</span><span class="s">"bob"</span><span class="o">,</span> <span class="s">"hello world!"</span><span class="o">)</span>
<span class="n">sms</span><span class="k">:</span> <span class="kt">SMS</span> <span class="o">=</span> <span class="nc">SMS</span><span class="o">(</span><span class="n">bob</span><span class="o">,</span><span class="n">hello</span> <span class="n">world</span><span class="o">!)</span></code></pre>
</div>
</div>
</li>
<li>
<p>The second syntactic convenience is that <strong>all arguments in the parameter list of a case class implicitly get a <code>val</code> prefix</strong>, so they are maintained as fields:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nv">sms</span><span class="o">.</span><span class="py">caller</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">bob</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">sms</span><span class="o">.</span><span class="py">message</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">hello</span> <span class="n">world</span><span class="o">!</span></code></pre>
</div>
</div>
</li>
<li>
<p>Third, the compiler adds “natural” implementations of methods <code>toString</code>, <code>hashCode</code>, and <code>equals</code> to your class.</p>
<div class="paragraph">
<p>They will print, hash, and compare a whole tree consisting of the class and (recursively) all its arguments.</p>
</div>
<div class="paragraph">
<p>Since == in Scala always delegates to equals, this means that elements of case classes are always compared structurally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">sms2</span> <span class="k">=</span> <span class="nc">SMS</span><span class="o">(</span><span class="s">"bob"</span><span class="o">,</span> <span class="s">"hello world!"</span><span class="o">)</span>
<span class="n">sms2</span><span class="k">:</span> <span class="kt">SMS</span> <span class="o">=</span> <span class="nc">SMS</span><span class="o">(</span><span class="n">bob</span><span class="o">,</span><span class="n">hello</span> <span class="n">world</span><span class="o">!)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">sms</span> <span class="o">==</span> <span class="n">sms2</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span></code></pre>
</div>
</div>
</li>
<li>
<p>Finally, the compiler adds a <code>copy</code> method to your class for making modified copies.</p>
<div class="paragraph">
<p>This method is useful for making a new instance of the class that is the same as another one except that one or two attributes are different.</p>
</div>
<div class="paragraph">
<p>The method works by using <strong>named and default parameters</strong>.</p>
</div>
<div class="paragraph">
<p>You specify the changes you’d like to make by using named parameters.</p>
</div>
<div class="paragraph">
<p>For any parameter you don’t specify, the value from the old object is used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">sms3</span> <span class="k">=</span> <span class="nv">sms</span><span class="o">.</span><span class="py">copy</span><span class="o">(</span><span class="n">caller</span><span class="o">=</span><span class="s">"alice"</span><span class="o">)</span>
<span class="n">sms3</span><span class="k">:</span> <span class="kt">SMS</span> <span class="o">=</span> <span class="nc">SMS</span><span class="o">(</span><span class="n">alice</span><span class="o">,</span><span class="n">hello</span> <span class="n">world</span><span class="o">!)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">sms</span> <span class="o">==</span> <span class="n">sms3</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Pattern matching</strong></p>
<div class="paragraph">
<p><strong>match</strong> corresponds to <strong>switch</strong> in Java, but it’s written after the selector expression. I.e., it’s:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">selector</span> <span class="k">match</span> <span class="o">{</span> <span class="n">alternatives</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>instead of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nf">switch</span> <span class="o">(</span><span class="n">selector</span><span class="o">)</span> <span class="o">{</span> <span class="n">alternatives</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Pattern matching is a mechanism for <strong>checking a value against a pattern</strong>.</p>
</div>
<div class="paragraph">
<p>A successful match can also <strong>deconstruct a value into its constituent parts</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">showNotification</span><span class="o">(</span><span class="n">notification</span><span class="k">:</span> <span class="kt">Notification</span><span class="o">)</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">notification</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">SMS</span><span class="o">(</span><span class="s">"012-12345"</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="n">s</span><span class="s">"You sent an SMS to Mayor Hotline! Message: $message"</span>
    <span class="k">case</span> <span class="nc">SMS</span><span class="o">(</span><span class="n">number</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="n">s</span><span class="s">"You got an SMS from $number! Message: $message"</span>
    <span class="k">case</span> <span class="nc">Email</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">title</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="n">s</span><span class="s">"You got an email from $sender with title: $title"</span>
    <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="n">s</span><span class="s">"You got an unkown message!"</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">notifications</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="nc">Email</span><span class="o">(</span><span class="s">"virus@2019-n.cov"</span><span class="o">,</span> <span class="s">"Drinks tonight?"</span><span class="o">,</span> <span class="s">"I'm free after 5!"</span><span class="o">),</span>
  <span class="nc">SMS</span><span class="o">(</span><span class="s">"021-12345"</span><span class="o">,</span> <span class="s">"Mayor: Are you hungry?"</span><span class="o">),</span>
  <span class="nc">SMS</span><span class="o">(</span><span class="s">"12345"</span><span class="o">,</span> <span class="s">"404: NotFound."</span><span class="o">),</span>
  <span class="nc">VoiceRecording</span><span class="o">(</span><span class="s">"Alice"</span><span class="o">,</span> <span class="s">"voicerecording.org/id/123"</span><span class="o">),</span>
  <span class="o">)</span>

<span class="nv">notifications</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="n">showNotification</span><span class="o">).</span><span class="py">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>

<span class="c1">// Output:</span>
<span class="c1">// You got an email from virus@2019-n.cov with title: Drinks tonight?</span>
<span class="c1">// You got an SMS from 021-12345! Message: Mayor: Are you hungry?</span>
<span class="c1">// You got an SMS from 12345! Message: 404: NotFound.</span>
<span class="c1">// You got an unkown message!</span></code></pre>
</div>
</div>
</li>
<li>
<p>A pattern match includes a sequence of <strong><em>alternatives</em></strong>, each starting with the keyword <code>case</code>.</p>
<div class="paragraph">
<p>Each alternative includes a <strong><em>pattern</em></strong> and one or more expressions, which will be evaluated if the pattern matches.</p>
</div>
<div class="paragraph">
<p>An arrow symbol => separates the pattern from the expressions.</p>
</div>
</li>
<li>
<p>A match expression is evaluated by trying each of the patterns in the order they are written.</p>
<div class="paragraph">
<p>The first pattern that matches is selected, and the part following the arrow is selected and executed.</p>
</div>
<div class="paragraph">
<p>A <strong>constant pattern</strong> like "021-12345" matches values that are equal to the constant with respect to ==.</p>
</div>
<div class="paragraph">
<p>A <strong>variable pattern</strong> like "message", "title"  matches every value. The variable then refers to that value in the right hand side of the case clause.</p>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="kinds-of-patterns">15.1. Kinds of patterns</h3>
<div class="sect3">
<h4 id="wildcard-patterns">15.1.1. Wildcard patterns</h4>
<div class="paragraph">
<p>The wildcard pattern (_) matches any object whatsoever. You have already seen it used as a default, catch-all alternative, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">notification</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">SMS</span><span class="o">(</span><span class="s">"012-12345"</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="n">s</span><span class="s">"You sent an SMS to Mayor Hotline! Message: $message"</span>
  <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="n">s</span><span class="s">"You got an unkown message!"</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="constant-patterns">15.1.2. Constant patterns</h4>
<div class="paragraph">
<p>A <strong>constant</strong> pattern matches only itself. Any <em>literal</em> may be used as a constant. Also, any <em>val</em> or <em>singleton object</em> can be used as a constant.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">describe</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="mi">5</span> <span class="k">=&gt;</span> <span class="s">"five"</span>
  <span class="k">case</span> <span class="kc">true</span> <span class="k">=&gt;</span> <span class="s">"truth"</span>
  <span class="k">case</span> <span class="s">"hello"</span> <span class="k">=&gt;</span> <span class="s">"hi!"</span>
  <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="s">"the empty list"</span>
  <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="s">"something else"</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="variable-patterns">15.1.3. Variable patterns</h4>
<div class="paragraph">
<p>A variable pattern matches any object, just like a wildcard. Unlike a wildcard, Scala binds the variable to whatever the object is. You can then use this variable to act on the object further.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">expr</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="mi">0</span> <span class="k">=&gt;</span> <span class="s">"zero"</span>
  <span class="k">case</span> <span class="n">somethingElse</span> <span class="k">=&gt;</span> <span class="s">"not zero: "</span><span class="o">+</span> <span class="n">somethingElse</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Variable or constant?</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">math.</span><span class="o">{</span><span class="n">E</span><span class="o">,</span> <span class="nc">Pi</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">math.</span><span class="o">{</span><span class="n">E</span><span class="o">,</span> <span class="nc">Pi</span><span class="o">}</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">E</span> <span class="k">match</span> <span class="o">{</span>
     <span class="o">|</span> <span class="k">case</span> <span class="nc">Pi</span> <span class="k">=&gt;</span> <span class="s">"strange match? Pi = "</span> <span class="o">+</span> <span class="nc">Pi</span>
     <span class="o">|</span> <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="s">"OK"</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">OK</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">pi</span> <span class="k">=</span> <span class="nc">Pi</span>
<span class="n">pi</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">3.141592653589793</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">E</span> <span class="k">match</span> <span class="o">{</span>
     <span class="o">|</span> <span class="k">case</span> <span class="n">pi</span> <span class="k">=&gt;</span> <span class="s">"strange math? Pi = "</span> <span class="o">+</span> <span class="n">pi</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">strange</span> <span class="n">math</span><span class="o">?</span> <span class="nc">Pi</span> <span class="k">=</span> <span class="mf">2.718281828459045</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">E</span> <span class="k">match</span> <span class="o">{</span>
     <span class="o">|</span> <span class="k">case</span> <span class="n">pi</span> <span class="k">=&gt;</span> <span class="s">"strange math? Pi = "</span> <span class="o">+</span> <span class="n">pi</span>
     <span class="o">|</span> <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="s">"OK"</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">15</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">patterns</span> <span class="kt">after</span> <span class="kt">a</span> <span class="kt">variable</span> <span class="kt">pattern</span> <span class="kt">cannot</span> <span class="kt">match</span> <span class="o">(</span><span class="kt">SLS</span> <span class="err">8</span><span class="kt">.</span><span class="err">1</span><span class="kt">.</span><span class="err">1</span><span class="o">)</span>
       <span class="kt">case</span> <span class="kt">pi</span> <span class="o">=&gt;</span> <span class="s">"strange math? Pi = "</span> <span class="o">+</span> <span class="n">pi</span>
            <span class="o">^</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">16</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">unreachable</span> <span class="kt">code</span> <span class="kt">due</span> <span class="kt">to</span> <span class="kt">variable</span> <span class="kt">pattern</span> <span class="kt">'pi'</span> <span class="kt">on</span> <span class="kt">line</span> <span class="err">15</span>
       <span class="kt">case</span> <span class="k">_</span> <span class="o">=&gt;</span> <span class="s">"OK"</span>
                 <span class="o">^</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">16</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">unreachable</span> <span class="kt">code</span>
       <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="s">"OK"</span>
                 <span class="o">^</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">strange</span> <span class="n">math</span><span class="o">?</span> <span class="nc">Pi</span> <span class="k">=</span> <span class="mf">2.718281828459045</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// back-tick syntax for identifiers:</span>
<span class="c1">// 1. treat a lowercase identifier as a constant in a pattern match</span>
<span class="c1">// 2. treat a keyword as an ordinary identifier,</span>
<span class="c1">//    e.g., writing Thread.`yield`() treats yield as an identifier rather than a keyword.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">E</span> <span class="k">match</span> <span class="o">{</span>
     <span class="o">|</span> <span class="k">case</span> <span class="n">`pi`</span> <span class="k">=&gt;</span> <span class="s">"strange math? Pi = "</span> <span class="o">+</span> <span class="n">pi</span>
     <span class="o">|</span> <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="s">"OK"</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">OK</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="constructor-patterns">15.1.4. Constructor patterns</h4>
<div class="paragraph">
<p>These extra patterns mean that Scala patterns support <strong>deep matches</strong>. Such patterns not only check the top-level object supplied, but also check the contents of the object against further patterns. Since the extra patterns can themselves be constructor patterns, you can use them to check arbitrarily deep into an object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Geometry</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Geometry</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Line</span><span class="o">(</span><span class="n">p1</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">p2</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Geometry</span>

<span class="k">val</span> <span class="nv">p1</span> <span class="k">=</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">p2</span> <span class="k">=</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">45</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">line</span> <span class="k">=</span> <span class="nc">Line</span><span class="o">(</span><span class="n">p1</span><span class="o">,</span> <span class="n">p2</span><span class="o">)</span>

<span class="k">val</span> <span class="nv">slope</span> <span class="k">=</span> <span class="n">line</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">Line</span><span class="o">(</span><span class="nc">Point</span><span class="o">(</span><span class="n">x1</span><span class="o">,</span> <span class="n">y1</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x2</span><span class="o">,</span> <span class="n">y2</span><span class="o">))</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="o">)</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="o">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="o">)</span>
<span class="o">}</span>

<span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"The slope of line ${line} is ${slope}."</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sequence-patterns">15.1.5. Sequence patterns</h4>
<div class="paragraph">
<p>You can match against sequence types like <code>List</code> or <code>Array</code> just like you match against case classes. Use the same syntax, but now you can specify any number of elements within the pattern.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A sequence pattern with a fixed length.</span>
<span class="n">expr</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="k">_</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nf">println</span><span class="o">(</span><span class="s">"found it"</span><span class="o">)</span>
  <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to match against a sequence without specifying how long it can be, you can specify <code>_*</code> as the last element of the pattern.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A sequence pattern with an arbitrary length.</span>
<span class="n">expr</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="k">_</span><span class="o">*)</span> <span class="k">=&gt;</span> <span class="nf">println</span><span class="o">(</span><span class="s">"found it"</span><span class="o">)</span>
  <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tuple-patterns">15.1.6. Tuple patterns</h4>
<div class="paragraph">
<p>You can match against tuples, too. A pattern like (a, b, c) matches an arbitrary 3-tuple.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">expr</span> <span class="k">match</span> <span class="o">{</span>
  <span class="nf">case</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span>  <span class="k">=&gt;</span>  <span class="nf">println</span><span class="o">(</span><span class="s">"matched "</span><span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="o">)</span>
  <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="typed-patterns">15.1.7. Typed patterns</h4>
<div class="paragraph">
<p>You can use a typed pattern as a convenient replacement for type tests and type casts.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">generalSize</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">s</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=&gt;</span> <span class="nv">s</span><span class="o">.</span><span class="py">length</span>
  <span class="k">case</span> <span class="n">m</span><span class="k">:</span> <span class="kt">Map</span><span class="o">[</span><span class="k">_</span>, <span class="k">_</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nv">m</span><span class="o">.</span><span class="py">size</span>
  <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="o">-</span><span class="mi">1</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An equivalent but more long-winded way that achieves the effect of a match against a typed pattern employs a type test followed by a type cast. Scala uses a different syntax than Java for these. To test whether an expression expr has type String, say, you write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nv">expr</span><span class="o">.</span><span class="py">isInstanceOf</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To cast the same expression to type String, you use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nv">expr</span><span class="o">.</span><span class="py">asInstanceOf</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Using isInstanceOf and asInstanceOf (poor style).</span>
<span class="k">def</span> <span class="nf">generalSize2</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
  <span class="nf">if</span> <span class="o">(</span><span class="nv">x</span><span class="o">.</span><span class="py">isInstanceOf</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">s</span> <span class="k">=</span> <span class="nv">x</span><span class="o">.</span><span class="py">asInstanceOf</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
    <span class="nv">s</span><span class="o">.</span><span class="py">length</span>
  <span class="o">}</span> <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="nv">x</span><span class="o">.</span><span class="py">isInstanceOf</span><span class="o">[</span><span class="kt">Map</span><span class="o">[</span><span class="k">_</span>, <span class="k">_</span><span class="o">]])</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">m</span> <span class="k">=</span> <span class="nv">x</span><span class="o">.</span><span class="py">asInstanceOf</span><span class="o">[</span><span class="kt">Map</span><span class="o">[</span><span class="k">_</span>, <span class="k">_</span><span class="o">]]</span>
    <span class="nv">m</span><span class="o">.</span><span class="py">size</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="o">-</span><span class="mi">1</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Type erasure</strong></p>
<div class="paragraph">
<p>Can you also test for a map with specific element types?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">isIntIntMap</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span> <span class="k">match</span> <span class="o">{</span>
     <span class="o">|</span> <span class="k">case</span> <span class="n">m</span><span class="k">:</span> <span class="kt">Map</span><span class="o">[</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="kc">true</span>
     <span class="o">|</span> <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="kc">false</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">12</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">non-variable</span> <span class="k">type</span> <span class="kt">argument</span> <span class="kt">Int</span> <span class="kt">in</span> <span class="k">type</span> <span class="kt">pattern</span>  <span class="kt">\</span>
<span class="kt">scala.collection.immutable.Map</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">Int</span><span class="o">]</span> <span class="o">(</span><span class="n">the</span> <span class="n">underlying</span> <span class="n">of</span> <span class="nc">Map</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">Int</span><span class="o">])</span> <span class="n">is</span> <span class="n">unchecked</span> <span class="o">\</span>
<span class="n">since</span> <span class="n">it</span> <span class="n">is</span> <span class="n">eliminated</span> <span class="n">by</span> <span class="n">erasure</span>
       <span class="k">case</span> <span class="n">m</span><span class="k">:</span> <span class="kt">Map</span><span class="o">[</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="kc">true</span>
               <span class="o">^</span>
<span class="n">isIntIntMap</span><span class="k">:</span> <span class="o">(</span><span class="kt">x:</span> <span class="kt">Any</span><span class="o">)</span><span class="kt">Boolean</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Scala uses the erasure model of generics, just like Java does.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This means that no information about type arguments is maintained at runtime.</p>
</li>
<li>
<p>Consequently, there is no way to determine at runtime whether a given Map object has been created with two Int arguments, rather than with arguments of different types.</p>
<div class="paragraph">
<p>All the system can do is determine that a value is a Map of some arbitrary type parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nf">isIntIntMap</span><span class="o">(</span><span class="nc">Map</span><span class="o">(</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">))</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">isIntIntMap</span><span class="o">(</span><span class="nc">Map</span><span class="o">(</span><span class="s">"abc"</span> <span class="o">-&gt;</span> <span class="s">"abc"</span><span class="o">))</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The only exception to the erasure rule is arrays, because they are handled specially in Java as well as in Scala. The element type of an array is stored with the array value, so you can pattern match on it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">isStringArray</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span> <span class="k">match</span> <span class="o">{</span>
     <span class="o">|</span> <span class="k">case</span> <span class="n">a</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="s">"yes"</span>
     <span class="o">|</span> <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="s">"no"</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">isStringArray</span><span class="k">:</span> <span class="o">(</span><span class="kt">x:</span> <span class="kt">Any</span><span class="o">)</span><span class="kt">String</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">as</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"abc"</span><span class="o">)</span>
<span class="n">as</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="n">abc</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">isStringArray</span><span class="o">(</span><span class="n">as</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">yes</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">ai</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
<span class="n">ai</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">isStringArray</span><span class="o">(</span><span class="n">ai</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">no</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="variable-binding">15.1.8. Variable binding</h4>
<div class="paragraph">
<p>In addition to the standalone variable patterns, you can also add a variable to any other pattern.</p>
</div>
<div class="paragraph">
<p>You simply write the variable name, an at sign (<code>@</code>), and then the pattern.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This gives you a variable-binding pattern.</p>
</li>
<li>
<p>The meaning of such a pattern is to perform the pattern match as normal, and if the pattern succeeds, set the variable to the matched object just as with a simple variable pattern.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// a pattern with a variable binding (via the @ sign).</span>
<span class="n">expr</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">UnOp</span><span class="o">(</span><span class="s">"abs"</span><span class="o">,</span> <span class="n">e</span> <span class="k">@</span> <span class="nc">UnOp</span><span class="o">(</span><span class="s">"abs"</span><span class="o">,</span> <span class="k">_</span><span class="o">))</span> <span class="k">=&gt;</span> <span class="n">e</span>
  <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pattern-guards">15.2. Pattern guards</h3>
<div class="paragraph">
<p>A <strong>pattern guard</strong> comes after a pattern and starts with an <code>if</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The guard can be an arbitrary boolean expression, which typically refers to variables in the pattern.* If a pattern guard is present, the match succeeds only if the guard evaluates to true.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// match only positive integers</span>
<span class="k">case</span> <span class="n">n</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">if</span> <span class="err">0</span> <span class="kt">&lt;</span> <span class="kt">n</span> <span class="o">=&gt;</span> <span class="o">...</span>

<span class="c1">// match only strings starting with the letter ‘a’</span>
<span class="k">case</span> <span class="n">s</span><span class="k">:</span> <span class="kt">String</span> <span class="kt">if</span> <span class="kt">s</span><span class="o">(</span><span class="err">0</span><span class="o">)</span> <span class="o">=</span><span class="k">=</span> <span class="sc">'a'</span> <span class="k">=&gt;</span> <span class="o">...</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sealed-classes">15.3. Sealed classes</h3>
<div class="paragraph">
<p>A <strong>sealed class</strong> cannot have any new subclasses added except the ones in the same file.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This is very useful for pattern matching, because it means you only need to worry about the subclasses you already know about.</p>
</li>
<li>
<p>What’s more, you get better compiler support as well.</p>
<div class="ulist">
<ul>
<li>
<p>If you match against case classes that inherit from a sealed class, the compiler will flag missing combinations of patterns with a warning message.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Therefore, if you write a hierarchy of classes intended to be pattern matched, you should consider sealing them. Simply put the sealed keyword in front of the class at the top of the hierarchy.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// source: Notification.scala</span>
<span class="k">sealed</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Notification</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">SMS</span><span class="o">(</span><span class="n">caller</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">message</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Notification</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Email</span><span class="o">(</span><span class="n">sender</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">title</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">body</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Notification</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">VoiceRecording</span><span class="o">(</span><span class="n">contactName</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">link</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Notification</span>

<span class="k">def</span> <span class="nf">showNotification</span><span class="o">(</span><span class="n">notification</span><span class="k">:</span> <span class="kt">Notification</span><span class="o">)</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span>
  <span class="c1">// warning: match may not be exhaustive.</span>
  <span class="c1">// It would fail on the following input: VoiceRecording(_, _)</span>
  <span class="c1">//   notification match {</span>
  <span class="c1">//   ^</span>
  <span class="c1">// one warning found</span>
  <span class="n">notification</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">SMS</span><span class="o">(</span><span class="s">"012-12345"</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="n">s</span><span class="s">"You sent an SMS to Mayor Hotline! Message: $message"</span>
    <span class="k">case</span> <span class="nc">Email</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">title</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="n">s</span><span class="s">"You got an email from $sender with title: $title"</span>
    <span class="c1">// case _ =&gt; s"You got an unkown message!" // "catch all" case.</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-option-type">15.4. The Option type</h3>
<div class="paragraph">
<p>Scala has a standard type named <code>Option</code> for optional values. Such a value can be of two forms.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It can be of the form <code>Some(x)</code> where <code>x</code> is the actual value.</p>
</li>
<li>
<p>Or it can be the <code>None</code> object, which represents a missing value.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">capitals</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="s">"Japan"</span> <span class="o">-&gt;</span> <span class="s">"Tokyo"</span><span class="o">,</span> <span class="s">"West Korea"</span> <span class="o">-&gt;</span> <span class="s">"평양"</span><span class="o">)</span>
<span class="n">capitals</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Map</span><span class="o">[</span><span class="kt">String</span>,<span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="nc">Japan</span> <span class="o">-&gt;</span> <span class="nc">Tokyo</span><span class="o">,</span> <span class="nc">West</span> <span class="nc">Korea</span> <span class="o">-&gt;</span> <span class="n">평양</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">capitals</span><span class="o">.</span><span class="py">get</span><span class="o">(</span><span class="s">"West Korea"</span><span class="o">)</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="n">평양</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">capitals</span><span class="o">(</span><span class="s">"West Korea"</span><span class="o">)</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">평양</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">capitals</span><span class="o">.</span><span class="py">get</span><span class="o">(</span><span class="s">"PRC."</span><span class="o">)</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">capitals</span><span class="o">(</span><span class="s">"PRC."</span><span class="o">)</span>
<span class="nv">java</span><span class="o">.</span><span class="py">util</span><span class="o">.</span><span class="py">NoSuchElementException</span><span class="k">:</span> <span class="kt">key</span> <span class="kt">not</span> <span class="kt">found:</span> <span class="kt">PRC.</span>
  <span class="kt">at</span> <span class="kt">scala.collection.immutable.Map$Map2.apply</span><span class="o">(</span><span class="kt">Map.scala:</span><span class="err">227</span><span class="o">)</span>
  <span class="kt">...</span> <span class="err">28</span> <span class="kt">elided</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="patterns-everywhere">15.5. Patterns everywhere</h3>
<div class="paragraph">
<p>Patterns are allowed in many parts of Scala, not just in standalone <code>match</code> expressions.</p>
</div>
<div class="sect3">
<h4 id="patterns-in-variable-definitions">15.5.1. Patterns in variable definitions</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">myTuple</span> <span class="k">=</span> <span class="o">(</span><span class="s">"12345"</span><span class="o">,</span> <span class="s">"Mayor Hotline"</span><span class="o">)</span>
<span class="n">myTuple</span><span class="k">:</span> <span class="o">(</span><span class="kt">String</span><span class="o">,</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="mi">12345</span><span class="o">,</span><span class="nc">Mayor</span> <span class="nc">Hotline</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">val</span> <span class="o">(</span><span class="n">number</span><span class="o">,</span> <span class="n">string</span><span class="o">)</span> <span class="k">=</span> <span class="n">myTuple</span>
<span class="n">number</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">string</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">Mayor</span> <span class="nc">Hotline</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>
<span class="n">defined</span> <span class="k">class</span> <span class="nc">Point</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">p</span> <span class="k">=</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">12</span><span class="o">,</span> <span class="mi">345</span><span class="o">)</span>
<span class="n">p</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">12</span><span class="o">,</span><span class="mi">345</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">Point</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">=</span> <span class="n">p</span>
<span class="n">x</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">y</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">345</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Line</span><span class="o">(</span><span class="n">p1</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">p2</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span>
<span class="n">defined</span> <span class="k">class</span> <span class="nc">Line</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">myLine</span> <span class="k">=</span> <span class="nc">Line</span><span class="o">(</span><span class="nc">Point</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">45</span><span class="o">))</span>
<span class="n">myLine</span><span class="k">:</span> <span class="kt">Line</span> <span class="o">=</span> <span class="nc">Line</span><span class="o">(</span><span class="nc">Point</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span><span class="nc">Point</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">45</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">Line</span><span class="o">(</span><span class="nc">Point</span><span class="o">(</span><span class="n">x1</span><span class="o">,</span> <span class="n">y1</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x2</span><span class="o">,</span> <span class="n">y2</span><span class="o">))</span> <span class="k">=</span> <span class="n">myLine</span>
<span class="n">x1</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">y1</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">x2</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">y2</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">45</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="case-sequences-as-partial-functions">15.5.2. Case sequences as partial functions</h4>
<div class="paragraph">
<p>A sequence of cases (i.e., alternatives) in curly braces can be used anywhere a function literal can be used.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Essentially, a case sequence is a function literal, only more general.</p>
</li>
<li>
<p>Instead of having a single entry point and list of parameters, a case sequence has multiple entry points, each with their own list of parameters.</p>
</li>
<li>
<p>Each case is an entry point to the function, and the parameters are specified with the pattern.</p>
</li>
<li>
<p>The body of each entry point is the right-hand side of the case.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Option[Int] =&gt; Int</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">withDefault</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="o">{</span>
     <span class="o">|</span> <span class="k">case</span> <span class="nc">Some</span><span class="o">(</span><span class="n">x</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span>
     <span class="o">|</span> <span class="k">case</span> <span class="nc">None</span> <span class="k">=&gt;</span> <span class="mi">0</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">withDefault</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1658</span><span class="o">/</span><span class="mh">0x0000000801246000</span><span class="k">@</span><span class="mi">24</span><span class="n">c7f52b</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">withDefault</span><span class="o">(</span><span class="nc">Some</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">withDefault</span><span class="o">(</span><span class="nc">None</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>One other generalization is worth noting: a sequence of cases gives you a partial function. If you apply such a function on a value it does not support, it will generate a runtime exception.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">second</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="o">{</span>
     <span class="o">|</span> <span class="k">case</span> <span class="n">x</span> <span class="o">::</span> <span class="n">y</span> <span class="o">::</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="n">y</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">11</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">match</span> <span class="kt">may</span> <span class="kt">not</span> <span class="kt">be</span> <span class="kt">exhaustive.</span>
<span class="kt">It</span> <span class="kt">would</span> <span class="kt">fail</span> <span class="kt">on</span> <span class="kt">the</span> <span class="kt">following</span> <span class="kt">inputs:</span> <span class="kt">List</span><span class="o">(</span><span class="k">_</span><span class="o">),</span> <span class="nc">Nil</span>
       <span class="k">val</span> <span class="nv">second</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="o">{</span>
                                      <span class="o">^</span>
<span class="n">second</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="nc">$Lambda$1684</span><span class="o">/</span><span class="mh">0x0000000801248000</span><span class="k">@</span><span class="mi">1</span><span class="n">e65f2d9</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">second</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">12</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">45</span><span class="o">))</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">second</span><span class="o">(</span><span class="nc">List</span><span class="o">())</span>
<span class="nv">scala</span><span class="o">.</span><span class="py">MatchError</span><span class="k">:</span> <span class="kt">List</span><span class="o">()</span> <span class="o">(</span><span class="kt">of</span> <span class="kt">class</span> <span class="kt">scala.collection.immutable.Nil$</span><span class="o">)</span>
  <span class="kt">at</span> <span class="kt">.$anonfun$second$1</span><span class="o">(</span><span class="kt">&lt;console</span><span class="k">&gt;:</span><span class="err">11</span><span class="o">)</span>
  <span class="kt">at</span> <span class="kt">.$anonfun$second$1$adapted</span><span class="o">(</span><span class="kt">&lt;console</span><span class="k">&gt;:</span><span class="err">11</span><span class="o">)</span>
  <span class="kt">...</span> <span class="err">28</span> <span class="kt">elided</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is the second function again, this time written with a <strong>partial function</strong> type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">second</span><span class="k">:</span> <span class="kt">PartialFunction</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
     <span class="o">|</span> <span class="k">case</span> <span class="n">x</span> <span class="o">::</span> <span class="n">y</span> <span class="o">::</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="n">y</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">second</span><span class="k">:</span> <span class="kt">PartialFunction</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span>,<span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="n">function1</span><span class="o">&gt;</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">second</span><span class="o">.</span><span class="py">isDefinedAt</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">12</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">45</span><span class="o">))</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">second</span><span class="o">.</span><span class="py">isDefinedAt</span><span class="o">(</span><span class="nc">List</span><span class="o">())</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="patterns-in-for-expressions">15.5.3. Patterns in for expressions</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">capitals</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="s">"Japan"</span> <span class="o">-&gt;</span> <span class="s">"Tokyo"</span><span class="o">,</span> <span class="s">"West Korea"</span> <span class="o">-&gt;</span> <span class="s">"평양"</span><span class="o">)</span>
<span class="n">capitals</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Map</span><span class="o">[</span><span class="kt">String</span>,<span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="nc">Japan</span> <span class="o">-&gt;</span> <span class="nc">Tokyo</span><span class="o">,</span> <span class="nc">West</span> <span class="nc">Korea</span> <span class="o">-&gt;</span> <span class="n">평양</span><span class="o">)</span>

<span class="c1">// capitals yields a sequence of pairs, so you</span>
<span class="c1">// can be sure that every generated pair can be</span>
<span class="c1">//  matched against a pair pattern.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">for</span> <span class="o">((</span><span class="n">country</span><span class="o">,</span> <span class="n">city</span><span class="o">)</span> <span class="k">&lt;-</span> <span class="n">capitals</span><span class="o">)</span>
     <span class="o">|</span> <span class="nf">println</span><span class="o">(</span><span class="s">"The capital of "</span><span class="o">+</span> <span class="n">country</span> <span class="o">+</span><span class="s">" is "</span><span class="o">+</span> <span class="n">city</span><span class="o">)</span>
<span class="nc">The</span> <span class="n">capital</span> <span class="n">of</span> <span class="nc">Japan</span> <span class="n">is</span> <span class="nc">Tokyo</span>
<span class="nc">The</span> <span class="n">capital</span> <span class="n">of</span> <span class="nc">West</span> <span class="nc">Korea</span> <span class="n">is</span> <span class="n">평양</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">results</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">Some</span><span class="o">(</span><span class="s">"apple"</span><span class="o">),</span> <span class="nc">None</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="s">"orange"</span><span class="o">))</span>
<span class="n">results</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">Some</span><span class="o">(</span><span class="n">apple</span><span class="o">),</span> <span class="nc">None</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="n">orange</span><span class="o">))</span>

<span class="c1">// a pattern possiable might not match a generated value.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">for</span> <span class="o">(</span><span class="nc">Some</span><span class="o">(</span><span class="n">fruit</span><span class="o">)</span> <span class="k">&lt;-</span> <span class="n">results</span><span class="o">)</span> <span class="nf">println</span><span class="o">(</span><span class="n">fruit</span><span class="o">)</span>
<span class="n">apple</span>
<span class="n">orange</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="working-with-lists">16. Working with Lists</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Lists are quite similar to arrays, but there are two important differences.</span>
<span class="c1">//</span>
<span class="c1">// First, lists are immutable.</span>
<span class="c1">//   That is, elements of a list cannot be changed by assignment.</span>
<span class="c1">// Second, lists have a recursive structure (i.e., a linked list), whereas arrays are flat.</span>
<span class="k">val</span> <span class="nv">fruit</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"apples"</span><span class="o">,</span> <span class="s">"oranges"</span><span class="o">,</span> <span class="s">"pears"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">nums</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">diag3</span> <span class="k">=</span>
  <span class="nc">List</span><span class="o">(</span>
    <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">),</span>
    <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">),</span>
    <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">)</span>
<span class="k">val</span> <span class="nv">empty</span> <span class="k">=</span> <span class="nc">List</span><span class="o">()</span> <span class="c1">// Nil</span>

<span class="c1">// Like arrays, lists are homogeneous: the elements of a list all have the same type.</span>
<span class="c1">// The type of a list that has elements of type T is written `List[T]`.</span>
<span class="k">val</span> <span class="nv">fruit</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"apples"</span><span class="o">,</span> <span class="s">"oranges"</span><span class="o">,</span> <span class="s">"pears"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">nums</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">empty</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Nothing</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">()</span>

<span class="c1">// The list type in Scala is covariant.</span>
<span class="c1">// This means that for each pair of types `S` and `T`, if `S` is a subtype of `T`,</span>
<span class="c1">//   then `List[S]` is a subtype of `List[T]`.</span>
<span class="c1">// For instance, `List[String]` is a subtype of `List[Object]`.</span>
<span class="c1">//   This is natural because every list of strings can also be seen as a list of objects.</span>
<span class="c1">// So the empty list object, which has type `List[Nothing]`, can also be seen as an object</span>
<span class="c1">//   of every other list type of the form `List[T]`.</span>
<span class="c1">//</span>
<span class="c1">// `List()` is also of type `List[String]`!</span>
<span class="k">val</span> <span class="nv">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">()</span>

<span class="c1">// All lists are built from two fundamental building blocks, `Nil` and `::` (pronounced “cons”).</span>
<span class="c1">// Nil represents the empty list.</span>
<span class="c1">// The infix operator, `::`, expresses list extension at the front.</span>
<span class="c1">// That is, `x :: xs` represents a list whose first element is `x`, followed</span>
<span class="c1">//   by (the elements of) list `xs`.</span>
<span class="k">val</span> <span class="nv">fruit</span> <span class="k">=</span> <span class="s">"apples"</span> <span class="o">::</span> <span class="o">(</span><span class="s">"oranges"</span> <span class="o">::</span> <span class="o">(</span><span class="s">"pears"</span> <span class="o">::</span> <span class="nc">Nil</span><span class="o">))</span>
<span class="k">val</span> <span class="nv">nums</span> <span class="k">=</span> <span class="mi">1</span><span class="o">::(</span><span class="mi">2</span><span class="o">::(</span><span class="mi">3</span><span class="o">::(</span><span class="mi">4</span><span class="o">::</span><span class="nc">Nil</span><span class="o">)))</span>
<span class="k">val</span> <span class="nv">diag3</span> <span class="k">=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">::</span> <span class="o">(</span><span class="mi">0</span> <span class="o">::</span> <span class="o">(</span><span class="mi">0</span> <span class="o">::</span> <span class="nc">Nil</span><span class="o">)))</span> <span class="o">::</span>
            <span class="o">(</span><span class="mi">0</span> <span class="o">::</span> <span class="o">(</span><span class="mi">1</span> <span class="o">::</span> <span class="o">(</span><span class="mi">0</span> <span class="o">::</span> <span class="nc">Nil</span><span class="o">)))</span> <span class="o">::</span>
            <span class="o">(</span><span class="mi">0</span> <span class="o">::</span> <span class="o">(</span><span class="mi">0</span> <span class="o">::</span> <span class="o">(</span><span class="mi">1</span> <span class="o">::</span> <span class="nc">Nil</span><span class="o">)))</span> <span class="o">::</span> <span class="nc">Nil</span>
<span class="k">val</span> <span class="nv">empty</span> <span class="k">=</span> <span class="nc">Nil</span>

<span class="c1">// Because it ends in a colon, the `::` operation associates to the right:</span>
<span class="c1">//   `A :: B :: C` is interpreted as A :: (B :: C).</span>
<span class="c1">// Therefore, you can drop the parentheses in the previous definitions. For instance:</span>
<span class="k">val</span> <span class="nv">nums</span> <span class="k">=</span> <span class="mi">1</span> <span class="o">::</span> <span class="mi">2</span> <span class="o">::</span> <span class="mi">3</span> <span class="o">::</span> <span class="mi">4</span> <span class="o">::</span> <span class="nc">Nil</span>
<span class="c1">// is equivalent to the previous definition of nums.</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// insertion sort</span>
<span class="k">def</span> <span class="nf">isort</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="nv">xs</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span> <span class="nc">Nil</span>
  <span class="k">else</span> <span class="nf">insert</span><span class="o">(</span><span class="nv">xs</span><span class="o">.</span><span class="py">head</span><span class="o">,</span> <span class="nf">isort</span><span class="o">(</span><span class="nv">xs</span><span class="o">.</span><span class="py">tail</span><span class="o">))</span>

<span class="k">def</span> <span class="nf">insert</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="nv">xs</span><span class="o">.</span><span class="py">isEmpty</span> <span class="o">||</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nv">xs</span><span class="o">.</span><span class="py">head</span><span class="o">)</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs</span>
  <span class="k">else</span> <span class="nv">xs</span><span class="o">.</span><span class="py">head</span> <span class="o">::</span> <span class="nf">insert</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="nv">xs</span><span class="o">.</span><span class="py">tail</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">hotline</span> <span class="k">=</span> <span class="nf">isort</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">)).</span><span class="py">mkString</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
<span class="n">hotline</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="mi">12345</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="list-patterns">16.1. List patterns</h3>
<div class="paragraph">
<p>Lists can also be taken apart using <strong>pattern matching</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>List patterns correspond one-by-one to list expressions.</p>
</li>
<li>
<p>You can either match on all elements of a list using a pattern of the form List(&#8230;&#8203;),</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span> <span class="k">=</span> <span class="n">fruit</span>
<span class="n">a</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">apples</span>
<span class="n">b</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">oranges</span>
<span class="n">c</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">pears</span></code></pre>
</div>
</div>
</li>
<li>
<p>or you take lists apart bit by bit using patterns composed from the :: operator and the Nil constant.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">a</span> <span class="o">::</span> <span class="n">b</span> <span class="o">::</span> <span class="n">rest</span> <span class="k">=</span> <span class="n">fruit</span>
<span class="n">a</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">apples</span>
<span class="n">b</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">oranges</span>
<span class="n">rest</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">pears</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// insertion sort using pattern matching</span>
<span class="k">def</span> <span class="nf">isort</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="nc">Nil</span>
  <span class="k">case</span> <span class="n">x</span> <span class="o">::</span> <span class="n">rs</span> <span class="k">=&gt;</span> <span class="nf">insert</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="nf">isort</span><span class="o">(</span><span class="n">rs</span><span class="o">))</span>
<span class="o">}</span>

<span class="k">def</span> <span class="nf">insert</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">::</span> <span class="nc">Nil</span>
  <span class="k">case</span> <span class="n">y</span> <span class="o">::</span> <span class="n">ys</span> <span class="k">=&gt;</span> <span class="nf">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="o">)</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs</span>
                  <span class="k">else</span> <span class="n">y</span> <span class="o">::</span> <span class="nf">insert</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">ys</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="first-order-methods-on-class-list">16.2. First-order methods on class List</h3>
<div class="paragraph">
<p>A method is first-order if it does not take any functions as arguments.</p>
</div>
<div class="sect3">
<h4 id="concatenating-two-lists">16.2.1. Concatenating two lists</h4>
<div class="paragraph">
<p>An operation similar to <code>::</code> is list concatenation, written <code>:::</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unlike <code>::</code>, <code>:::</code> takes two lists as operands.</p>
</li>
<li>
<p>The result of <code>xs<code>:::</code>ys</code> is a new list that contains all the elements of <code>xs</code>, followed by all the elements of <code>ys</code>.</p>
</li>
<li>
<p>Like cons, list concatenation associates to the right.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">::</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">::</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">::</span> <span class="nc">Nil</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">::</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">::</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="mi">3</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">:::</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">:::</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">:::</span> <span class="o">(</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">:::</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The Divide and Conquer principle</span>
<span class="c1">//</span>
<span class="c1">// Concatenation (:::) is implemented as a method in class List.</span>
<span class="c1">// It would also be possible to implement concatenation "by hand",</span>
<span class="c1">//   using pattern matching on lists.</span>
<span class="c1">//</span>
<span class="c1">// def append[T](xs: List[T], xy: List[T]): List[T]</span>
<span class="c1">//</span>
<span class="c1">// To design the implementation of append, it pays to remember</span>
<span class="c1">//   the "divide and conquer" design principle for programs</span>
<span class="c1">//   over recursive data structures such as lists.</span>
<span class="c1">//</span>
<span class="c1">// Many algorithms over lists first split an input list into simpler cases</span>
<span class="c1">//   using a pattern match.</span>
<span class="c1">//   That's the *divide* part of the principle.</span>
<span class="c1">// They then construct a result for each case.</span>
<span class="c1">//   If the result is a non-empty list, some of its parts may be constructed</span>
<span class="c1">//   by recursive invocations of the same algorithm.</span>
<span class="c1">//   That's the *conquer* part of the principle.</span>

<span class="k">def</span> <span class="nf">append</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span> <span class="n">xy</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">List</span><span class="o">()</span> <span class="k">=&gt;</span> <span class="n">xy</span>
  <span class="k">case</span> <span class="n">x</span> <span class="o">::</span>  <span class="n">xs1</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">::</span> <span class="nf">append</span><span class="o">(</span><span class="n">xs1</span><span class="o">,</span> <span class="n">xy</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="taking-the-length-of-a-list-length">16.2.2. Taking the length of a list: <code>length</code></h4>
<div class="paragraph">
<p>The <code>length</code> method computes the length of a list.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On lists, unlike arrays, length is a relatively expensive operation.</p>
</li>
<li>
<p>It needs to traverse the whole list to find its end and therefore takes time proportional to the number of elements in the list.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">).</span><span class="py">length</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">3</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="accessing-the-end-of-a-list-init-and-last">16.2.3. Accessing the end of a list: <code>init</code> and <code>last</code></h4>
<div class="paragraph">
<p>Unlike <code>head</code> and <code>tail</code>, which both run in constant time, <code>init</code> and <code>last</code> need to traverse the whole list to compute their result. They therefore take time proportional to the length of the list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">abcde</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="sc">'a'</span><span class="o">,</span> <span class="sc">'b'</span><span class="o">,</span> <span class="sc">'c'</span><span class="o">,</span> <span class="sc">'d'</span><span class="o">,</span> <span class="sc">'e'</span><span class="o">)</span>
<span class="n">abcde</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">last</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Char</span> <span class="o">=</span> <span class="n">e</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">init</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">().</span><span class="py">init</span>
<span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">UnsupportedOperationException</span><span class="k">:</span> <span class="kt">empty.init</span>
  <span class="n">at</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">TraversableLike</span><span class="o">.</span><span class="py">init</span><span class="o">(</span><span class="nv">TraversableLike</span><span class="o">.</span><span class="py">scala</span><span class="k">:</span><span class="err">647</span><span class="o">)</span>
  <span class="n">at</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">TraversableLike</span><span class="o">.</span><span class="py">init$</span><span class="o">(</span><span class="nv">TraversableLike</span><span class="o">.</span><span class="py">scala</span><span class="k">:</span><span class="err">646</span><span class="o">)</span>
  <span class="n">at</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">AbstractTraversable</span><span class="o">.</span><span class="py">init</span><span class="o">(</span><span class="nv">Traversable</span><span class="o">.</span><span class="py">scala</span><span class="k">:</span><span class="err">108</span><span class="o">)</span>
  <span class="o">...</span> <span class="mi">28</span> <span class="n">elided</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">().</span><span class="py">last</span>
<span class="nv">java</span><span class="o">.</span><span class="py">util</span><span class="o">.</span><span class="py">NoSuchElementException</span>
  <span class="n">at</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">LinearSeqOptimized</span><span class="o">.</span><span class="py">last</span><span class="o">(</span><span class="nv">LinearSeqOptimized</span><span class="o">.</span><span class="py">scala</span><span class="k">:</span><span class="err">150</span><span class="o">)</span>
  <span class="n">at</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">LinearSeqOptimized</span><span class="o">.</span><span class="py">last$</span><span class="o">(</span><span class="nv">LinearSeqOptimized</span><span class="o">.</span><span class="py">scala</span><span class="k">:</span><span class="err">149</span><span class="o">)</span>
  <span class="n">at</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">immutable</span><span class="o">.</span><span class="py">List</span><span class="o">.</span><span class="py">last</span><span class="o">(</span><span class="nv">List</span><span class="o">.</span><span class="py">scala</span><span class="k">:</span><span class="err">91</span><span class="o">)</span>
  <span class="o">...</span> <span class="mi">28</span> <span class="n">elided</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="reversing-lists-reverse">16.2.4. Reversing lists: <code>reverse</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">reverse</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span><span class="o">)</span>

<span class="c1">// reverse using concatenation(:::):</span>
<span class="c1">// the total complexity of rev is:</span>
<span class="c1">//   n + (n − 1) + ... + 1 = (1 + n) ∗ n / 2</span>
<span class="k">def</span> <span class="nf">rev</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">List</span><span class="o">()</span> <span class="k">=&gt;</span> <span class="n">xs</span>
  <span class="k">case</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs1</span> <span class="k">=&gt;</span> <span class="nf">rev</span><span class="o">(</span><span class="n">xs1</span><span class="o">)</span> <span class="o">:::</span> <span class="nc">List</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="prefixes-and-suffixes-drop-take-and-splitat">16.2.5. Prefixes and suffixes: <code>drop</code>, <code>take</code>, and <code>splitAt</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// equals: List(abcde.head)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">take</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="n">res15</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">take</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
<span class="n">res17</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span>

<span class="c1">// equals: abcde.tail</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">drop</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="n">res18</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">)</span>

<span class="c1">// equals: List(abcde.take(2), abcde.drop(2))</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">splitAt</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
<span class="n">res21</span><span class="k">:</span> <span class="o">(</span><span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">],</span> <span class="nc">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">))</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="element-selection-apply-and-indices">16.2.6. Element selection: <code>apply</code> and <code>indices</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="c1">// rare in Scala</span>
<span class="n">res31</span><span class="k">:</span> <span class="kt">Char</span> <span class="o">=</span> <span class="n">c</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">abcde</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>       <span class="c1">// rare in Scala</span>
<span class="n">res32</span><span class="k">:</span> <span class="kt">Char</span> <span class="o">=</span> <span class="n">c</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">indices</span>
<span class="n">res33</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Range</span> <span class="o">=</span> <span class="nc">Range</span> <span class="mi">0</span> <span class="n">until</span> <span class="mi">5</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="flattening-a-list-of-lists-flatten">16.2.7. Flattening a list of lists: <code>flatten</code></h4>
<div class="paragraph">
<p>The <code>flatten</code> method takes a list of lists and flattens it out to a single list:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">),</span> <span class="nc">List</span><span class="o">(),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)).</span><span class="py">flatten</span>
<span class="n">res14</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">fruit</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">toCharArray</span><span class="o">).</span><span class="py">flatten</span>
<span class="n">res15</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">p</span><span class="o">,</span> <span class="n">p</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">e</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">o</span><span class="o">,</span> <span class="n">r</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">n</span><span class="o">,</span> <span class="n">g</span><span class="o">,</span> <span class="n">e</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">p</span><span class="o">,</span> <span class="n">e</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">r</span><span class="o">,</span> <span class="n">s</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="zipping-lists-zip-and-unzip">16.2.8. Zipping lists: <code>zip</code> and <code>unzip</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The `zip` operation takes two lists and forms a list of pairs:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">indices</span> <span class="n">zip</span> <span class="n">abcde</span>
<span class="n">res34</span><span class="k">:</span> <span class="kt">scala.collection.immutable.IndexedSeq</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Char</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">((</span><span class="mi">0</span><span class="o">,</span><span class="n">a</span><span class="o">),</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="n">b</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="n">c</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="n">d</span><span class="o">),</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="n">e</span><span class="o">))</span>

<span class="c1">// If the two lists are of different length, any unmatched elements are dropped:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">zipped</span> <span class="k">=</span> <span class="n">abcde</span> <span class="n">zip</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">zipped</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">Char</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="n">a</span><span class="o">,</span><span class="mi">1</span><span class="o">),</span> <span class="o">(</span><span class="n">b</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span> <span class="o">(</span><span class="n">c</span><span class="o">,</span><span class="mi">3</span><span class="o">))</span>

<span class="c1">// A useful special case is to zip a list with its index.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">zipWithIndex</span>
<span class="n">res18</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">Char</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="n">a</span><span class="o">,</span><span class="mi">0</span><span class="o">),</span> <span class="o">(</span><span class="n">b</span><span class="o">,</span><span class="mi">1</span><span class="o">),</span> <span class="o">(</span><span class="n">c</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span> <span class="o">(</span><span class="n">d</span><span class="o">,</span><span class="mi">3</span><span class="o">),</span> <span class="o">(</span><span class="n">e</span><span class="o">,</span><span class="mi">4</span><span class="o">))</span>

<span class="c1">// Any list of tuples can also be changed back to a tuple of lists by using the `unzip` method:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">zipWithIndex</span><span class="o">.</span><span class="py">unzip</span>
<span class="n">res38</span><span class="k">:</span> <span class="o">(</span><span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">],</span> <span class="nc">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">))</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="displaying-lists-tostring-and-mkstring">16.2.9. Displaying lists: <code>toString</code> and <code>mkString</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">toString</span>
<span class="n">res20</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">abcde</span> <span class="nf">mkString</span> <span class="o">(</span><span class="s">"["</span><span class="o">,</span> <span class="s">","</span><span class="o">,</span> <span class="s">"]"</span><span class="o">)</span>
<span class="n">res21</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">[</span><span class="kt">a</span>,<span class="kt">b</span>,<span class="kt">c</span>,<span class="kt">d</span>,<span class="kt">e</span><span class="o">]</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">abcde</span> <span class="n">mkString</span> <span class="s">""</span>
<span class="n">res22</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">abcde</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">mkString</span>
<span class="n">res23</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">abcde</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">abcde</span> <span class="nf">mkString</span> <span class="o">(</span><span class="s">"List("</span><span class="o">,</span> <span class="s">", "</span><span class="o">,</span> <span class="s">")"</span><span class="o">)</span>
<span class="n">res24</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">)</span>

<span class="c1">// There are also variants of the `mkString` methods called `addString` which append</span>
<span class="c1">//   the constructed string to a `scala.StringBuilder` object, rather than returning</span>
<span class="c1">//   them as a result:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">buf</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span>
<span class="n">buf</span><span class="k">:</span> <span class="kt">StringBuilder</span> <span class="o">=</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">abcde</span> <span class="nf">addString</span> <span class="o">(</span><span class="n">buf</span><span class="o">,</span> <span class="s">"("</span><span class="o">,</span> <span class="s">";"</span><span class="o">,</span> <span class="s">")"</span><span class="o">)</span>
<span class="n">res42</span><span class="k">:</span> <span class="kt">StringBuilder</span> <span class="o">=</span> <span class="o">(</span><span class="n">a</span><span class="o">;</span><span class="n">b</span><span class="o">;</span><span class="n">c</span><span class="o">;</span><span class="n">d</span><span class="o">;</span><span class="n">e</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="converting-lists-iterator-toarray-copytoarray">16.2.10. Converting lists: <code>iterator</code>, <code>toArray</code>, <code>copyToArray</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// To convert data between the flat world of arrays and the recursive world of</span>
<span class="c1">//   lists, you can use method `toArray` in class List and `toList` in class Array:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">arr</span> <span class="k">=</span> <span class="nv">abcde</span><span class="o">.</span><span class="py">toArray</span>
<span class="n">arr</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">arr</span><span class="o">.</span><span class="py">toList</span>
<span class="n">res43</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">)</span>

<span class="c1">// There's also a method `copyToArray`, which copies list elements to successive array</span>
<span class="c1">//   positions within some destination array.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">arr2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="mi">10</span><span class="o">)</span>
<span class="n">arr2</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">copyToArray</span><span class="o">(</span><span class="n">arr2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">arr2</span>
<span class="n">res47</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">copyToArray</span><span class="o">(</span><span class="n">arr2</span><span class="o">,</span> <span class="mi">8</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">arr2</span>
<span class="n">res49</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>

<span class="c1">// Finally, if you need to access list elements via an iterator, you</span>
<span class="c1">//   can use the `iterator` method:</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">it</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">45</span><span class="o">).</span><span class="py">iterator</span>
<span class="n">it</span><span class="k">:</span> <span class="kt">Iterator</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="n">iterator</span><span class="o">&gt;</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">it</span><span class="o">.</span><span class="py">next</span>
<span class="n">res56</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">it</span><span class="o">.</span><span class="py">next</span>
<span class="n">res57</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">23</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">it</span><span class="o">.</span><span class="py">next</span>
<span class="n">res58</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">45</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">it</span><span class="o">.</span><span class="py">hasNext</span>
<span class="n">res59</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">it</span><span class="o">.</span><span class="py">next</span>
<span class="nv">java</span><span class="o">.</span><span class="py">util</span><span class="o">.</span><span class="py">NoSuchElementException</span><span class="k">:</span> <span class="kt">next</span> <span class="kt">on</span> <span class="kt">empty</span> <span class="kt">iterator</span>
  <span class="n">at</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">Iterator$$anon$2</span><span class="o">.</span><span class="py">next</span><span class="o">(</span><span class="nv">Iterator</span><span class="o">.</span><span class="py">scala</span><span class="k">:</span><span class="err">41</span><span class="o">)</span>
  <span class="n">at</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">Iterator$$anon$2</span><span class="o">.</span><span class="py">next</span><span class="o">(</span><span class="nv">Iterator</span><span class="o">.</span><span class="py">scala</span><span class="k">:</span><span class="err">39</span><span class="o">)</span>
  <span class="n">at</span> <span class="nv">scala</span><span class="o">.</span><span class="py">collection</span><span class="o">.</span><span class="py">LinearSeqLike$$anon$1</span><span class="o">.</span><span class="py">next</span><span class="o">(</span><span class="nv">LinearSeqLike</span><span class="o">.</span><span class="py">scala</span><span class="k">:</span><span class="err">50</span><span class="o">)</span>
  <span class="o">...</span> <span class="mi">28</span> <span class="n">elided</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="example-merge-sort">16.2.11. Example: Merge sort</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Merge sort works as follows:</span>
<span class="c1">// First, if the list has zero or one elements, it is already sorted,</span>
<span class="c1">//   so the list can be returned unchanged.</span>
<span class="c1">// Longer lists are split into two sub-lists, each containing about half</span>
<span class="c1">//   the elements of the original list.</span>
<span class="c1">//   Each sub-list is sorted by a recursive call to the sort function,</span>
<span class="c1">//   and the resulting two sorted lists are then combined in a merge operation.</span>
<span class="c1">//</span>
<span class="c1">// For a general implementation of merge sort, you want to leave open the type</span>
<span class="c1">//   of list elements to be sorted, and also want to leave open the function</span>
<span class="c1">//   to be used for the comparison of elements.</span>
<span class="k">def</span> <span class="nf">msort</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">less</span><span class="k">:</span> <span class="o">(</span><span class="kt">T</span><span class="o">,</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Boolean</span><span class="o">)(</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">merge</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span> <span class="n">ys</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="o">(</span><span class="n">xs</span><span class="o">,</span> <span class="n">ys</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
      <span class="nf">case</span> <span class="o">(</span><span class="nc">Nil</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">ys</span>
      <span class="nf">case</span> <span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">xs</span>
      <span class="nf">case</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">xs1</span><span class="o">,</span> <span class="n">y</span> <span class="o">::</span> <span class="n">ys1</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
        <span class="nf">if</span> <span class="o">(</span><span class="nf">less</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">))</span> <span class="n">x</span> <span class="o">::</span> <span class="nf">merge</span><span class="o">(</span><span class="n">xs1</span><span class="o">,</span> <span class="n">ys</span><span class="o">)</span>
        <span class="k">else</span> <span class="n">y</span> <span class="o">::</span> <span class="nf">merge</span><span class="o">(</span><span class="n">xs</span><span class="o">,</span> <span class="n">ys1</span><span class="o">)</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">val</span> <span class="nv">n</span> <span class="k">=</span> <span class="nv">xs</span><span class="o">.</span><span class="py">length</span> <span class="o">/</span> <span class="mi">2</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">xs</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="nf">val</span> <span class="o">(</span><span class="n">ys</span><span class="o">,</span> <span class="n">zs</span><span class="o">)</span> <span class="k">=</span> <span class="nv">xs</span><span class="o">.</span><span class="py">splitAt</span><span class="o">(</span><span class="n">n</span><span class="o">)</span>
    <span class="nf">merge</span><span class="o">(</span><span class="nf">msort</span><span class="o">(</span><span class="n">less</span><span class="o">)(</span><span class="n">ys</span><span class="o">),</span> <span class="nf">msort</span><span class="o">(</span><span class="n">less</span><span class="o">)(</span><span class="n">zs</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">nums</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">hotline</span> <span class="k">=</span> <span class="n">msort</span><span class="o">[</span><span class="kt">Int</span><span class="o">]((</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)(</span><span class="n">nums</span><span class="o">).</span><span class="py">mkString</span>
<span class="nf">println</span><span class="o">(</span><span class="n">hotline</span><span class="o">)</span>
<span class="c1">// 12345</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="higher-order-methods-on-class-list">16.3. Higher-order methods on class List</h3>
<div class="sect3">
<h4 id="mapping-over-lists-map-flatmap-and-foreach">16.3.1. Mapping over lists: <code>map</code>, <code>flatMap</code> and <code>foreach</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// map</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">).</span><span class="py">map</span><span class="o">(</span><span class="k">_</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">words</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"eht"</span><span class="o">,</span> <span class="s">"royam"</span><span class="o">,</span> <span class="s">"eniltoh"</span><span class="o">)</span>
<span class="n">words</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">eht</span><span class="o">,</span> <span class="n">royam</span><span class="o">,</span> <span class="n">eniltoh</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">words</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">toList</span><span class="o">.</span><span class="py">reverse</span><span class="o">.</span><span class="py">mkString</span><span class="o">).</span><span class="py">map</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">capitalize</span><span class="o">)</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">The</span><span class="o">,</span> <span class="nc">Mayor</span><span class="o">,</span> <span class="nc">Hotline</span><span class="o">)</span>

<span class="c1">// flatMap</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">words</span><span class="o">.</span><span class="py">flatMap</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">toList</span><span class="o">.</span><span class="py">reverse</span><span class="o">)</span>
<span class="n">res8</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">t</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">e</span><span class="o">,</span> <span class="n">m</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">o</span><span class="o">,</span> <span class="n">r</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">o</span><span class="o">,</span> <span class="n">t</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">i</span><span class="o">,</span> <span class="n">n</span><span class="o">,</span> <span class="n">e</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">words</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">toList</span><span class="o">.</span><span class="py">reverse</span><span class="o">)</span>
<span class="n">res9</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="n">t</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">e</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="n">m</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">o</span><span class="o">,</span> <span class="n">r</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">o</span><span class="o">,</span> <span class="n">t</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">i</span><span class="o">,</span> <span class="n">n</span><span class="o">,</span> <span class="n">e</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">sum</span> <span class="k">=</span> <span class="mi">0</span>
<span class="n">sum</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1">// foreach</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">).</span><span class="py">map</span><span class="o">(</span><span class="k">_</span> <span class="o">+</span> <span class="mi">1</span><span class="o">).</span><span class="py">foreach</span><span class="o">(</span><span class="n">sum</span> <span class="o">+=</span> <span class="k">_</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">sum</span>
<span class="n">res14</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">15</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="filtering-lists-filter-partition-find-takewhile-dropwhile-and-span">16.3.2. Filtering lists: <code>filter</code>, <code>partition</code>, <code>find</code>, <code>takeWhile</code>, <code>dropWhile</code>, and <code>span</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">filter</span><span class="o">(</span><span class="k">_</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>

<span class="c1">// The `partition` method is like `filter`, but it returns a pair of lists.</span>
<span class="c1">// One list contains all elements for which the predicate is true, while</span>
<span class="c1">// the other list contains all elements for which the predicate is false.</span>
<span class="c1">// It is defined by the equality:</span>
<span class="c1">//   `xs partition p equals (xs filter p, xs filter (!p(_)))`</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">partition</span><span class="o">(</span><span class="k">_</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="o">(</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">],</span> <span class="nc">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">))</span>

<span class="c1">// The `find` method is also similar to `filter` but</span>
<span class="c1">// it returns the first element satisfying a given predicate, rather than</span>
<span class="c1">// all such elements.</span>
<span class="c1">// The operation `xs find p` takes a list `xs` and a predicate `p` as operands.</span>
<span class="c1">// It returns an `optional` value. If there is an element `x` in `xs` for</span>
<span class="c1">// which `p(x)` is true, `Some(x)` is returned.</span>
<span class="c1">// Otherwise, `p` is false for all elements, and `None` is returned.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">find</span><span class="o">(</span><span class="k">_</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>

<span class="c1">// The `takeWhile` and `dropWhile` operators also take a predicate as their right operand.</span>
<span class="c1">// The operation `xs takeWhile p` takes the longest prefix of list `xs` such that every</span>
<span class="c1">// element in the prefix satisfies `p`.</span>
<span class="c1">// Analogously, the operation `xs dropWhile p` removes the longest prefix from list `xs`</span>
<span class="c1">// such that every element in the prefix satisfies `p`.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">takeWhile</span><span class="o">(</span><span class="k">_</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">takeWhile</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">dropWhile</span><span class="o">(</span><span class="k">_</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">dropWhile</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="c1">// The `span` method combines `takeWhile` and `dropWhile` in one operation,</span>
<span class="c1">// just like `splitAt` combines `take` and `drop`.</span>
<span class="c1">// It returns a pair of two lists, defined by the equality:</span>
<span class="c1">//   `xs span p equals (xs takeWhile p, xs dropWhile p)`</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">span</span><span class="o">(</span><span class="k">_</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res8</span><span class="k">:</span> <span class="o">(</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">],</span> <span class="nc">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">),</span><span class="nc">List</span><span class="o">(-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">span</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res9</span><span class="k">:</span> <span class="o">(</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">],</span> <span class="nc">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="nc">List</span><span class="o">(),</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">))</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="predicates-over-lists-forall-and-exists">16.3.3. Predicates over lists: <code>forall</code> and <code>exists</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The operation `xs forall p` takes as arguments a list `xs` and a predicate `p`.</span>
<span class="c1">//   Its result is `true` if all elements in the list satisfy `p`.</span>
<span class="c1">// Conversely, the operation `xs exists p` returns `true` if there is an element</span>
<span class="c1">//   in `xs` that satisfies the predicate `p`.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">forall</span><span class="o">(</span><span class="k">_</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res10</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">exists</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">res11</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="folding-lists-foldleft-and-foldright">16.3.4. Folding lists: <code>foldLeft</code>, <code>/:</code> and <code>foldRight</code>, <code>:\</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A fold left operation `(z /: xs) (op)` involves three objects:</span>
<span class="c1">//   a start value `z`,</span>
<span class="c1">//   a list `xs`,</span>
<span class="c1">//   and a binary operation `op`.</span>
<span class="c1">// The result of the fold is `op` applied between successive elements</span>
<span class="c1">//   of the list prefixed by `z`.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">nums</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
<span class="n">nums</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="o">(</span><span class="mi">0</span> <span class="o">/:</span> <span class="n">nums</span><span class="o">)(</span><span class="k">_</span> <span class="o">+</span> <span class="k">_</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">method</span> <span class="kt">/:</span> <span class="kt">in</span> <span class="kt">trait</span> <span class="kt">TraversableOnce</span> <span class="kt">is</span> <span class="kt">deprecated</span> <span class="o">(</span><span class="kt">since</span> <span class="err">2</span><span class="kt">.</span><span class="err">12</span><span class="kt">.</span><span class="err">10</span><span class="o">)</span><span class="kt">:</span> <span class="kt">Use</span> <span class="kt">foldLeft</span> <span class="kt">instead</span> <span class="kt">of</span> <span class="kt">/:</span>
       <span class="o">(</span><span class="err">0</span> <span class="kt">/:</span> <span class="kt">nums</span><span class="o">)(</span><span class="k">_</span> <span class="kt">+</span> <span class="k">_</span><span class="o">)</span>
          <span class="kt">^</span>
<span class="kt">res13:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">nums</span><span class="o">.</span><span class="py">foldLeft</span><span class="o">(</span><span class="mi">0</span><span class="o">)(</span><span class="k">_</span> <span class="o">+</span> <span class="k">_</span><span class="o">)</span>
<span class="n">res16</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1">// The `:\` operator is pronounced fold right.</span>
<span class="c1">// It involves the same three operands as fold left, but the first two appear</span>
<span class="c1">//   in reversed order:</span>
<span class="c1">//   The first operand is the list to fold,</span>
<span class="c1">//   the second is the start value.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="o">(</span><span class="n">nums</span> <span class="o">:\</span> <span class="mi">0</span><span class="o">)(</span><span class="k">_</span> <span class="o">+</span> <span class="k">_</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">method</span> <span class="kt">:\</span> <span class="kt">in</span> <span class="kt">trait</span> <span class="kt">TraversableOnce</span> <span class="kt">is</span> <span class="kt">deprecated</span> <span class="o">(</span><span class="kt">since</span> <span class="err">2</span><span class="kt">.</span><span class="err">12</span><span class="kt">.</span><span class="err">10</span><span class="o">)</span><span class="kt">:</span> <span class="kt">Use</span> <span class="kt">foldRight</span> <span class="kt">instead</span> <span class="kt">of</span> <span class="kt">:\</span>
       <span class="o">(</span><span class="kt">nums</span> <span class="kt">:\</span> <span class="err">0</span><span class="o">)(</span><span class="k">_</span> <span class="kt">+</span> <span class="k">_</span><span class="o">)</span>
             <span class="kt">^</span>
<span class="kt">res19:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">nums</span><span class="o">.</span><span class="py">foldRight</span><span class="o">(</span><span class="mi">0</span><span class="o">)(</span><span class="k">_</span> <span class="o">+</span> <span class="k">_</span><span class="o">)</span>
<span class="n">res20</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">7</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// reverse using concatenation(:::)</span>
<span class="c1">// running time was quadratic in the length of the list to be reversed.</span>
<span class="k">def</span> <span class="nf">rev</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">List</span><span class="o">()</span> <span class="k">=&gt;</span> <span class="n">xs</span>
  <span class="k">case</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs1</span> <span class="k">=&gt;</span> <span class="nf">rev</span><span class="o">(</span><span class="n">xs1</span><span class="o">)</span> <span class="o">:::</span> <span class="nc">List</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// List reversal using fold</span>
<span class="c1">// If you analyze the complexity of reverseLeft, you’ll</span>
<span class="c1">// find that it applies a constant-time operation (“snoc”) n times, where n is the</span>
<span class="c1">// length of the argument list. Hence, the complexity of reverseLeft is linear,</span>
<span class="c1">// as hoped for.</span>
<span class="k">def</span> <span class="nf">reverseLeft</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span> <span class="k">=</span>
  <span class="o">(</span><span class="nc">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]()</span> <span class="o">/:</span> <span class="n">xs</span><span class="o">)</span> <span class="o">{(</span><span class="n">ys</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">y</span> <span class="o">::</span> <span class="n">ys</span><span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sorting-lists-sortwith">16.3.5. Sorting lists: <code>sortWith</code></h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">5</span><span class="o">).</span><span class="py">sortWith</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="k">_</span><span class="o">)</span>
<span class="n">res21</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="methods-of-the-list-object">16.4. Methods of the List object</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Creating lists from their elements: `List.apply`</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="c1">// Creating a range of numbers: `List.range`</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">9</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">range</span><span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>

<span class="c1">// Creating uniform lists: `List.fill`</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">fill</span><span class="o">(</span><span class="mi">5</span><span class="o">)(</span><span class="sc">'a'</span><span class="o">)</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">a</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">fill</span><span class="o">(</span><span class="mi">5</span><span class="o">)(</span><span class="s">"hello"</span><span class="o">)</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">hello</span><span class="o">,</span> <span class="n">hello</span><span class="o">,</span> <span class="n">hello</span><span class="o">,</span> <span class="n">hello</span><span class="o">,</span> <span class="n">hello</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">fill</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)(</span><span class="sc">'b'</span><span class="o">)</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">b</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">b</span><span class="o">))</span>

<span class="c1">// Tabulating a function: `List.tabulate`</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">tabulate</span><span class="o">(</span><span class="mi">3</span><span class="o">)(</span><span class="n">n</span> <span class="k">=&gt;</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">tabulate</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">3</span><span class="o">)(</span><span class="k">_</span> <span class="o">*</span> <span class="k">_</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">))</span>

<span class="c1">// Concatenating multiple lists: `List.concat`</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">concat</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="sc">'a'</span><span class="o">,</span> <span class="sc">'b'</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="sc">'c'</span><span class="o">))</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">concat</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="sc">'a'</span><span class="o">,</span> <span class="sc">'b'</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="sc">'c'</span><span class="o">),</span> <span class="nc">List</span><span class="o">())</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Char</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">List</span><span class="o">.</span><span class="py">concat</span><span class="o">()</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Nothing</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">()</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="understanding-scalas-type-inference-algorithm">16.5. Understanding Scala’s type inference algorithm</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">msort</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">less</span><span class="k">:</span> <span class="o">(</span><span class="kt">T</span><span class="o">,</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Boolean</span><span class="o">)(</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">merge</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span> <span class="n">ys</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="o">(</span><span class="n">xs</span><span class="o">,</span> <span class="n">ys</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
      <span class="nf">case</span> <span class="o">(</span><span class="nc">Nil</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">ys</span>
      <span class="nf">case</span> <span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">xs</span>
      <span class="nf">case</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">xs1</span><span class="o">,</span> <span class="n">y</span> <span class="o">::</span> <span class="n">ys1</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
        <span class="nf">if</span> <span class="o">(</span><span class="nf">less</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">))</span> <span class="n">x</span> <span class="o">::</span> <span class="nf">merge</span><span class="o">(</span><span class="n">xs1</span><span class="o">,</span> <span class="n">ys</span><span class="o">)</span>
        <span class="k">else</span> <span class="n">y</span> <span class="o">::</span> <span class="nf">merge</span><span class="o">(</span><span class="n">xs</span><span class="o">,</span> <span class="n">ys1</span><span class="o">)</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">val</span> <span class="nv">seq</span> <span class="k">=</span> <span class="nv">xs</span><span class="o">.</span><span class="py">length</span> <span class="o">/</span> <span class="mi">2</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">seq</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="n">xs</span>
  <span class="k">else</span> <span class="o">{</span>
    <span class="nf">val</span> <span class="o">(</span><span class="n">ys</span><span class="o">,</span> <span class="n">zs</span><span class="o">)</span> <span class="k">=</span> <span class="nv">xs</span><span class="o">.</span><span class="py">splitAt</span><span class="o">(</span><span class="n">seq</span><span class="o">)</span>
    <span class="nf">merge</span><span class="o">(</span><span class="nf">msort</span><span class="o">(</span><span class="n">less</span><span class="o">)(</span><span class="n">ys</span><span class="o">),</span> <span class="nf">msort</span><span class="o">(</span><span class="n">less</span><span class="o">)(</span><span class="n">zs</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">nums</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">nums</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>

<span class="c1">// a longer form of comparison function with named parameters and explicit types</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">msort</span><span class="o">((</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)(</span><span class="n">nums</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">nums</span><span class="o">.</span><span class="py">sortWith</span><span class="o">((</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// a concise form, `(_ &gt; _)`, where named parameters are replaced by underscores</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">nums</span><span class="o">.</span><span class="py">sortWith</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="k">_</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">msort</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="k">_</span><span class="o">)(</span><span class="n">nums</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">14</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">missing</span> <span class="kt">parameter</span> <span class="k">type</span> <span class="kt">for</span> <span class="kt">expanded</span> <span class="kt">function</span> <span class="o">((</span><span class="kt">x$1:</span> <span class="kt">&lt;error&gt;</span><span class="o">,</span> <span class="kt">x$2</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="nv">x$1</span><span class="o">.</span><span class="py">$less</span><span class="o">(</span><span class="n">x$2</span><span class="o">))</span>
       <span class="nf">msort</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="k">_</span><span class="o">)(</span><span class="n">nums</span><span class="o">)</span>
             <span class="o">^</span></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Type inference in Scala is flow based.</div>
<div class="ulist">
<ul>
<li>
<p>In a method application <code>m(args)</code>,</p>
<div class="paragraph">
<p>the inferencer first <strong>checks whether the method</strong> <code>m</code> has a <strong>known type</strong>. If it has, that type is used to infer the expected type of the arguments.</p>
</div>
<div class="paragraph">
<p>For instance, in <code>nums.sortWith(_ &gt; \_)</code>, the type of <code>nums</code> is <code>List[Int]</code>, hence <code>sortWith</code> is known to be a method that takes an argument of type <code>(Int, Int) =&gt; Boolean</code> and produces a result of type <code>List[Int]</code>.</p>
</div>
<div class="paragraph">
<p>Since the parameter types of the function arguments are thus known, they need not be written explicitly. With what it knows about <code>sortWith</code>, the inferencer can deduce that <code>(_ &gt; _)</code> should expand to <code>((x: Int, y: Int) =&gt; x &gt; y)</code> where <code>x</code> and <code>y</code> are some arbitrary fresh names.</p>
</div>
</li>
<li>
<p>Now consider the second case, <code>msort(_ &gt; _)(nums)</code>.</p>
<div class="paragraph">
<p>The type of <code>msort</code> is a <strong>curried</strong>, <strong>polymorphic</strong> method type that takes an argument of type <code>(T, T) =&gt; Boolean</code> to a function from <code>List[T]</code> to <code>List[T]</code> where <code>T</code> is some as-yet <strong>unknown type</strong>.</p>
</div>
<div class="paragraph">
<p>The <code>msort</code> method needs to be instantiated with a type parameter before it can be applied to its arguments.</p>
</div>
<div class="paragraph">
<p>Because the precise instance type of <code>msort</code> in the application is not yet known, it cannot be used to infer the type of its first argument.</p>
</div>
</li>
<li>
<p>The type inferencer changes its strategy in this case; it first type <strong>checks method arguments</strong> to determine the proper instance type of the method.</p>
<div class="paragraph">
<p>However, when tasked to type check the shorthand function literal, <code>(_ &gt; _)</code>, it fails because it has no information about the types of the implicit function parameters that are indicated by underscores.</p>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>One way to resolve the problem is to <strong>pass an explicit type parameter to msort</strong>, as in:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">msort</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="k">_</span> <span class="o">&lt;</span> <span class="k">_</span><span class="o">)(</span><span class="n">nums</span><span class="o">)</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because the correct instance type of <code>msort</code> is now known, it can be used to infer the type of the arguments.</p>
</div>
</li>
<li>
<p>Another possible solution is to <strong>rewrite the <code>msort</code> method</strong> so that its parameters are swapped:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// What has happened is that the inferencer used the known type of the first parameter `nums`</span>
<span class="c1">// to determine the type parameter of `msortSwapped`.</span>
<span class="c1">// Once the precise type of `msortSwapped` was known, it could be used in turn to infer the</span>
<span class="c1">//   type of the second parameter, `(_ &gt; _)`.</span>
<span class="c1">//</span>
<span class="c1">// Generally, when tasked to infer the type parameters of a polymorphic method, the type inferencer</span>
<span class="c1">//    consults the types of all value arguments in the first parameter list but no arguments beyond that.</span>
<span class="c1">//  Since `msortSwapped` is a curried method with two parameter lists, the second argument (i.e., the function value) did not need to be consulted to determine the type parameter of the method.</span>

<span class="k">def</span> <span class="nf">msortSwapped</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="n">less</span><span class="k">:</span> <span class="o">(</span><span class="kt">T</span><span class="o">,</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Boolean</span><span class="o">)</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="nf">msort</span><span class="o">(</span><span class="n">less</span><span class="o">)(</span><span class="n">xs</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nf">msortSwapped</span><span class="o">(</span><span class="n">nums</span><span class="o">)(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="k">_</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This inference scheme suggests the following library design principle:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>When designing a polymorphic method that takes some non-function arguments and a function argument, place the function argument last in a curried parameter list by its own</strong>.
That way, the method&#8217;s correct instance type can be inferred from the non-function arguments, and that type can in turn be used to type check the function argument.
The net effect is that users of the method will be able to give less type information and write function literals in more compact ways.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="collections">17. Collections</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sequences">17.1. Sequences</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Lists</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Lists support fast addition and removal of items to the beginning of the list, but</span>
<span class="c1">//   they do not provide fast access to arbitrary indexes because the implementation</span>
<span class="c1">//   must iterate through the list linearly.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">colors</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"red"</span><span class="o">,</span> <span class="s">"blue"</span><span class="o">,</span> <span class="s">"green"</span><span class="o">)</span>
<span class="n">colors</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">red</span><span class="o">,</span> <span class="n">blue</span><span class="o">,</span> <span class="n">green</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">colors</span><span class="o">.</span><span class="py">head</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">red</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">colors</span><span class="o">.</span><span class="py">tail</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">blue</span><span class="o">,</span> <span class="n">green</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Arrays</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Arrays allow you to hold a sequence of elements and efficiently access an element</span>
<span class="c1">//   at an arbitrary position, both to get or update the element, with a zero-based index.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">fiveInts</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="mi">5</span><span class="o">)</span>
<span class="n">fiveInts</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">fiveToOne</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
<span class="n">fiveToOne</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">fiveInts</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="k">=</span> <span class="nf">fiveToOne</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">fiveInts</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>List buffers</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Class List provides fast access to the head of the list, but not the end. Thus, when</span>
<span class="c1">//   you need to build a list by appending to the end, you should consider building the</span>
<span class="c1">//   list backwards by prepending elements to the front, then when you're done, calling</span>
<span class="c1">//   reverse to get the elements in the order you need.</span>
<span class="c1">//</span>
<span class="c1">// Another alternative, which avoids the reverse operation, is to use a `ListBuffer`.</span>
<span class="c1">//   A ListBuffer is a mutable object (contained in `package scala.collection.mutable`), which</span>
<span class="c1">//   can help you build lists more efficiently when you need to append.</span>
<span class="c1">//</span>
<span class="c1">// ListBuffer provides constant time append and prepend operations.</span>
<span class="c1">//   You append elements with the `+=` operator,</span>
<span class="c1">//   and prepend them with the `+=:` operator.</span>
<span class="c1">//</span>
<span class="c1">// When you're done building, you can obtain a List by invoking `toList` on the ListBuffer.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">scala.collection.mutable.ListBuffer</span>
<span class="k">import</span> <span class="nn">scala.collection.mutable.ListBuffer</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">buf</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ListBuffer</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span>
<span class="n">buf</span><span class="k">:</span> <span class="kt">scala.collection.mutable.ListBuffer</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ListBuffer</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">buf</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">buf.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ListBuffer</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">buf</span> <span class="o">+=</span> <span class="mi">2</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">buf.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ListBuffer</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="mi">3</span> <span class="o">+=:</span> <span class="n">buf</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">buf.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ListBuffer</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="mi">45</span> <span class="o">+=:</span> <span class="n">buf</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">buf.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ListBuffer</span><span class="o">(</span><span class="mi">45</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">buf</span><span class="o">.</span><span class="py">toList</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">45</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Array buffers</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// An ArrayBuffer is like an array, except that you can additionally add and remove elements</span>
<span class="c1">//   from the beginning and end of the sequence.</span>
<span class="c1">// All Array operations are available, though they are a little slower due to a layer of wrapping</span>
<span class="c1">//   in the implementation.</span>
<span class="c1">// The new addition and removal operations are constant time on average, but occasionally require</span>
<span class="c1">//   linear time due to the implementation needing to allocate a new array to hold the buffer's contents.</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">scala.collection.mutable.ArrayBuffer</span>
<span class="k">import</span> <span class="nn">scala.collection.mutable.ArrayBuffer</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">buf</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ArrayBuffer</span><span class="o">[</span><span class="kt">Int</span><span class="o">]()</span>
<span class="n">buf</span><span class="k">:</span> <span class="kt">scala.collection.mutable.ArrayBuffer</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ArrayBuffer</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">buf</span> <span class="o">+=</span> <span class="mi">3</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">buf.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ArrayBuffer</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">buf</span> <span class="o">+=</span> <span class="mi">5</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">buf.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ArrayBuffer</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">buf</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">buf.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ArrayBuffer</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">buf</span> <span class="o">-=</span> <span class="mi">5</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">buf.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ArrayBuffer</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sets-and-maps">17.2. Sets and maps</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Default map and set definitions in <code>Predef</code>.</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The `type` keyword is used in `Predef` to define `Set` and `Map` as aliases</span>
<span class="c1">//   for the longer fully qualified names of the immutable set and map traits.</span>
<span class="c1">// The `val`s named `Set` and `Map` are initialized to refer to the singleton objects</span>
<span class="c1">//   for the immutable `Set` and `Map`.</span>
<span class="c1">// So `Map` is the same as `Predef.Map`, which is defined to be</span>
<span class="c1">//   the same as `scala.collection.immutable.Map`.</span>
<span class="c1">// This holds both for the Map type and Map object.</span>
<span class="k">object</span> <span class="nc">Predef</span> <span class="o">{</span>
  <span class="k">type</span> <span class="kt">Map</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">+B</span><span class="o">]</span> <span class="k">=</span> <span class="nv">collection</span><span class="o">.</span><span class="py">immutable</span><span class="o">.</span><span class="py">Map</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">B</span><span class="o">]</span>
  <span class="k">type</span> <span class="kt">Set</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="nv">collection</span><span class="o">.</span><span class="py">immutable</span><span class="o">.</span><span class="py">Set</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
  <span class="k">val</span> <span class="nv">Map</span> <span class="k">=</span> <span class="nv">collection</span><span class="o">.</span><span class="py">immutable</span><span class="o">.</span><span class="py">Map</span>
  <span class="k">val</span> <span class="nv">Set</span> <span class="k">=</span> <span class="nv">collection</span><span class="o">.</span><span class="py">immutable</span><span class="o">.</span><span class="py">Set</span>
  <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Using sets</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">scala.collection.mutable</span>
<span class="k">import</span> <span class="nn">scala.collection.mutable</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">text</span> <span class="k">=</span> <span class="s">"See Spot run. Run, Spot. Run!"</span>
<span class="n">text</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">See</span> <span class="nc">Spot</span> <span class="n">run</span><span class="o">.</span> <span class="nc">Run</span><span class="o">,</span> <span class="nc">Spot</span><span class="o">.</span> <span class="nc">Run</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">wordsArray</span> <span class="k">=</span> <span class="nv">text</span><span class="o">.</span><span class="py">split</span><span class="o">(</span><span class="s">"[ !,.]+"</span><span class="o">)</span>
<span class="n">wordsArray</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="nc">See</span><span class="o">,</span> <span class="nc">Spot</span><span class="o">,</span> <span class="n">run</span><span class="o">,</span> <span class="nc">Run</span><span class="o">,</span> <span class="nc">Spot</span><span class="o">,</span> <span class="nc">Run</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">words</span> <span class="k">=</span> <span class="nv">mutable</span><span class="o">.</span><span class="py">Set</span><span class="o">.</span><span class="py">empty</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
<span class="n">words</span><span class="k">:</span> <span class="kt">scala.collection.mutable.Set</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Set</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">wordsArray</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="n">words</span> <span class="o">+=</span> <span class="k">_</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">words</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">scala.collection.mutable.Set</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Set</span><span class="o">(</span><span class="nc">Run</span><span class="o">,</span> <span class="nc">Spot</span><span class="o">,</span> <span class="n">run</span><span class="o">,</span> <span class="nc">See</span><span class="o">)</span></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Common operations for sets</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">What it is</th>
<th class="tableblock halign-left valign-top">What it does</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">val nums = Set(1, 2, 3)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Creates an immutable set</p>
</div>
<div class="paragraph">
<p>(nums.toString returns Set(1, 2, 3))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums + 5</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Adds an element</p>
</div>
<div class="paragraph">
<p>(returns Set(1, 2, 3, 5))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums - 3</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes an element</p>
</div>
<div class="paragraph">
<p>(returns Set(1, 2))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums ++ List(5, 6)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Adds multiple elements</p>
</div>
<div class="paragraph">
<p>(returns Set(1, 2, 3, 5, 6))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums -- List(1, 2)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes multiple elements</p>
</div>
<div class="paragraph">
<p>(returns Set(3))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums &amp; Set(1, 3, 5, 7)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Takes the intersection of two sets</p>
</div>
<div class="paragraph">
<p>(returns Set(1, 3))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums.size</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Returns the size of the set</p>
</div>
<div class="paragraph">
<p>(returns 3)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums.contains(3)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Checks for inclusion</p>
</div>
<div class="paragraph">
<p>(returns true)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">import scala.collection.mutable</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Makes the mutable collections easy to access</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">val words = mutable.Set.empty[String]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Creates an empty, mutable set</p>
</div>
<div class="paragraph">
<p>(words.toString returns Set())</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">words += "the"</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Adds an element</p>
</div>
<div class="paragraph">
<p>(words.toString returns Set(the))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">words -= "the"</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes an element, if it exists
(words.toString returns Set())</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">words ++= List("do", "re", "mi")</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Adds multiple elements</p>
</div>
<div class="paragraph">
<p>(words.toString returns Set(do, re, mi))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">words --= List("do", "re")</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes multiple elements</p>
</div>
<div class="paragraph">
<p>(words.toString returns Set(mi))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">words.clear</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes all elements</p>
</div>
<div class="paragraph">
<p>(words.toString returns Set())</p>
</div></div></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Using maps</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">scala.collection.mutable</span>
<span class="k">import</span> <span class="nn">scala.collection.mutable</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">map</span> <span class="k">=</span> <span class="nv">mutable</span><span class="o">.</span><span class="py">Map</span><span class="o">.</span><span class="py">empty</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">]</span>
<span class="n">map</span><span class="k">:</span> <span class="kt">scala.collection.mutable.Map</span><span class="o">[</span><span class="kt">String</span>,<span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="s">"hello"</span><span class="o">)</span> <span class="k">=</span> <span class="mi">1</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="s">"there"</span><span class="o">)</span> <span class="k">=</span> <span class="mi">2</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="s">"hello"</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">wordsCount</span> <span class="k">=</span> <span class="nv">mutable</span><span class="o">.</span><span class="py">Map</span><span class="o">.</span><span class="py">empty</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">]</span>
<span class="n">wordsCount</span><span class="k">:</span> <span class="kt">scala.collection.mutable.Map</span><span class="o">[</span><span class="kt">String</span>,<span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">wordsArray</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="n">w</span> <span class="k">=&gt;</span> <span class="nf">if</span> <span class="o">(</span><span class="nv">wordsCount</span><span class="o">.</span><span class="py">contains</span><span class="o">(</span><span class="n">w</span><span class="o">))</span>  <span class="nf">wordsCount</span><span class="o">(</span><span class="n">w</span><span class="o">)</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">else</span> <span class="nf">wordsCount</span><span class="o">(</span><span class="n">w</span><span class="o">)</span> <span class="k">=</span> <span class="mi">1</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">wordsCount</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">scala.collection.mutable.Map</span><span class="o">[</span><span class="kt">String</span>,<span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="nc">See</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">,</span> <span class="nc">Spot</span> <span class="o">-&gt;</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Run</span> <span class="o">-&gt;</span> <span class="mi">2</span><span class="o">,</span> <span class="n">run</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">)</span></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Common operations for maps</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">What it is</th>
<th class="tableblock halign-left valign-top">What it does</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">val nums = Map("i" -&gt; 1, "ii" -&gt; 2)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Creates an immutable map</p>
</div>
<div class="paragraph">
<p>(nums.toString returns Map(i -&gt; 1, ii -&gt; 2))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums + ("vi" -&gt; 6)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Adds an entry</p>
</div>
<div class="paragraph">
<p>(returns Map(i -&gt; 1, ii &#8594; 2, vi -&gt; 6))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums - "ii"</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes an entry</p>
</div>
<div class="paragraph">
<p>(returns Map(i -&gt; 1))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums ++ List("iii" -&gt; 3, "v" -&gt; 5)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Adds multiple entries</p>
</div>
<div class="paragraph">
<p>(returns Map(i -&gt; 1, ii -&gt; 2, iii -&gt; 3, v -&gt; 5))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums -- List("i", "ii")</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes multiple entries</p>
</div>
<div class="paragraph">
<p>(returns Map())</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums.size</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Returns the size of the map</p>
</div>
<div class="paragraph">
<p>(returns 2)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums.contains("ii")</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Checks for inclusion</p>
</div>
<div class="paragraph">
<p>(returns true)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums("ii")</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Retrieves the value at a specified key</p>
</div>
<div class="paragraph">
<p>(returns 2)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums.keys</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Returns the keys</p>
</div>
<div class="paragraph">
<p>(returns an Iteratable over the strings "i" and "ii")</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums.keySet</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Returns the keys as a set</p>
</div>
<div class="paragraph">
<p>(returns Set(i, ii))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums.values</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Returns the values</p>
</div>
<div class="paragraph">
<p>(returns an Iterable over the integers 1 and 2)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nums.isEmpty</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Indicates whether the map is empty</p>
</div>
<div class="paragraph">
<p>(returns false)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">import scala.collection.mutable</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Makes the mutable collections easy to access</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">val words = mutable.Map.empty[String, Int]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Creates an empty, mutable map</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">words += ("one" -&gt; 1)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Adds a map entry from "one" to 1
(words.toString returns Map(one &#8594; 1))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">words -= "one"</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes a map entry, if it exists
(words.toString returns Map())</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">words ++= List("one" -&gt; 1, "two" -&gt; 2, "three" -&gt; 3)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Adds multiple map entries</p>
</div>
<div class="paragraph">
<p>(words.toString returns Map(one -&gt; 1, two -&gt; 2, three -&gt; 3))</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">words --= List("one", "two")</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes multiple objects</p>
</div>
<div class="paragraph">
<p>(words.toString returns Map(three -&gt; 3))</p>
</div></div></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Default sets and maps</strong></p>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Default immutable set implementations</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number of elements</th>
<th class="tableblock halign-left valign-top">Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.EmptySet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.Set1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.Set2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.Set3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.Set4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 or more</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.HashSet</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Default immutable map implementations</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number of elements</th>
<th class="tableblock halign-left valign-top">Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.EmptyMap</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.Map1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.Map2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.Map3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.Map4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 or more</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala.collection.immutable.HashMap</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Sorted sets and maps</strong></p>
<div class="paragraph">
<p>On occasion you may need a set or map whose iterator returns elements in a particular order.</p>
</div>
<div class="paragraph">
<p>For this purpose, the Scala collections library provides traits <strong>SortedSet</strong> and <strong>SortedMap</strong>.</p>
</div>
<div class="paragraph">
<p>These traits are implemented by classes <strong>TreeSet</strong> and <strong>TreeMap</strong>, which use a <strong>red-black tree</strong> to keep elements (in the case of TreeSet) or keys (in the case of TreeMap) in order.</p>
</div>
<div class="paragraph">
<p>The order is determined by the <strong>Ordered</strong> trait, which the element type of the set, or key type of the map, must either mix in or be implicitly convertible to.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">scala.collection.immutable.TreeSet</span>
<span class="k">import</span> <span class="nn">scala.collection.immutable.TreeSet</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">ts</span> <span class="k">=</span> <span class="nc">TreeSet</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">1</span><span class="o">)</span>
<span class="n">ts</span><span class="k">:</span> <span class="kt">scala.collection.immutable.TreeSet</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">TreeSet</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">scala.collection.immutable.TreeMap</span>
<span class="k">import</span> <span class="nn">scala.collection.immutable.TreeMap</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">tm</span> <span class="k">=</span> <span class="nc">TreeMap</span><span class="o">(</span><span class="mi">3</span> <span class="o">-&gt;</span> <span class="s">"2020"</span><span class="o">,</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="s">"2019"</span><span class="o">,</span> <span class="mi">4</span> <span class="o">-&gt;</span> <span class="s">"2021"</span><span class="o">,</span> <span class="mi">5</span> <span class="o">-&gt;</span> <span class="s">"2022"</span><span class="o">,</span> <span class="mi">1</span> <span class="o">-&gt;</span> <span class="s">"covid-19"</span><span class="o">)</span>
<span class="n">tm</span><span class="k">:</span> <span class="kt">scala.collection.immutable.TreeMap</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="n">covid</span><span class="o">-</span><span class="mi">19</span><span class="o">,</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">2019</span><span class="o">,</span> <span class="mi">3</span> <span class="o">-&gt;</span> <span class="mi">2020</span><span class="o">,</span> <span class="mi">4</span> <span class="o">-&gt;</span> <span class="mi">2021</span><span class="o">,</span> <span class="mi">5</span> <span class="o">-&gt;</span> <span class="mi">2022</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">tm</span><span class="o">.</span><span class="py">values</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Iterable</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">TreeMap</span><span class="o">(</span><span class="n">covid</span><span class="o">-</span><span class="mi">19</span><span class="o">,</span> <span class="mi">2019</span><span class="o">,</span> <span class="mi">2020</span><span class="o">,</span> <span class="mi">2021</span><span class="o">,</span> <span class="mi">2022</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">scala.collection.mutable.TreeSet</span>
<span class="k">import</span> <span class="nn">scala.collection.mutable.TreeSet</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">ts</span> <span class="k">=</span> <span class="nv">TreeSet</span><span class="o">.</span><span class="py">empty</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
<span class="n">ts</span><span class="k">:</span> <span class="kt">scala.collection.mutable.TreeSet</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">TreeSet</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ts</span> <span class="o">+=</span> <span class="s">"2019"</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">ts.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">TreeSet</span><span class="o">(</span><span class="mi">2019</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ts</span> <span class="o">+=</span> <span class="s">"covid-19"</span>
<span class="n">res9</span><span class="k">:</span> <span class="kt">ts.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">TreeSet</span><span class="o">(</span><span class="mi">2019</span><span class="o">,</span> <span class="n">covid</span><span class="o">-</span><span class="mi">19</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ts</span> <span class="o">+=</span> <span class="s">"2022"</span>
<span class="n">res10</span><span class="k">:</span> <span class="kt">ts.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">TreeSet</span><span class="o">(</span><span class="mi">2019</span><span class="o">,</span> <span class="mi">2022</span><span class="o">,</span> <span class="n">covid</span><span class="o">-</span><span class="mi">19</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ts</span> <span class="o">+=</span> <span class="s">"2021"</span>
<span class="n">res11</span><span class="k">:</span> <span class="kt">ts.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">TreeSet</span><span class="o">(</span><span class="mi">2019</span><span class="o">,</span> <span class="mi">2021</span><span class="o">,</span> <span class="mi">2022</span><span class="o">,</span> <span class="n">covid</span><span class="o">-</span><span class="mi">19</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ts</span> <span class="o">+=</span> <span class="s">"2020"</span>
<span class="n">res12</span><span class="k">:</span> <span class="kt">ts.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">TreeSet</span><span class="o">(</span><span class="mi">2019</span><span class="o">,</span> <span class="mi">2020</span><span class="o">,</span> <span class="mi">2021</span><span class="o">,</span> <span class="mi">2022</span><span class="o">,</span> <span class="n">covid</span><span class="o">-</span><span class="mi">19</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">ts</span><span class="o">.</span><span class="py">toSet</span>
<span class="n">res13</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Set</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Set</span><span class="o">(</span><span class="mi">2020</span><span class="o">,</span> <span class="mi">2022</span><span class="o">,</span> <span class="mi">2019</span><span class="o">,</span> <span class="mi">2021</span><span class="o">,</span> <span class="n">covid</span><span class="o">-</span><span class="mi">19</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stateful-objects">18. Stateful Objects</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="what-makes-an-object-stateful">18.1. What makes an object stateful?</h3>
<div class="paragraph">
<p>You can observe the principal difference between a purely functional object and a stateful one even without looking at the object&#8217;s implementation.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When you invoke a method or dereference a field on some <strong>purely functional object</strong>, you will always get the same result.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// `cs.head` will always return 'a'</span>
<span class="k">val</span> <span class="nv">cs</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>For a <strong>stateful object</strong>, on the other hand, the result of a method call or field access may depend on what operations were previously performed on the object.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">BankAccount</span> <span class="o">{</span>
  <span class="k">private</span> <span class="k">var</span> <span class="n">bal</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="k">def</span> <span class="nf">balance</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="n">bal</span>

  <span class="k">def</span> <span class="nf">deposit</span><span class="o">(</span><span class="n">amount</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
    <span class="nf">require</span><span class="o">(</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
    <span class="n">bal</span> <span class="o">+=</span> <span class="n">amount</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">withdraw</span><span class="o">(</span><span class="n">amount</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span>
    <span class="nf">if</span> <span class="o">(</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="n">bal</span><span class="o">)</span> <span class="kc">false</span>
    <span class="k">else</span> <span class="o">{</span>
      <span class="n">bal</span> <span class="o">-=</span> <span class="n">amount</span>
      <span class="kc">true</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">account</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BankAccount</span>
<span class="n">account</span><span class="k">:</span> <span class="kt">BankAccount</span> <span class="o">=</span> <span class="nc">BankAccount</span><span class="nd">@a77a465</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">account</span><span class="o">.</span><span class="py">deposit</span><span class="o">(</span><span class="mi">100</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">account</span><span class="o">.</span><span class="py">withdraw</span><span class="o">(</span><span class="mi">80</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">account</span><span class="o">.</span><span class="py">withdraw</span><span class="o">(</span><span class="mi">80</span><span class="o">)</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="reassignable-variables-and-properties">18.2. Reassignable variables and properties</h3>
<div class="paragraph">
<p>You can perform two fundamental operations on a reassignable variable: <strong>get</strong> its value or <strong>set</strong> it to a new value.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In libraries such as JavaBeans, these operations are often encapsulated in separate <strong>getter</strong> and <strong>setter</strong> methods, which need to be defined explicitly.</p>
</li>
<li>
<p>In Scala, every var that is a <strong>non-private member of some object implicitly defines a getter and a setter method</strong> with it. The getter of a var <code>x</code> is just named <code>x</code>, while its setter is named <code>x_=</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A class with public vars.</span>
<span class="c1">//</span>
<span class="c1">// The field is always marked `private[this]`, which means it can be accessed only from</span>
<span class="c1">//    the object that contains it.</span>
<span class="c1">// The getter and setter, on the other hand, get the same visibility as the original `var`.</span>
<span class="c1">//   If the var definition is `public`, so are its getter and setter,</span>
<span class="c1">//    if it is `protected` they are also `protected`, and so on.</span>
<span class="k">class</span> <span class="nc">Time</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">hour</span> <span class="k">=</span> <span class="mi">12</span>
  <span class="k">var</span> <span class="n">minute</span> <span class="k">=</span> <span class="mi">0</span>
<span class="o">}</span>
<span class="c1">// $ javap -p Time.class</span>
<span class="c1">// Compiled from "Time.scala"</span>
<span class="c1">// public class Time {</span>
<span class="c1">//   private int hour;</span>
<span class="c1">//   private int minute;</span>
<span class="c1">//   public int hour();</span>
<span class="c1">//   public void hour_$eq(int);</span>
<span class="c1">//   public int minute();</span>
<span class="c1">//   public void minute_$eq(int);</span>
<span class="c1">//   public Time();</span>
<span class="c1">// }</span></code></pre>
</div>
</div>
</li>
<li>
<p>An interesting aspect about this expansion of vars into getters and setters is that <strong>you can also choose to define a getter and a setter directly</strong> instead of defining a var.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// How public vars are expanded into getter and setter methods.</span>
<span class="c1">//</span>
<span class="c1">// Scala's convention of always interpreting a variable as</span>
<span class="c1">//    a pair of setter and getter methods gives you in effect</span>
<span class="c1">//     the same capabilities as C# properties without</span>
<span class="k">class</span> <span class="nc">Time</span> <span class="o">{</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">h</span> <span class="k">=</span> <span class="mi">12</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">m</span> <span class="k">=</span> <span class="mi">0</span>

  <span class="k">def</span> <span class="nf">hour</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="n">h</span>
  <span class="k">def</span> <span class="nf">hour_=</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span> <span class="n">h</span> <span class="k">=</span> <span class="n">x</span> <span class="o">}</span>

  <span class="k">def</span> <span class="nf">minute</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="n">m</span>
  <span class="k">def</span> <span class="nf">minute_=</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span> <span class="n">m</span> <span class="k">=</span> <span class="n">x</span> <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Defining getter and setter methods directly.</span>
<span class="k">class</span> <span class="nc">Time</span> <span class="o">{</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">h</span> <span class="k">=</span> <span class="mi">12</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">m</span> <span class="k">=</span> <span class="mi">0</span>

  <span class="k">def</span> <span class="nf">hour</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="n">h</span>
  <span class="k">def</span> <span class="nf">hour_=</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
    <span class="nf">require</span><span class="o">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">h</span> <span class="o">&amp;&amp;</span> <span class="n">h</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="o">)</span>
    <span class="n">h</span> <span class="k">=</span> <span class="n">x</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">minute</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="n">m</span>
  <span class="k">def</span> <span class="nf">minute_=</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
    <span class="nf">require</span><span class="o">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">h</span> <span class="o">&amp;&amp;</span> <span class="n">h</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="o">)</span>
    <span class="n">m</span> <span class="k">=</span> <span class="n">x</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p>It is also possible, and sometimes useful, to <strong>define a getter and a setter without an associated field</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">t</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Thermometer</span>
<span class="n">t</span><span class="k">:</span> <span class="kt">Thermometer</span> <span class="o">=</span> <span class="mf">32.0F</span><span class="o">/</span><span class="mf">0.0</span><span class="n">C</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">t</span><span class="o">.</span><span class="py">celsius</span> <span class="k">=</span> <span class="mi">100</span>
<span class="nv">t</span><span class="o">.</span><span class="py">celsius</span><span class="k">:</span> <span class="kt">Float</span> <span class="o">=</span> <span class="mf">100.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">t</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">Thermometer</span> <span class="o">=</span> <span class="mf">212.0F</span><span class="o">/</span><span class="mf">100.0</span><span class="n">C</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">t</span><span class="o">.</span><span class="py">fahrenheit</span> <span class="k">=</span> <span class="o">-</span><span class="mi">40</span>
<span class="nv">t</span><span class="o">.</span><span class="py">fahrenheit</span><span class="k">:</span> <span class="kt">Float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">40.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">t</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Thermometer</span> <span class="o">=</span> <span class="o">-</span><span class="mf">40.0F</span><span class="o">/-</span><span class="mf">40.0</span><span class="n">C</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-parameterization">19. Type Parameterization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Type parameterization allows you to write <strong>generic classes and traits</strong>.</p>
</div>
<div class="sect2">
<h3 id="functional-queues">19.1. Functional queues</h3>
<div class="paragraph">
<p>A <strong>functional queue</strong> is a data structure with three operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>head</strong></p>
<div class="paragraph">
<p>returns the first element of the queue</p>
</div>
</li>
<li>
<p><strong>tail</strong></p>
<div class="paragraph">
<p>returns a queue without its first element</p>
</div>
</li>
<li>
<p><strong>enqueue</strong></p>
<div class="paragraph">
<p>returns a new queue with a given element appended at the end</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unlike a mutable queue, a functional queue does not change its contents when an element is appended.</p>
</div>
<div class="paragraph">
<p>One simple approach to implement a functional queue would be to use a list as representation type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">SlowAppendQueue</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">elems</span><span class="k">:</span> <span class="kt">T*</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// Not efficient</span>
  <span class="k">private</span> <span class="k">val</span> <span class="nv">list</span> <span class="k">=</span> <span class="nc">List</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">elems</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
  <span class="k">def</span> <span class="nf">head</span> <span class="k">=</span> <span class="nv">list</span><span class="o">.</span><span class="py">head</span>
  <span class="k">def</span> <span class="nf">tail</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SlowAppendQueue</span><span class="o">(</span><span class="nv">list</span><span class="o">.</span><span class="py">tail</span><span class="o">)</span>
  <span class="k">def</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">e</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SlowAppendQueue</span><span class="o">(</span><span class="n">list</span> <span class="o">:::</span> <span class="nc">List</span><span class="o">(</span><span class="n">e</span><span class="o">))</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="nv">list</span><span class="o">.</span><span class="py">mkString</span><span class="o">(</span><span class="s">"SlowAppendQueue("</span><span class="o">,</span> <span class="s">", "</span><span class="o">,</span> <span class="s">")"</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">SlowAppendQueue</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">elems</span><span class="k">:</span> <span class="kt">T*</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SlowAppendQueue</span><span class="o">(</span><span class="n">elems</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">type</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="nc">SlowAppendQueue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="k">val</span> <span class="nv">Queue</span> <span class="k">=</span> <span class="nc">SlowAppendQueue</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">q</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">q</span><span class="k">:</span> <span class="kt">SlowAppendQueue</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">SlowAppendQueue</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">q1</span> <span class="k">=</span> <span class="nv">q</span><span class="o">.</span><span class="py">enqueue</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span>
<span class="n">q1</span><span class="k">:</span> <span class="kt">SlowAppendQueue</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">SlowAppendQueue</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">q</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">SlowAppendQueue</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">SlowAppendQueue</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A basic functional queue.</span>
<span class="k">class</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span>
  <span class="k">private</span> <span class="k">val</span> <span class="nv">leading</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span>
  <span class="k">private</span> <span class="k">val</span> <span class="nv">tailing</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">)</span> <span class="o">{</span>

  <span class="k">private</span> <span class="k">def</span> <span class="nf">mirror</span> <span class="k">=</span>
    <span class="nf">if</span> <span class="o">(</span><span class="nv">leading</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span>
      <span class="k">new</span> <span class="nc">Queue</span><span class="o">(</span><span class="nv">tailing</span><span class="o">.</span><span class="py">reverse</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span>
    <span class="k">else</span>
      <span class="k">this</span>

  <span class="k">def</span> <span class="nf">head</span> <span class="k">=</span> <span class="nv">mirror</span><span class="o">.</span><span class="py">leading</span><span class="o">.</span><span class="py">head</span>

  <span class="k">def</span> <span class="nf">tail</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">q</span> <span class="k">=</span> <span class="n">mirror</span>
    <span class="k">new</span> <span class="nc">Queue</span><span class="o">(</span><span class="nv">q</span><span class="o">.</span><span class="py">leading</span><span class="o">.</span><span class="py">tail</span><span class="o">,</span> <span class="nv">q</span><span class="o">.</span><span class="py">tailing</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">e</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span>
    <span class="k">new</span> <span class="nc">Queue</span><span class="o">(</span><span class="n">leading</span><span class="o">,</span> <span class="n">e</span> <span class="o">::</span> <span class="n">tailing</span><span class="o">)</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">ls</span> <span class="k">=</span> <span class="nv">leading</span><span class="o">.</span><span class="py">mkString</span><span class="o">(</span><span class="s">"Queue("</span><span class="o">,</span> <span class="s">", "</span><span class="o">,</span> <span class="s">""</span><span class="o">)</span>
    <span class="k">val</span> <span class="nv">ts</span> <span class="k">=</span> <span class="nf">if</span> <span class="o">(</span><span class="nv">tailing</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span> <span class="s">")"</span> <span class="k">else</span> <span class="nv">tailing</span><span class="o">.</span><span class="py">reverse</span><span class="o">.</span><span class="py">mkString</span><span class="o">(</span><span class="s">","</span><span class="o">,</span> <span class="s">", "</span><span class="o">,</span> <span class="s">")"</span><span class="o">)</span>
    <span class="n">ls</span> <span class="o">+</span> <span class="n">ts</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">q</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Queue</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">),</span> <span class="nc">Nil</span><span class="o">)</span>
<span class="n">q</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">q1</span> <span class="k">=</span> <span class="nv">q</span><span class="o">.</span><span class="py">enqueue</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span>
<span class="n">q1</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">q</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="information-hiding">19.2. Information hiding</h3>
<div class="paragraph">
<p>The Queue constructor, which is globally accessible, takes two lists as parameters, where one is reversed—hardly an intuitive representation of a queue.</p>
</div>
<div class="sect3">
<h4 id="private-constructors-and-factory-methods">19.2.1. Private constructors and factory methods</h4>
<div class="paragraph">
<p>In Java, you can hide a constructor by making it <code>private</code>.</p>
</div>
<div class="paragraph">
<p>In Scala, the primary constructor does not have an explicit definition; it is defined implicitly by the class parameters and body. Nevertheless, it is still possible to hide the primary constructor by adding a private modifier in front of the class parameter list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Hiding a primary constructor by making it private.</span>
<span class="c1">//</span>
<span class="c1">// The private modifier between the class name and its parameters indicates that</span>
<span class="c1">//   the constructor of Queue is `private`:</span>
<span class="c1">//     it can be accessed only from within the class itself and its `companion object`.</span>
<span class="c1">//</span>
<span class="c1">// The class name Queue is still public, so you can use it as a type, but you cannot</span>
<span class="c1">//   call its constructor</span>
<span class="k">class</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="nc">private</span> <span class="o">(</span>
  <span class="k">private</span> <span class="k">val</span> <span class="nv">leading</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span>
  <span class="k">private</span> <span class="k">val</span> <span class="nv">trailing</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">new</span> <span class="nc">Queue</span><span class="o">(</span><span class="nc">Nil</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">constructor</span> <span class="kt">Queue</span> <span class="kt">in</span> <span class="kt">class</span> <span class="kt">Queue</span> <span class="kt">cannot</span> <span class="kt">be</span> <span class="kt">accessed</span> <span class="kt">in</span> <span class="kt">object</span> <span class="kt">$iw</span>
       <span class="k">new</span> <span class="nc">Queue</span><span class="o">(</span><span class="nc">Nil</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span>
       <span class="o">^</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>One possibility is to add an <strong>auxiliary constructor</strong>, like this:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">this</span><span class="o">()</span> <span class="k">=</span> <span class="nf">this</span><span class="o">(</span><span class="nc">Nil</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span>

<span class="k">def</span> <span class="nf">this</span><span class="o">(</span><span class="n">elems</span><span class="k">:</span> <span class="kt">T*</span><span class="o">)</span> <span class="k">=</span> <span class="nf">this</span><span class="o">(</span><span class="nv">elems</span><span class="o">.</span><span class="py">toList</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Another possibility is to add a <strong>factory method</strong> that builds a queue from such a sequence of initial elements.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// An apply factory method in a companion object.</span>
<span class="k">object</span> <span class="nc">Queue</span> <span class="o">{</span>
  <span class="c1">// constructs a queue with initial elements ‘ xs’</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">T*</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="nv">xs</span><span class="o">.</span><span class="py">toList</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p>An alternative: <strong>private classes</strong></p>
<div class="paragraph">
<p>Private constructors and private members are one way to hide the initialization and representation of a class.</p>
</div>
<div class="paragraph">
<p>Another, more radical way is to hide the class itself and only export a <code>trait</code> that reveals the public interface of the class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Type abstraction for functional queues.</span>
<span class="k">trait</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]{</span>
  <span class="k">def</span> <span class="nf">head</span><span class="k">:</span> <span class="kt">T</span>
  <span class="k">def</span> <span class="nf">tail</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
  <span class="k">def</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Queue</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">T*</span><span class="o">)</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span>
    <span class="k">new</span> <span class="nc">QueueImpl</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="nv">xs</span><span class="o">.</span><span class="py">toList</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span>

  <span class="k">private</span> <span class="k">class</span> <span class="nc">QueueImpl</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span>
    <span class="k">private</span> <span class="k">val</span> <span class="nv">leading</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span>
    <span class="k">private</span> <span class="k">val</span> <span class="nv">tailing</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
  <span class="o">)</span> <span class="k">extends</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

    <span class="k">private</span> <span class="k">def</span> <span class="nf">mirror</span> <span class="k">=</span>
      <span class="nf">if</span> <span class="o">(</span><span class="nv">tailing</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span>
        <span class="k">new</span> <span class="nc">QueueImpl</span><span class="o">(</span><span class="nv">tailing</span><span class="o">.</span><span class="py">reverse</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span>
      <span class="k">else</span>
        <span class="k">this</span>

    <span class="k">def</span> <span class="nf">head</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="nv">mirror</span><span class="o">.</span><span class="py">leading</span><span class="o">.</span><span class="py">head</span>

    <span class="k">def</span> <span class="nf">tail</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">QueueImpl</span><span class="o">(</span><span class="nv">mirror</span><span class="o">.</span><span class="py">leading</span><span class="o">.</span><span class="py">tail</span><span class="o">,</span> <span class="nv">mirror</span><span class="o">.</span><span class="py">tailing</span><span class="o">)</span>

    <span class="k">def</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">QueueImpl</span><span class="o">(</span><span class="n">leading</span><span class="o">,</span> <span class="n">x</span> <span class="o">::</span> <span class="n">tailing</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="variance-annotations">19.3. Variance annotations</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Queue is a trait, but not a type.</span>
<span class="k">trait</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Queue is not a type because it takes a <strong>type parameter</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">doesNotCompile</span><span class="o">(</span><span class="n">q</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">)</span> <span class="o">{}</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">12</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">trait</span> <span class="kt">Queue</span> <span class="kt">takes</span> <span class="k">type</span> <span class="kt">parameters</span>
       <span class="k">def</span> <span class="nf">doesNotCompile</span><span class="o">(</span><span class="n">q</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">)</span> <span class="o">{}</span>
                             <span class="o">^</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead, trait Queue enables you to specify <strong>parameterized types</strong>, such as Queue[String], Queue[Int], or Queue[AnyRef]:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">doesCompile</span><span class="o">(</span><span class="n">q</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">AnyRef</span><span class="o">])</span> <span class="o">{}</span>
<span class="n">doesCompile</span><span class="k">:</span> <span class="o">(</span><span class="kt">q:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">AnyRef</span><span class="o">])</span><span class="nc">Unit</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Thus, Queue is a trait, and <strong>Queue[String] is a type</strong>.</p>
</div>
</li>
<li>
<p>Queue is also called a <strong>type constructor</strong>, because with it you can construct a type by specifying a type parameter.</p>
<div class="paragraph">
<p>The type constructor Queue "generates" a family of types, which includes Queue[Int], Queue[String], and Queue[AnyRef].</p>
</div>
</li>
<li>
<p>You can also say that <strong>Queue is a generic trait</strong>.</p>
<div class="paragraph">
<p>(Classes and traits that take type parameters are "generic", but the types they generate are "parameterized", not generic.)</p>
</div>
<div class="paragraph">
<p>The term "generic" means that you are defining many specific types with one generically written class or trait.</p>
</div>
<div class="paragraph">
<p>For example, trait Queue defines a <strong>generic queue</strong>. Queue[Int] and Queue[String], etc., would be the <strong>specific queues</strong>.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The combination of type parameters and subtyping poses some interesting questions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For example, are there any special subtyping relationships between members of the family of types generated by Queue[T]?</p>
</li>
<li>
<p>More specifically, should a Queue[String] be considered a subtype of Queue[AnyRef]?</p>
</li>
<li>
<p>Or more generally, if S is a subtype of type T, then should Queue[S] be considered a subtype of Queue[T]?</p>
<div class="paragraph">
<p>If so, you could say that trait Queue is <strong>covariant (or "flexible") in its type parameter T</strong>.</p>
</div>
<div class="paragraph">
<p>Or, since it just has one type parameter, you could say simply that Queues are <strong>covariant</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">any</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Nil</span>
<span class="n">any</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">any</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"the"</span><span class="o">,</span> <span class="s">"Mayor"</span><span class="o">,</span> <span class="s">"Hotline"</span><span class="o">)</span>
<span class="n">any</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">the</span><span class="o">,</span> <span class="nc">Mayor</span><span class="o">,</span> <span class="nc">Hotline</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">any</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
<span class="n">any</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>In Scala, however, generic types have by default <strong>nonvariant</strong> (or, “rigid”) subtyping.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">q</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">Any</span><span class="o">]()</span>
<span class="n">q</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Queue$QueueImpl</span><span class="k">@</span><span class="mi">4</span><span class="n">a7645b</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">q</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">Int</span><span class="o">]()</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span>
 <span class="n">required</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span>
<span class="nc">Note</span><span class="k">:</span> <span class="kt">Int</span> <span class="k">&lt;:</span> <span class="kt">Any</span><span class="o">,</span> <span class="n">but</span> <span class="k">trait</span> <span class="nc">Queue</span> <span class="n">is</span> <span class="n">invariant</span> <span class="n">in</span> <span class="k">type</span> <span class="kt">T.</span>
<span class="kt">You</span> <span class="kt">may</span> <span class="kt">wish</span> <span class="kt">to</span> <span class="kt">define</span> <span class="kt">T</span> <span class="kt">as</span> <span class="kt">+T</span> <span class="kt">instead.</span> <span class="o">(</span><span class="kt">SLS</span> <span class="err">4</span><span class="kt">.</span><span class="err">5</span><span class="o">)</span>
       <span class="kt">q</span> <span class="o">=</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">Int</span><span class="o">]()</span>
                     <span class="o">^</span></code></pre>
</div>
</div>
</li>
<li>
<p>Prefixing a formal type parameter with a <strong>+</strong> indicates that subtyping is <strong>covariant</strong> (flexible) in that parameter.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">trait</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">+T</span><span class="o">]</span>

<span class="nc">object</span> <span class="nc">Queue</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">[</span><span class="kt">T</span><span class="o">]()</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">QueueImpl</span><span class="o">[</span><span class="kt">T</span><span class="o">]()</span>

  <span class="k">private</span> <span class="k">class</span> <span class="nc">QueueImpl</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="nc">extends</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">q</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span>
<span class="n">q</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Queue$QueueImpl</span><span class="k">@</span><span class="mi">2213</span><span class="n">b9e4</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">q</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span>
<span class="n">q</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Queue$QueueImpl</span><span class="k">@</span><span class="mf">34f</span><span class="n">b1849</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">q</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
<span class="n">q</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Queue$QueueImpl</span><span class="k">@</span><span class="mf">72f</span><span class="mi">10</span><span class="n">a4d</span></code></pre>
</div>
</div>
</li>
<li>
<p>Besides <strong>+</strong>, there is also a prefix <strong>-</strong>, which indicates <strong>contravariant</strong> subtyping.</p>
<div class="paragraph">
<p>If Queue were defined as <code>trait Queue[-T] { &#8230;&#8203; }</code>, then if T is a subtype of type S, this would imply that Queue[S] is a subtype of Queue[T] (which in the case of queues would be rather surprising!).</p>
</div>
</li>
<li>
<p>Whether a type parameter is <strong>covariant</strong>, <strong>contravariant</strong>, or <strong>nonvariant</strong> is called the parameter’s variance.</p>
</li>
<li>
<p>The <strong>+</strong> and <strong>-</strong> symbols you can place next to type parameters are called <strong>variance annotations</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A nonvariant (rigid) Cell class.</span>
<span class="k">class</span> <span class="nc">Cell</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">init</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">current</span> <span class="k">=</span> <span class="n">init</span>
  <span class="k">def</span> <span class="nf">get</span> <span class="k">=</span> <span class="n">current</span>
  <span class="k">def</span> <span class="nf">set</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="o">{</span> <span class="n">current</span> <span class="k">=</span> <span class="n">x</span> <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">c1</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Cell</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">"abc"</span><span class="o">)</span>
<span class="n">c1</span><span class="k">:</span> <span class="kt">Cell</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Cell</span><span class="k">@</span><span class="mf">44d</span><span class="n">ef1d4</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">c2</span><span class="k">:</span> <span class="kt">Cell</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="n">c1</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="kt">Cell</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
 <span class="n">required</span><span class="k">:</span> <span class="kt">Cell</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span>
<span class="nc">Note</span><span class="k">:</span> <span class="kt">String</span> <span class="k">&lt;:</span> <span class="kt">Any</span><span class="o">,</span> <span class="n">but</span> <span class="k">class</span> <span class="nc">Cell</span> <span class="n">is</span> <span class="n">invariant</span> <span class="n">in</span> <span class="k">type</span> <span class="kt">T.</span>
<span class="kt">You</span> <span class="kt">may</span> <span class="kt">wish</span> <span class="kt">to</span> <span class="kt">define</span> <span class="kt">T</span> <span class="kt">as</span> <span class="kt">+T</span> <span class="kt">instead.</span> <span class="o">(</span><span class="kt">SLS</span> <span class="err">4</span><span class="kt">.</span><span class="err">5</span><span class="o">)</span>
       <span class="kt">val</span> <span class="kt">c2:</span> <span class="kt">Cell</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="n">c1</span>
                           <span class="o">^</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">c2</span><span class="o">.</span><span class="py">set</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">12</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">not</span> <span class="kt">found:</span> <span class="kt">value</span> <span class="kt">c2</span>
       <span class="nv">c2</span><span class="o">.</span><span class="py">set</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
       <span class="o">^</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">s</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nv">c1</span><span class="o">.</span><span class="py">get</span>
<span class="n">s</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">abc</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="checking-variance-annotations">19.4. Checking variance annotations</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A covariant Cell class.</span>
<span class="k">class</span> <span class="nc">Cell</span><span class="o">[</span><span class="kt">+T</span><span class="o">](</span><span class="n">init</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">current</span> <span class="k">=</span> <span class="n">init</span>
  <span class="k">def</span> <span class="nf">get</span> <span class="k">=</span> <span class="n">current</span>
  <span class="c1">// error: covariant type T occurs in contravariant position in type T of value x</span>
  <span class="k">def</span> <span class="nf">set</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="o">{</span> <span class="n">current</span> <span class="k">=</span> <span class="n">x</span> <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A contravariant Cell class.</span>
<span class="k">class</span> <span class="nc">Cell</span><span class="o">[</span><span class="kt">-T</span><span class="o">](</span><span class="n">init</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">current</span> <span class="k">=</span> <span class="n">init</span>
  <span class="c1">// error: contravariant type T occurs in covariant position in type =&gt; T of method get</span>
  <span class="k">def</span> <span class="nf">get</span> <span class="k">=</span> <span class="n">current</span>
  <span class="k">def</span> <span class="nf">set</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="o">{</span> <span class="n">current</span> <span class="k">=</span> <span class="n">x</span> <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It turns out that as soon as a generic parameter type appears as the type of a method parameter, the containing class or trait may not be covariant in that type parameter.</p>
</div>
<div class="paragraph">
<p>To verify correctness of variance annotations, the Scala compiler classifies all positions in a class or trait body as <strong>positive</strong>, <strong>negative</strong>, or <strong>neutral</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A “position” is any location in the class (or trait, but from now on we’ll just write “class”) body where a type parameter may be used.</p>
</li>
<li>
<p>The compiler checks each use of each of the class’s type parameters.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Type parameters annotated with <strong>+</strong> may only be used in <strong>positive positions</strong>,</p>
</li>
<li>
<p>while type parameters annotated with <strong>-</strong> may only be used in <strong>negative positions</strong>.</p>
</li>
<li>
<p>A type parameter with no variance annotation may be used in <strong>any position</strong>, and is, therefore, the only kind of type parameter that can be used in neutral positions of the class body.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To classify the positions, the compiler starts from the declaration of a type parameter and then moves inward through deeper nesting levels.</p>
<div class="ulist">
<ul>
<li>
<p>Positions at the top level of the declaring class are classified as positive.</p>
</li>
<li>
<p>By default, positions at deeper nesting levels are classified the same as that at enclosing levels, but there are a handful of exceptions where the classification changes.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Method value parameter positions</strong> are classified to the flipped classification relative to positions outside the method, where the flip of a positive classification is negative, the flip of a negative classification is positive, and the flip of a neutral classification is still neutral.</p>
</li>
<li>
<p>Besides method value parameter positions, the current classification is also flipped at the <strong>type parameters of methods</strong>.</p>
</li>
<li>
<p>A classification is sometimes flipped at the type argument position of a type, such as the Arg in C[Arg], depending on the variance of the corresponding type parameter.</p>
<div class="ulist">
<ul>
<li>
<p>If C’s type parameter is annotated with a <strong>+</strong> then the classification stays the same.</p>
</li>
<li>
<p>If C’s type parameter is annotated with a <strong>-,</strong> then the current classification is flipped.</p>
</li>
<li>
<p>If C’s type parameter has no variance annotation then the current classification is changed to neutral.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="lower-bounds">19.5. Lower bounds</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A type parameter with a lower bound.</span>
<span class="k">class</span> <span class="nc">Cell</span><span class="o">[</span><span class="kt">+T</span><span class="o">](</span><span class="n">init</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">current</span> <span class="k">=</span> <span class="n">init</span>
  <span class="k">def</span> <span class="nf">get</span> <span class="k">=</span> <span class="n">current</span>

  <span class="c1">// error: covariant type T occurs in contravariant position in type T of value x</span>
  <span class="c1">// def set(x :T) { current = x }</span>
  <span class="c1">//</span>
  <span class="c1">// Correcting the variance error by adding a lower bound.</span>
  <span class="c1">//</span>
  <span class="c1">// The syntax "U &gt;: T", defines `T` as the lower bound for `U`.</span>
  <span class="c1">//   As a result, `U` is required to be a supertype of `T`.</span>
  <span class="c1">// The parameter to `set` is now of type `U` instead of `T`.</span>
  <span class="k">def</span> <span class="nf">set</span><span class="o">[</span><span class="kt">U</span> <span class="k">&gt;:</span> <span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">U</span><span class="o">)</span><span class="k">:</span> <span class="kt">Cell</span><span class="o">[</span><span class="kt">U</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Cell</span><span class="o">[</span><span class="kt">U</span><span class="o">](</span><span class="n">x</span><span class="o">)</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="nv">current</span><span class="o">.</span><span class="py">toString</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">nums</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Cell</span><span class="o">[</span><span class="kt">Any</span><span class="o">](</span><span class="mf">1.2345</span><span class="o">)</span>
<span class="n">nums</span><span class="k">:</span> <span class="kt">Cell</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="mf">1.2345</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">nums</span> <span class="k">=</span> <span class="nv">nums</span><span class="o">.</span><span class="py">set</span><span class="o">(</span><span class="s">"the Mayor Hotline"</span><span class="o">)</span>
<span class="n">nums</span><span class="k">:</span> <span class="kt">Cell</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span> <span class="n">the</span> <span class="nc">Mayor</span> <span class="nc">Hotline</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="contravariance">19.6. Contravariance</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A contravariant output channel.</span>
<span class="k">trait</span> <span class="nc">OutputChannel</span><span class="o">[</span><span class="kt">-T</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">write</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, <code>OutputChannel</code> is defined to be <strong>contravariant</strong> in T. So an output channel of AnyRefs, say, is a subtype of an output channel of Strings.</p>
</div>
<div class="paragraph">
<p>This reasoning points to a general principle in type system design:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>it is safe to assume that a type T is a subtype of a type U if you can substitute a value of type T wherever a value of type U is required.</p>
</div>
</blockquote>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Liskov Substitution Principle:</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>if T supports the same operations as U and all of T’s operations require less and provide more than the corresponding operations in U.</p>
</div>
</blockquote>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Sometimes <strong>covariance and contravariance are mixed</strong> in the same type.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A prominent example is Scala’s function traits.</p>
<div class="paragraph">
<p>For instance, whenever you write the function type <code>A =&gt; B</code>, Scala expands this to <code>Function1[A, B]</code>.</p>
</div>
<div class="paragraph">
<p>The Function1 in the standard library uses both covariance and contravariance: the Function1 trait is <strong>contravariant in the function argument type S</strong> and <strong>covariant in the result type T</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Covariance and contravariance of Function1s.</span>
<span class="k">trait</span> <span class="nc">Function1</span><span class="o">[</span><span class="kt">-S</span>, <span class="kt">+T</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">S</span><span class="o">)</span><span class="k">:</span> <span class="kt">T</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="object-private-data">19.7. Object private data</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// An optimized functional queue.</span>
<span class="c1">//</span>
<span class="c1">// What’s different with respect to the previous version is that now `leading` and `trailing` are</span>
<span class="c1">// reassignable variables, and `mirror` performs the reverse copy from `trailing` to `leading` as</span>
<span class="c1">// a side-effect on the current queue instead of returning a new queue.</span>
<span class="c1">// This side-effect is purely internal to the implementation of the `Queue` operation;</span>
<span class="c1">// since `leading` and `trailing` are private variables, the effect is not visible to clients of `Queue`.</span>
<span class="k">class</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">+T</span><span class="o">]</span> <span class="nc">private</span> <span class="o">(</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">leading</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">trailing</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">){</span>

  <span class="k">private</span> <span class="k">def</span> <span class="nf">mirror</span><span class="o">()</span> <span class="k">=</span>
    <span class="nf">if</span> <span class="o">(</span><span class="nv">leading</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span> <span class="o">{</span>
      <span class="nf">while</span> <span class="o">(!</span><span class="nv">trailing</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">leading</span> <span class="k">=</span> <span class="nv">trailing</span><span class="o">.</span><span class="py">head</span> <span class="o">::</span> <span class="n">leading</span>
        <span class="n">trailing</span> <span class="k">=</span> <span class="nv">trailing</span><span class="o">.</span><span class="py">tail</span>
      <span class="o">}</span>
    <span class="o">}</span>

  <span class="k">def</span> <span class="nf">head</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nf">mirror</span><span class="o">()</span>
    <span class="nv">leading</span><span class="o">.</span><span class="py">head</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">tail</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="nf">mirror</span><span class="o">()</span>
    <span class="k">new</span> <span class="nc">Queue</span><span class="o">(</span><span class="nv">leading</span><span class="o">.</span><span class="py">tail</span><span class="o">,</span> <span class="n">trailing</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">enqueue</span><span class="o">[</span><span class="kt">U</span> <span class="k">&gt;:</span> <span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">U</span><span class="o">)</span> <span class="k">=</span>
    <span class="k">new</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">U</span><span class="o">](</span><span class="n">leading</span><span class="o">,</span> <span class="n">x</span> <span class="o">::</span> <span class="n">trailing</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Another optimized functional queue.</span>
<span class="k">trait</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">+T</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">head</span><span class="k">:</span> <span class="kt">T</span>

  <span class="k">def</span> <span class="nf">tail</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">enqueue</span><span class="o">[</span><span class="kt">U</span> <span class="k">&gt;:</span> <span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">U</span><span class="o">)</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">U</span><span class="o">]</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Queue</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">elms</span><span class="k">:</span> <span class="kt">T*</span><span class="o">)</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">QueueImpl</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="nc">List</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">elms</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">),</span> <span class="nc">Nil</span><span class="o">)</span>

  <span class="k">private</span> <span class="k">class</span> <span class="nc">QueueImpl</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">ls</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span> <span class="n">ts</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>
    <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">leading</span> <span class="k">=</span> <span class="n">ls</span>
    <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">var</span> <span class="n">tailing</span> <span class="k">=</span> <span class="n">ts</span>

    <span class="k">private</span> <span class="k">def</span> <span class="nf">mirror</span><span class="o">()</span> <span class="o">{</span>
      <span class="nf">if</span> <span class="o">(</span><span class="nv">leading</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span> <span class="o">{</span>
        <span class="nf">while</span><span class="o">(!</span><span class="nv">tailing</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">leading</span> <span class="k">=</span> <span class="nv">tailing</span><span class="o">.</span><span class="py">head</span> <span class="o">::</span> <span class="n">leading</span>
          <span class="n">tailing</span> <span class="k">=</span> <span class="nv">tailing</span><span class="o">.</span><span class="py">tail</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>

    <span class="k">def</span> <span class="nf">head</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="o">{</span>
      <span class="nf">mirror</span><span class="o">()</span>
      <span class="nv">leading</span><span class="o">.</span><span class="py">head</span>
    <span class="o">}</span>

    <span class="k">def</span> <span class="nf">tail</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
      <span class="nf">mirror</span><span class="o">()</span>
      <span class="k">new</span> <span class="nc">QueueImpl</span><span class="o">(</span><span class="nv">leading</span><span class="o">.</span><span class="py">tail</span><span class="o">,</span> <span class="n">tailing</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="c1">// def enqueue(x: T): Queue[T] = new QueueImpl(leading, x :: tailing)</span>
    <span class="k">def</span> <span class="nf">enqueue</span><span class="o">[</span><span class="kt">U</span> <span class="k">&gt;:</span> <span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">U</span><span class="o">)</span><span class="k">:</span> <span class="kt">Queue</span><span class="o">[</span><span class="kt">U</span><span class="o">]</span> <span class="k">=</span>  <span class="k">new</span> <span class="nc">QueueImpl</span><span class="o">(</span><span class="n">leading</span><span class="o">,</span> <span class="n">x</span> <span class="o">::</span> <span class="n">tailing</span><span class="o">)</span>

    <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="nv">ls</span> <span class="k">=</span> <span class="nv">leading</span><span class="o">.</span><span class="py">mkString</span><span class="o">(</span><span class="s">"Queue("</span><span class="o">,</span> <span class="s">", "</span><span class="o">,</span> <span class="s">""</span><span class="o">)</span>
      <span class="k">val</span> <span class="nv">ts</span> <span class="k">=</span> <span class="nf">if</span> <span class="o">(</span><span class="nv">tailing</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span> <span class="s">")"</span>
      <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="nv">leading</span><span class="o">.</span><span class="py">isEmpty</span><span class="o">)</span> <span class="nv">tailing</span><span class="o">.</span><span class="py">reverse</span><span class="o">.</span><span class="py">mkString</span><span class="o">(</span><span class="s">""</span><span class="o">,</span> <span class="s">", "</span><span class="o">,</span> <span class="s">")"</span><span class="o">)</span>
      <span class="k">else</span> <span class="nv">tailing</span><span class="o">.</span><span class="py">reverse</span><span class="o">.</span><span class="py">mkString</span><span class="o">(</span><span class="s">", "</span><span class="o">,</span> <span class="s">", "</span><span class="o">,</span> <span class="s">")"</span><span class="o">)</span>
      <span class="n">ls</span> <span class="o">+</span> <span class="n">ts</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">trait</span> <span class="nc">Fruit</span>

<span class="k">class</span> <span class="nc">Apple</span> <span class="k">extends</span> <span class="nc">Fruit</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="s">"Apple"</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Pear</span> <span class="k">extends</span> <span class="nc">Fruit</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="s">"Pear"</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Banana</span> <span class="k">extends</span> <span class="nc">Fruit</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="s">"Banana"</span>
<span class="o">}</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">var</span> <span class="n">qs</span> <span class="k">=</span> <span class="nc">Queue</span><span class="o">[</span><span class="kt">Fruit</span><span class="o">]()</span> <span class="o">::</span> <span class="nc">Nil</span>
<span class="n">qs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Queue</span><span class="o">[</span><span class="kt">Fruit</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">Queue</span><span class="o">())</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">qs</span> <span class="k">=</span> <span class="nv">qs</span><span class="o">.</span><span class="py">head</span><span class="o">.</span><span class="py">enqueue</span><span class="o">(</span><span class="k">new</span> <span class="nc">Apple</span><span class="o">)</span> <span class="o">::</span> <span class="n">qs</span>
<span class="n">qs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Queue</span><span class="o">[</span><span class="kt">Fruit</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">Queue</span><span class="o">(</span><span class="nc">Apple</span><span class="o">),</span> <span class="nc">Queue</span><span class="o">())</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">qs</span> <span class="k">=</span> <span class="nv">qs</span><span class="o">.</span><span class="py">head</span><span class="o">.</span><span class="py">enqueue</span><span class="o">(</span><span class="k">new</span> <span class="nc">Pear</span><span class="o">)</span> <span class="o">::</span> <span class="n">qs</span>
<span class="n">qs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Queue</span><span class="o">[</span><span class="kt">Fruit</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">Queue</span><span class="o">(</span><span class="nc">Apple</span><span class="o">,</span> <span class="nc">Pear</span><span class="o">),</span> <span class="nc">Queue</span><span class="o">(</span><span class="nc">Apple</span><span class="o">),</span> <span class="nc">Queue</span><span class="o">())</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">qs</span> <span class="k">=</span> <span class="nv">qs</span><span class="o">.</span><span class="py">head</span><span class="o">.</span><span class="py">enqueue</span><span class="o">(</span><span class="k">new</span> <span class="nc">Banana</span><span class="o">)</span> <span class="o">::</span> <span class="n">qs</span>
<span class="n">qs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Queue</span><span class="o">[</span><span class="kt">Fruit</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">Queue</span><span class="o">(</span><span class="nc">Apple</span><span class="o">,</span> <span class="nc">Pear</span><span class="o">,</span> <span class="nc">Banana</span><span class="o">),</span> <span class="nc">Queue</span><span class="o">(</span><span class="nc">Apple</span><span class="o">,</span> <span class="nc">Pear</span><span class="o">),</span> <span class="nc">Queue</span><span class="o">(</span><span class="nc">Apple</span><span class="o">),</span> <span class="nc">Queue</span><span class="o">())</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">qs</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="nc">Queue</span><span class="o">(</span><span class="nc">Apple</span><span class="o">,</span> <span class="nc">Pear</span><span class="o">,</span> <span class="nc">Banana</span><span class="o">)</span>
<span class="nc">Queue</span><span class="o">(</span><span class="nc">Apple</span><span class="o">,</span> <span class="nc">Pear</span><span class="o">)</span>
<span class="nc">Queue</span><span class="o">(</span><span class="nc">Apple</span><span class="o">)</span>
<span class="nc">Queue</span><span class="o">()</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="upper-bounds">19.8. Upper bounds</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A merge sort function with an upper bound.</span>
<span class="k">def</span> <span class="nf">orderedMergeSort</span><span class="o">[</span><span class="kt">T</span> <span class="k">&lt;:</span> <span class="kt">Ordered</span><span class="o">[</span><span class="kt">T</span><span class="o">]](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">merge</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span> <span class="n">ys</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="o">(</span><span class="n">xs</span><span class="o">,</span> <span class="n">ys</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
      <span class="nf">case</span> <span class="o">(</span><span class="nc">Nil</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">ys</span>
      <span class="nf">case</span> <span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">xs</span>
      <span class="nf">case</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">xs1</span><span class="o">,</span> <span class="n">y</span> <span class="o">::</span> <span class="n">ys1</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
        <span class="nf">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">x</span> <span class="o">::</span> <span class="nf">merge</span><span class="o">(</span><span class="n">xs1</span><span class="o">,</span> <span class="n">ys</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
          <span class="n">y</span> <span class="o">::</span> <span class="nf">merge</span><span class="o">(</span><span class="n">xs</span><span class="o">,</span> <span class="n">ys1</span><span class="o">)</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">val</span> <span class="nv">n</span> <span class="k">=</span> <span class="nv">xs</span><span class="o">.</span><span class="py">length</span> <span class="o">/</span> <span class="mi">2</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="n">xs</span>
  <span class="k">else</span> <span class="o">{</span>
    <span class="nf">val</span> <span class="o">(</span><span class="n">ys</span><span class="o">,</span> <span class="n">zs</span><span class="o">)</span> <span class="k">=</span> <span class="nv">xs</span><span class="o">.</span><span class="py">splitAt</span><span class="o">(</span><span class="n">n</span><span class="o">)</span>
    <span class="nf">merge</span><span class="o">(</span><span class="nf">orderedMergeSort</span><span class="o">(</span><span class="n">ys</span><span class="o">),</span> <span class="nf">orderedMergeSort</span><span class="o">(</span><span class="n">zs</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">case</span> <span class="k">class</span> <span class="nc">OrderedInt</span><span class="o">(</span><span class="n">v</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Ordered</span><span class="o">[</span><span class="kt">OrderedInt</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">compare</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">OrderedInt</span><span class="o">)</span> <span class="k">=</span> <span class="n">v</span> <span class="o">-</span> <span class="nv">that</span><span class="o">.</span><span class="py">v</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="nv">v</span><span class="o">.</span><span class="py">toString</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">nums</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">2</span><span class="o">).</span><span class="py">map</span><span class="o">(</span><span class="k">new</span> <span class="nc">OrderedInt</span><span class="o">(</span><span class="k">_</span><span class="o">))</span>
<span class="k">val</span> <span class="nv">hotline</span> <span class="k">=</span> <span class="nf">orderedMergeSort</span><span class="o">(</span><span class="n">nums</span><span class="o">).</span><span class="py">mkString</span>
<span class="nf">println</span><span class="o">(</span><span class="n">hotline</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="abstract-members">20. Abstract Members</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A member of a class or trait is <strong>abstract</strong> if the member does not have a complete definition in the class. Abstract members are intended to be implemented in subclasses of the class in which they are declared.</p>
</div>
<div class="sect2">
<h3 id="a-quick-tour-of-abstract-members">20.1. A quick tour of abstract members</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">trait</span> <span class="nc">Abstract</span> <span class="o">{</span>
  <span class="k">type</span> <span class="kt">T</span>
  <span class="k">def</span> <span class="nf">transform</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span><span class="k">:</span> <span class="kt">T</span>
  <span class="k">val</span> <span class="nv">initial</span><span class="k">:</span> <span class="kt">T</span>
  <span class="k">var</span> <span class="n">current</span><span class="k">:</span> <span class="kt">T</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">Concrete</span> <span class="k">extends</span> <span class="nc">Abstract</span> <span class="o">{</span>
  <span class="k">type</span> <span class="kt">T</span> <span class="o">=</span> <span class="nc">String</span>
  <span class="k">def</span> <span class="nf">transform</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span>
  <span class="k">val</span> <span class="nv">initial</span> <span class="k">=</span> <span class="s">"hi"</span>
  <span class="k">var</span> <span class="n">current</span> <span class="k">=</span> <span class="n">initial</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type-members">20.2. Type members</h3>
<div class="paragraph">
<p>The term <strong>abstract type</strong> in Scala means a type declared (with the “<strong>type</strong>” keyword) to be a member of a class or trait, without specifying a definition.</p>
</div>
</div>
<div class="sect2">
<h3 id="abstract-vals">20.3. Abstract vals</h3>
<div class="paragraph">
<p>An abstract val declaration has a form like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">val</span> <span class="nv">initial</span><span class="k">:</span> <span class="kt">String</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It gives a name and type for a val, but not its value. This value has to be provided by a concrete val definition in a subclass.</p>
</div>
<div class="paragraph">
<p>You use an abstract val declaration in a class when you do not know the correct value in the class, but you do know that the variable will have an unchangeable value in each instance of the class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Overriding abstract vals and parameterless methods.</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Fruit</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">v</span><span class="k">:</span> <span class="kt">String</span> <span class="c1">// ‘v’ for value</span>
  <span class="k">def</span> <span class="nf">m</span><span class="k">:</span> <span class="kt">String</span> <span class="c1">// ‘m’ for method</span>
<span class="o">}</span>

<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Apple</span> <span class="k">extends</span> <span class="nc">Fruit</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">v</span><span class="k">:</span> <span class="kt">String</span>
  <span class="k">val</span> <span class="nv">m</span><span class="k">:</span> <span class="kt">String</span> <span class="c1">// OK to override a ‘def’ with a ‘val’</span>
<span class="o">}</span>

<span class="k">abstract</span> <span class="k">class</span> <span class="nc">BadApple</span> <span class="k">extends</span> <span class="nc">Fruit</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">v</span><span class="k">:</span> <span class="kt">String</span> <span class="c1">// ERROR: cannot override a ‘val’ with a ‘def’</span>
  <span class="k">def</span> <span class="nf">m</span><span class="k">:</span> <span class="kt">String</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="abstract-vars">20.4. Abstract vars</h3>
<div class="paragraph">
<p>Like an abstract val, an abstract var declares just a name and a type, but not an initial value, that declared as members of classes come equipped with <strong>getter</strong> and <strong>setter</strong> methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Declaring abstract vars.</span>
<span class="c1">//</span>
<span class="c1">// How abstract vars are expanded into getters and setters.</span>
<span class="c1">// trait AbstractTime {</span>
<span class="c1">//   def hour: Int			// getter for ‘hour’</span>
<span class="c1">//   def hour_=(x: Int) 	// setter for ‘hour’</span>
<span class="c1">//   def minute: Int 		// getter for ‘minute’</span>
<span class="c1">//   def minute_=(x: Int) 	// setter for ‘minute’</span>
<span class="c1">// }</span>
<span class="c1">//</span>
<span class="c1">// $ javap -p AbstractTime</span>
<span class="c1">// public interface AbstractTime {</span>
<span class="c1">//   public abstract int hour();</span>
<span class="c1">//   public abstract void hour_$eq(int);</span>
<span class="c1">//   public abstract int minute();</span>
<span class="c1">//   public abstract void minute_$eq(int);</span>
<span class="c1">// }</span>
<span class="k">trait</span> <span class="nc">AbstractTime</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">hour</span><span class="k">:</span> <span class="kt">Int</span>
  <span class="k">var</span> <span class="n">minute</span><span class="k">:</span> <span class="kt">Int</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Time</span><span class="o">(</span><span class="k">private</span> <span class="k">var</span> <span class="n">h</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="k">private</span> <span class="k">var</span> <span class="n">m</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">AbstractTime</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">hour</span> <span class="k">=</span> <span class="n">h</span>
  <span class="k">def</span> <span class="nf">hour_=</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span> <span class="n">h</span> <span class="k">=</span> <span class="n">x</span> <span class="o">}</span>

  <span class="k">def</span> <span class="nf">minute</span> <span class="k">=</span> <span class="n">m</span>
  <span class="k">def</span> <span class="nf">minute_=</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span> <span class="n">m</span> <span class="k">=</span> <span class="n">x</span> <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="initializing-abstract-vals">20.5. Initializing abstract vals</h3>
<div class="ulist">
<ul>
<li>
<p>A <strong>class parameter</strong> argument is evaluated <strong>before</strong> it is passed to the class constructor (unless the parameter is by-name).</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">NotZeroClass</span><span class="o">(</span><span class="k">val</span> <span class="nv">num</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
  <span class="nf">require</span><span class="o">(</span><span class="n">num</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">,</span> <span class="s">"num could't be zero."</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// OK</span>
<span class="k">new</span> <span class="nc">NotZeroClass</span><span class="o">(</span><span class="mi">10</span><span class="o">){</span>
<span class="o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p>An <strong>implementing val definition</strong> in a subclass, by contrast, is evaluated only <strong>after</strong> the superclass has been initialized.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">trait</span> <span class="nc">RationalTrait</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">numerVal</span><span class="k">:</span> <span class="kt">Int</span>
  <span class="k">val</span> <span class="nv">denomVal</span><span class="k">:</span> <span class="kt">Int</span>
  <span class="nf">require</span><span class="o">(</span><span class="n">denomVal</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">,</span> <span class="s">"denomVal couldn't be zero."</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// java.lang.IllegalArgumentException: requirement failed: denomVal couldn't be zero.</span>
<span class="c1">//</span>
<span class="c1">// This expression yields an instance of an *anonymous class* that mixes in the trait</span>
<span class="c1">//  and is defined by the body.</span>
<span class="c1">//</span>
<span class="c1">// The anonymous class is initialized after the `RationalTrait`.</span>
<span class="k">new</span> <span class="nc">RationalTrait</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">numerVal</span> <span class="k">=</span> <span class="mi">1</span>
  <span class="k">val</span> <span class="nv">denomVal</span> <span class="k">=</span> <span class="mi">3</span>
<span class="o">}</span>

<span class="c1">// The subclass is initialized after the `RationalTrait`.</span>
<span class="k">class</span> <span class="nc">RationalClass</span><span class="o">(</span><span class="n">numer</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">denom</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">RationalTrait</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">numerVal</span> <span class="k">=</span> <span class="n">numer</span>
  <span class="k">val</span> <span class="nv">denomVal</span> <span class="k">=</span> <span class="n">denom</span>
<span class="o">}</span>

<span class="c1">// java.lang.IllegalArgumentException: requirement failed: denomVal couldn't be zero.</span>
<span class="k">new</span> <span class="nc">RationalClass</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">RationalClass</span><span class="o">(</span><span class="n">numer</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">denom</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">numerVal</span> <span class="k">=</span> <span class="n">numer</span>
  <span class="k">val</span> <span class="nv">denomVal</span> <span class="k">=</span> <span class="n">denom</span>
  <span class="nf">require</span><span class="o">(</span><span class="n">denomVal</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">,</span> <span class="s">"denomVal couldn't be zero."</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// OK</span>
<span class="k">new</span> <span class="nc">RationalClass</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">)}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="pre-initialized-fields">20.5.1. Pre-initialized fields</h4>
<div class="ulist">
<ul>
<li>
<p>The <strong>pre-initialized fields</strong>, lets you initialize a field of a subclass before the superclass is called.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">//  Pre-initialized fields in an anonymous class expression.</span>
<span class="k">new</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">numerVal</span> <span class="k">=</span> <span class="mi">1</span>
  <span class="k">val</span> <span class="nv">denomVal</span> <span class="k">=</span> <span class="mi">3</span>
<span class="o">}</span> <span class="k">with</span> <span class="nc">RationalTrait</span></code></pre>
</div>
</div>
</li>
<li>
<p>Pre-initialized fields are not restricted to anonymous classes; they can also be used in objects or named subclasses.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">//  Pre-initialized fields in an object expression.</span>
<span class="k">object</span> <span class="nc">oneThirds</span> <span class="k">extends</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">numerVal</span> <span class="k">=</span> <span class="mi">1</span>
  <span class="k">val</span> <span class="nv">denomVal</span> <span class="k">=</span> <span class="mi">3</span>
<span class="o">}</span> <span class="k">with</span> <span class="nc">RationalTrait</span>

<span class="c1">//  Pre-initialized fields in an named subclass expression.</span>
<span class="k">class</span> <span class="nc">RationalClass</span> <span class="o">(</span><span class="n">numer</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">denom</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">numerVal</span> <span class="k">=</span> <span class="n">numer</span>
  <span class="k">val</span> <span class="nv">denomVal</span> <span class="k">=</span> <span class="n">denom</span>
<span class="o">}</span> <span class="k">with</span> <span class="nc">RationalTrait</span>

<span class="c1">// OK</span>
<span class="k">new</span> <span class="nc">RationalClass</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Because pre-initialized fields are initialized before the superclass constructor is called, their initializers cannot refer to the object that’s being constructed.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">new</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">numerVal</span> <span class="k">=</span> <span class="mi">1</span>
  <span class="c1">// error: value numerVal is not a member of AnyRef{abstract trait RationalTrait extends AnyRef}</span>
  <span class="k">val</span> <span class="nv">denomVal</span> <span class="k">=</span> <span class="k">this</span><span class="o">.</span><span class="py">numerVal</span> <span class="o">+</span> <span class="mi">2</span>
<span class="o">}</span> <span class="k">with</span> <span class="nc">RationalTrait</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="lazy-vals">20.5.2. Lazy vals</h4>
<div class="paragraph">
<p>If you prefix a val definition with a <strong>lazy</strong> modifier, the initializing expression on the right-hand side will only be evaluated the first time the val is used, never evaluated more than once.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">object</span> <span class="nc">Demo</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">x</span> <span class="k">=</span> <span class="o">{</span> <span class="nf">println</span><span class="o">(</span><span class="s">"initializing x"</span><span class="o">);</span> <span class="s">"done"</span> <span class="o">}</span>
<span class="o">}</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">Demo</span>
<span class="n">initializing</span> <span class="n">x</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">Demo.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">Demo</span><span class="n">$</span><span class="k">@</span><span class="mf">2262d6d</span><span class="mi">5</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">Demo</span><span class="o">.</span><span class="py">x</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">done</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">object</span> <span class="nc">Demo</span> <span class="o">{</span>
  <span class="k">lazy</span> <span class="k">val</span> <span class="nv">x</span> <span class="k">=</span> <span class="o">{</span> <span class="nf">println</span><span class="o">(</span><span class="s">"initializing x"</span><span class="o">);</span> <span class="s">"done"</span> <span class="o">}</span>
<span class="o">}</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">Demo</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Demo.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">Demo</span><span class="n">$</span><span class="k">@</span><span class="mi">54</span><span class="n">c11750</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">Demo</span><span class="o">.</span><span class="py">x</span>
<span class="n">initializing</span> <span class="n">x</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">done</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Lazy functional languages</div>
<div class="paragraph">
<p>Scala is by no means the first language to have exploited the perfect match of lazy definitions and functional code.</p>
</div>
<div class="paragraph">
<p>In fact, there is a category of “lazy functional programming languages” in which every value and parameter is initialized lazily.</p>
</div>
<div class="paragraph">
<p>The best known member of this class of languages is <strong>Haskell</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="abstract-types">20.6. Abstract types</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">Food</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Animal</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">eat</span><span class="o">(</span><span class="n">food</span><span class="k">:</span> <span class="kt">Food</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Grass</span> <span class="k">extends</span> <span class="nc">Food</span>
<span class="c1">// error: class Cow needs to be abstract, since method eat</span>
<span class="c1">//   in class Animal of type (food: Food)Unit is not defined</span>
<span class="k">class</span> <span class="nc">Cow</span> <span class="k">extends</span> <span class="nc">Animal</span> <span class="o">{</span>
  <span class="c1">// error: method eat overrides nothing.</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">eat</span><span class="o">(</span><span class="n">food</span><span class="k">:</span> <span class="kt">Grass</span><span class="o">)</span> <span class="o">{}</span> <span class="c1">// not complie</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">Food</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Animal</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">eat</span><span class="o">(</span><span class="n">food</span><span class="k">:</span> <span class="kt">Food</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Grass</span> <span class="k">extends</span> <span class="nc">Food</span>
<span class="k">class</span> <span class="nc">Cow</span> <span class="k">extends</span> <span class="nc">Animal</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">eat</span><span class="o">(</span><span class="n">food</span><span class="k">:</span> <span class="kt">Grass</span><span class="o">)</span> <span class="o">{}</span>  <span class="c1">// not complie</span>
<span class="o">}</span>                                   <span class="c1">// but if it dit ...</span>

<span class="k">class</span> <span class="nc">Fish</span> <span class="k">extends</span> <span class="nc">Food</span>

<span class="k">val</span> <span class="nv">bessy</span><span class="k">:</span> <span class="kt">Animal</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cow</span>
<span class="nv">bessy</span><span class="o">.</span><span class="py">eat</span><span class="o">(</span><span class="k">new</span> <span class="nc">Fish</span><span class="o">)</span>                 <span class="c1">// ...you cloud feed fish to cows.</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// generics: type parameterization</span>
<span class="k">class</span> <span class="nc">Food</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Animal</span><span class="o">[</span><span class="kt">+T</span> <span class="k">&lt;:</span> <span class="kt">Food</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">eat</span><span class="o">[</span><span class="kt">U</span> <span class="k">&gt;:</span> <span class="kt">T</span><span class="o">](</span><span class="n">food</span><span class="k">:</span> <span class="kt">U</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Grass</span> <span class="k">extends</span> <span class="nc">Food</span>
<span class="k">class</span> <span class="nc">Cow</span> <span class="k">extends</span> <span class="nc">Animal</span><span class="o">[</span><span class="kt">Grass</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">eat</span><span class="o">[</span><span class="kt">Grass</span><span class="o">](</span><span class="n">food</span><span class="k">:</span> <span class="kt">Grass</span><span class="o">)</span> <span class="o">{}</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Fish</span> <span class="k">extends</span> <span class="nc">Food</span>

<span class="k">val</span> <span class="nv">bessy</span><span class="k">:</span> <span class="kt">Animal</span><span class="o">[</span><span class="kt">Food</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Cow</span>
<span class="nv">bessy</span><span class="o">.</span><span class="py">eat</span><span class="o">(</span><span class="k">new</span> <span class="nc">Grass</span><span class="o">)</span> <span class="c1">// OK</span>

<span class="nv">bessy</span><span class="o">.</span><span class="py">eat</span><span class="o">(</span><span class="k">new</span> <span class="nc">Fish</span><span class="o">)</span>   <span class="c1">// ...you could feed fish to cows.</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// What you need to do instead is apply some more precise modeling.</span>
<span class="c1">// Animals do eat Food, but what kind of Food each Animal eats depends on the Animal.</span>
<span class="k">class</span> <span class="nc">Food</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Animal</span> <span class="o">{</span>
  <span class="c1">// Modeling suitable food with an abstract type.</span>
  <span class="k">type</span> <span class="kt">Feed</span> <span class="k">&lt;:</span> <span class="kt">Food</span>
  <span class="k">def</span> <span class="nf">eat</span><span class="o">(</span><span class="n">food</span><span class="k">:</span> <span class="kt">Feed</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Grass</span> <span class="k">extends</span> <span class="nc">Food</span>
<span class="k">class</span> <span class="nc">Cow</span> <span class="k">extends</span> <span class="nc">Animal</span> <span class="o">{</span>
  <span class="k">type</span> <span class="kt">Feed</span> <span class="o">=</span> <span class="nc">Grass</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">eat</span><span class="o">(</span><span class="n">food</span><span class="k">:</span> <span class="kt">Grass</span><span class="o">)</span> <span class="o">{}</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Fish</span> <span class="k">extends</span> <span class="nc">Food</span>

<span class="c1">// A refinement type that make animal that eats grass.</span>
<span class="k">val</span> <span class="nv">bessy</span><span class="k">:</span> <span class="kt">Animal</span> <span class="o">{</span> <span class="k">type</span> <span class="kt">Feed</span> <span class="o">=</span> <span class="kt">Grass</span> <span class="o">}</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Cow</span>
<span class="c1">// you could feed grass to cows.</span>
<span class="nv">bessy</span><span class="o">.</span><span class="py">eat</span><span class="o">(</span><span class="k">new</span> <span class="nc">Grass</span><span class="o">)</span> <span class="c1">// OK</span>

<span class="c1">// error: type mismatch;</span>
<span class="c1">//  found   : this.Fish</span>
<span class="c1">//  required: this.bessy.Feed</span>
<span class="c1">//     (which expands to)  this.Grass</span>
<span class="nv">bessy</span><span class="o">.</span><span class="py">eat</span><span class="o">(</span><span class="k">new</span> <span class="nc">Fish</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="path-dependent-types">20.7. Path-dependent types</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">val</span> <span class="nv">buggy</span><span class="k">:</span> <span class="kt">Animal</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cow</span>
<span class="c1">// error: type mismatch;</span>
<span class="c1">//  found   : this.Grass</span>
<span class="c1">//  required: this.buggy.Feed</span>
<span class="nv">buggy</span><span class="o">.</span><span class="py">eat</span><span class="o">(</span><span class="k">new</span> <span class="nc">Grass</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A type like <code>this.buggy.Feed</code> is called a <strong>path-dependent type</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The word “path” here means a <strong>reference to an object</strong>.</p>
</li>
<li>
<p>It could be a single name, such as this.bessy, or a longer access path, such as farm.barn.bessy.SuitableFood, where each of farm, barn, and bessy are variables (or singleton object names) that refer to objects.</p>
</li>
<li>
<p>As the term “path-dependent type” says, the type depends on the path: in general, <strong>different paths give rise to different types</strong>.</p>
</li>
<li>
<p>A path-dependent type resembles the syntax for an inner class type in Java, but there is a crucial difference: <strong>a path-dependent type names an outer object, whereas an inner class type names an outer class.</strong></p>
<div class="ulist">
<ul>
<li>
<p>In Scala, the &#8216;<code>.</code>&#8217; syntax is reserved for objects, and the inner class is addressed using the expression <code>Outer#Inner</code> instead of Java&#8217;s <code>Outer.Inner</code>. .</p>
</li>
<li>
<p>As in Java, <strong>inner class instances hold a reference to an enclosing outer class instance</strong>. This allows an inner class, for example, to access members of its outer class.</p>
<div class="paragraph">
<p>Thus <strong>you can’t instantiate an inner class without in some way specifying an outer class instance</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One way to do this is to instantiate the inner class inside the body of the outer class.</p>
<div class="paragraph">
<p>In this case, the current outer class instance (referenced from this) will be used.</p>
</div>
</li>
<li>
<p>Another way is to use a path-dependent type.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">Outer</span> <span class="o">{</span>
  <span class="k">class</span> <span class="nc">Inner</span>

  <span class="k">def</span> <span class="nf">test</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Inner</span><span class="o">)</span> <span class="o">{}</span>

  <span class="k">def</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
    <span class="nf">test</span><span class="o">(</span><span class="k">new</span> <span class="k">this</span><span class="o">.</span><span class="py">Inner</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">o1</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Outer</span>
<span class="n">o1</span><span class="k">:</span> <span class="kt">Outer</span> <span class="o">=</span> <span class="nc">Outer</span><span class="k">@</span><span class="mi">37493666</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">o2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Outer</span>
<span class="n">o2</span><span class="k">:</span> <span class="kt">Outer</span> <span class="o">=</span> <span class="nc">Outer</span><span class="k">@</span><span class="mi">5</span><span class="n">e6c3555</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">()</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">(</span><span class="k">new</span> <span class="nv">o1</span><span class="o">.</span><span class="py">Inner</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">(</span><span class="k">new</span> <span class="nv">o2</span><span class="o">.</span><span class="py">Inner</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">14</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="kt">o2.Inner</span>
 <span class="n">required</span><span class="k">:</span> <span class="kt">o1.Inner</span>
       <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">(</span><span class="k">new</span> <span class="nv">o2</span><span class="o">.</span><span class="py">Inner</span><span class="o">)</span>
               <span class="o">^</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">(</span><span class="k">new</span> <span class="nc">Outer</span><span class="k">#</span><span class="nc">Inner</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">14</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">Outer</span> <span class="kt">is</span> <span class="kt">not</span> <span class="kt">a</span> <span class="kt">legal</span> <span class="kt">prefix</span> <span class="kt">for</span> <span class="kt">a</span> <span class="kt">constructor</span>
       <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">(</span><span class="k">new</span> <span class="nc">Outer</span><span class="k">#</span><span class="nc">Inner</span><span class="o">)</span>
                         <span class="o">^</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">(</span><span class="k">new</span> <span class="nv">Outer</span><span class="o">.</span><span class="py">Inner</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">not</span> <span class="kt">found:</span> <span class="kt">value</span> <span class="kt">Outer</span>
       <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">(</span><span class="k">new</span> <span class="nv">Outer</span><span class="o">.</span><span class="py">Inner</span><span class="o">)</span>
                   <span class="o">^</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">oi1</span><span class="k">:</span> <span class="kt">Outer</span><span class="k">#</span><span class="kt">Inner</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">o1</span><span class="o">.</span><span class="py">Inner</span>
<span class="n">oi1</span><span class="k">:</span> <span class="kt">Outer</span><span class="k">#</span><span class="kt">Inner</span> <span class="o">=</span> <span class="nc">Outer$Inner</span><span class="nd">@f268df</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">(</span><span class="n">oi1</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">14</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="kt">Outer</span><span class="k">#</span><span class="kt">Inner</span>
 <span class="n">required</span><span class="k">:</span> <span class="kt">o1.Inner</span>
       <span class="nv">o1</span><span class="o">.</span><span class="py">test</span><span class="o">(</span><span class="n">oi1</span><span class="o">)</span>
               <span class="o">^</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="structural-subtyping">20.8. Structural subtyping</h3>
<div class="paragraph">
<p>When a class inherits from another, the first class is said to be a nominal subtype of the other one. It’s a <strong>nominal subtype</strong> because each type has a name, and the names are explicitly declared to have a subtyping relationship. Scala additionally supports <strong>structural subtyping</strong>, where you get a subtyping rela- tionship simply because two types have the same members. To get structural subtyping in Scala, use Scala’s <strong>refinement types</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">refinement types</div>
<div class="paragraph">
<p>A type formed by supplying a base type a number of members inside curly braces. The members in the curly braces refine the types that are present in the base type. For example, the type of “animal that eats grass” is <code>Animal { type Feed = Grass }</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">trait</span> <span class="nc">Food</span>
<span class="k">trait</span> <span class="nc">Animal</span> <span class="o">{</span>
  <span class="k">type</span> <span class="kt">Feed</span> <span class="k">&gt;:</span> <span class="kt">Food</span>
  <span class="k">def</span> <span class="nf">eat</span><span class="o">(</span><span class="n">f</span><span class="k">:</span> <span class="kt">Feed</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">Grass</span> <span class="k">extends</span> <span class="nc">Food</span>

<span class="c1">// define a Pasture class that can contain animals that eat grass</span>
<span class="k">class</span> <span class="nc">Pasture</span> <span class="o">{</span>
  <span class="c1">// animals that eats grass</span>
  <span class="c1">// The members in the curly braces further specify— or refine, if</span>
  <span class="c1">//   you will—the types of members from the base class.</span>
  <span class="k">var</span> <span class="n">animals</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Animal</span> <span class="o">{</span> <span class="k">type</span> <span class="kt">Feed</span> <span class="kt">=</span> <span class="kt">Grass</span> <span class="o">}]</span> <span class="k">=</span> <span class="nc">Nil</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">using</span><span class="o">[</span><span class="kt">T</span> <span class="k">&lt;:</span> <span class="o">{</span> <span class="kt">def</span> <span class="kt">close</span><span class="o">()</span><span class="kt">:</span> <span class="kt">Unit</span> <span class="o">}](</span><span class="n">res</span><span class="k">:</span> <span class="kt">T</span><span class="o">)(</span><span class="n">op</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">try</span> <span class="o">{</span>
    <span class="n">op</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="c1">// warning: reflective access of structural type member method close should be enabled</span>
      <span class="c1">// by making the implicit value scala.language.reflectiveCalls visible.</span>
      <span class="c1">// This can be achieved by adding the import clause 'import scala.language.reflectiveCalls'</span>
      <span class="c1">// or by setting the compiler option -language:reflectiveCalls.</span>
      <span class="k">import</span> <span class="nn">scala.language.reflectiveCalls</span>

      <span class="nv">res</span><span class="o">.</span><span class="py">close</span><span class="o">()</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="k">import</span> <span class="nn">java.io.PrintWriter</span>
<span class="k">import</span> <span class="nn">java.util.Date</span>

<span class="k">val</span> <span class="nv">writer</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PrintWriter</span><span class="o">(</span><span class="s">"date.txt"</span><span class="o">)</span>
<span class="nf">using</span><span class="o">(</span><span class="n">writer</span><span class="o">)</span> <span class="o">{</span>
  <span class="nv">writer</span><span class="o">.</span><span class="py">println</span><span class="o">(</span><span class="k">new</span> <span class="nc">Date</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="enumerations">20.9. Enumerations</h3>
<div class="paragraph">
<p>There’s a class in its standard library, <strong>scala.Enumeration</strong> for enumerations. To create a new enumeration, you define an object that extends this class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">object</span> <span class="nc">Color</span> <span class="k">extends</span> <span class="nc">Enumeration</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">Red</span> <span class="k">=</span> <span class="nc">Value</span>
  <span class="k">val</span> <span class="nv">Green</span> <span class="k">=</span> <span class="nc">Value</span>
  <span class="k">val</span> <span class="nv">Blue</span> <span class="k">=</span> <span class="nc">Value</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Scala lets you also shorten several successive val or var definitions with the same right-hand side.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Equivalently to the above you could write:</span>
<span class="k">object</span> <span class="nc">Color</span> <span class="k">extends</span> <span class="nc">Enumeration</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">Red</span><span class="o">,</span> <span class="nc">Green</span><span class="o">,</span> <span class="nc">Blue</span> <span class="k">=</span> <span class="nc">Value</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Enumeration defines an inner class named Value, and the same-named parameterless Value method returns a fresh instance of that class.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>This means that a value such as <code>Color.Red</code> is of <code>type Color.Value</code>. <code>Color.Value</code> is the type of all enumeration values defined in object <code>Color</code>.</p>
</li>
<li>
<p>It’s a <strong>path-dependent type</strong>, with <strong>Color being the path</strong> and <strong>Value being the dependent type</strong>.</p>
</li>
<li>
<p>You can iterate over the values of an enumeration via the set returned by the enumeration’s values method:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nf">for</span> <span class="o">(</span><span class="n">c</span> <span class="k">&lt;-</span> <span class="nv">Color</span><span class="o">.</span><span class="py">values</span><span class="o">)</span> <span class="nf">print</span><span class="o">(</span><span class="n">c</span> <span class="o">+</span><span class="s">" "</span><span class="o">)</span>
<span class="nc">Red</span> <span class="nc">Green</span> <span class="nc">Blue</span></code></pre>
</div>
</div>
</li>
<li>
<p>Values of an enumeration are numbered from 0, and you can find out the number of an enumeration value by its <strong>id</strong> method:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nv">Color</span><span class="o">.</span><span class="py">Red</span><span class="o">.</span><span class="py">id</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">Color</span><span class="o">.</span><span class="py">Green</span><span class="o">.</span><span class="py">id</span>
<span class="n">res8</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span></code></pre>
</div>
</div>
</li>
<li>
<p>It’s also possible to go the other way, from a non-negative integer number to the value that has this number as id in an enumeration:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nc">Color</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="n">res9</span><span class="k">:</span> <span class="kt">Color.Value</span> <span class="o">=</span> <span class="nc">Green</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implicit-conversions-and-parameters">21. Implicit Conversions and Parameters</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="rules-for-implicits">21.1. Rules for implicits</h3>
<div class="paragraph">
<p>Implicit definitions are those that the compiler is allowed to insert into a program in order to fix any of its type errors.</p>
</div>
<div class="paragraph">
<p>For example, if <code>x + y</code> does not type check, then the compiler might change it to <code>convert(x) + y</code>, where convert is some available <strong>implicit conversion</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Marking</strong> Rule: Only definitions marked <code>implicit</code> are available.</p>
<div class="ulist">
<ul>
<li>
<p>The <code>implicit</code> keyword is used to mark which declarations the compiler may use as implicits.</p>
</li>
<li>
<p>You can use it to mark any variable, function, or object definition.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">implicit</span> <span class="k">def</span> <span class="nf">intToString</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="nv">x</span><span class="o">.</span><span class="py">toString</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Scope</strong> Rule: An inserted implicit conversion must be in scope as a <strong>single identifier</strong>, or be associated with the source or target type of the conversion.</p>
<div class="paragraph">
<p>There’s one exception to the “single identifier” rule. The compiler will also look for implicit definitions in the <strong>companion object</strong> of the source or expected target types of the conversion.</p>
</div>
</li>
<li>
<p><strong>One-at-a-time</strong> Rule: Only one implicit is tried.</p>
</li>
<li>
<p><strong>Explicits-First</strong> Rule: Whenever code type checks as it is written, no implicits are attempted.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="implicit-conversion-to-an-expected-type">21.2. Implicit conversion to an expected type</h3>
<div class="paragraph">
<p>Whenever the compiler sees an X, but needs a Y, it will look for an implicit function that converts X to Y.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">i</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mf">3.5</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">11</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="kt">Double</span><span class="o">(</span><span class="err">3</span><span class="kt">.</span><span class="err">5</span><span class="o">)</span>
 <span class="kt">required:</span> <span class="kt">Int</span>
       <span class="k">val</span> <span class="nv">i</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mf">3.5</span>
                    <span class="o">^</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">implicit</span> <span class="k">def</span> <span class="nf">doubleToInt</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">=</span> <span class="nv">x</span><span class="o">.</span><span class="py">toInt</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">11</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">implicit</span> <span class="kt">conversion</span> <span class="kt">method</span> <span class="kt">doubleToInt</span> <span class="kt">should</span> <span class="kt">be</span> <span class="kt">enabled</span>

<span class="n">doubleToInt</span><span class="k">:</span> <span class="o">(</span><span class="kt">x:</span> <span class="kt">Double</span><span class="o">)</span><span class="kt">Int</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">i</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">// compiler: val i: Int = doubleToInt(3.5)</span>
<span class="n">i</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">3</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="converting-the-receiver">21.3. Converting the receiver</h3>
<div class="paragraph">
<p>Implicit conversions also apply to the receiver of a method call, the object on which the method is invoked. This kind of implicit conversion has two main uses.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, receiver conversions allow smoother integration of a new class into an existing class hierarchy.</p>
</li>
<li>
<p>And second, they support writing domain specific languages (DSLs) within the language.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Interoperating with new types</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>&#8594;</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">MyInt</span><span class="o">(</span><span class="k">val</span> <span class="nv">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">+</span> <span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">value</span> <span class="o">+</span> <span class="nv">that</span><span class="o">.</span><span class="py">value</span><span class="o">)</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="n">s</span><span class="s">"MyInt(${value})"</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">MyInt</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">m2</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
<span class="n">m2</span><span class="k">:</span> <span class="kt">MyInt</span> <span class="o">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">m2</span> <span class="o">+</span> <span class="n">m2</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">MyInt</span> <span class="o">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">m2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="kt">Int</span><span class="o">(</span><span class="err">2</span><span class="o">)</span>
 <span class="kt">required:</span> <span class="kt">MyInt</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">m2</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">overloaded</span> <span class="kt">method</span> <span class="kt">value</span> <span class="kt">+</span> <span class="kt">with</span> <span class="kt">alternatives:</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">implicit</span> <span class="k">def</span> <span class="nf">int2MyInt</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">12</span><span class="k">:</span> <span class="kt">warning:</span> <span class="kt">implicit</span> <span class="kt">conversion</span> <span class="kt">method</span> <span class="kt">int2MyInt</span> <span class="kt">should</span> <span class="kt">be</span> <span class="kt">enabled</span>
                    <span class="o">^</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">m2</span> <span class="o">+</span> <span class="mi">2</span> <span class="c1">// compiler: m2 + int2MyInt(2)</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">MyInt</span> <span class="o">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">m2</span> <span class="c1">// compiler: int2MyInt(2) + m2</span>
<span class="n">res8</span><span class="k">:</span> <span class="kt">MyInt</span> <span class="o">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Simulating new syntax</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>&#8594;</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">m1</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="s">"one"</span><span class="o">,</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="s">"two"</span><span class="o">)</span>
<span class="n">m1</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Map</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="n">one</span><span class="o">,</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="n">two</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">m2</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="s">"one"</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">"two"</span><span class="o">))</span>
<span class="n">m2</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Map</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="n">one</span><span class="o">,</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="n">two</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">k1</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ArrowAssoc</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="n">k1</span><span class="k">:</span> <span class="kt">ArrowAssoc</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nv">scala</span><span class="o">.</span><span class="py">Predef$ArrowAssoc</span><span class="k">@</span><span class="mi">1</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">k2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ArrowAssoc</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
<span class="n">k2</span><span class="k">:</span> <span class="kt">ArrowAssoc</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nv">scala</span><span class="o">.</span><span class="py">Predef$ArrowAssoc</span><span class="k">@</span><span class="mi">2</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">k1</span> <span class="o">-&gt;</span> <span class="s">"one"</span>
<span class="n">res14</span><span class="k">:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="n">one</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">k2</span> <span class="o">-&gt;</span> <span class="s">"two"</span>
<span class="n">res15</span><span class="k">:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="n">two</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">m3</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="n">k1</span> <span class="o">-&gt;</span> <span class="s">"one"</span><span class="o">,</span> <span class="n">k2</span> <span class="o">-&gt;</span> <span class="s">"two"</span><span class="o">)</span>
<span class="n">m3</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Map</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="n">one</span><span class="o">,</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="n">two</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">m1</span> <span class="o">==</span> <span class="n">m2</span>
<span class="n">res16</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">m2</span> <span class="o">==</span> <span class="n">m3</span>
<span class="n">res17</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="implicit-parameters">21.4. Implicit parameters</h3>
<div class="paragraph">
<p>The compiler will sometimes replace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>someCall(a) with someCall(a)(b)</strong>,</p>
</li>
<li>
<p>or <strong>new SomeClass(a) with new SomeClass(a)(b)</strong>,</p>
<div class="paragraph">
<p>thereby adding a missing parameter list to complete a function call.</p>
</div>
</li>
<li>
<p>It is the entire last <strong>curried parameter list</strong> that’s supplied, not just the last parameter.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">PreferredPrompt</span><span class="o">(</span><span class="k">val</span> <span class="nv">preference</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>

<span class="k">object</span> <span class="nc">Greeter</span> <span class="o">{</span>
  <span class="c1">// The last parameter list is marked implicit, which means it can be supplied implicitly.</span>
  <span class="k">def</span> <span class="nf">greet</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">prompt</span><span class="k">:</span> <span class="kt">PreferredPrompt</span><span class="o">)</span> <span class="o">{</span>
    <span class="nf">println</span><span class="o">(</span><span class="s">"Welcome, "</span><span class="o">+</span> <span class="n">name</span> <span class="o">+</span><span class="s">". The system is ready."</span><span class="o">)</span>
    <span class="nf">println</span><span class="o">(</span><span class="nv">prompt</span><span class="o">.</span><span class="py">preference</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// But you can still provide the prompt explicitly,</span>
<span class="k">val</span> <span class="nv">bobsPrompt</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PreferredPrompt</span><span class="o">(</span><span class="s">"relax&gt; "</span><span class="o">)</span>
<span class="nv">Greeter</span><span class="o">.</span><span class="py">greet</span><span class="o">(</span><span class="s">"Bob"</span><span class="o">)(</span><span class="n">bobsPrompt</span><span class="o">)</span>
<span class="c1">// Welcome, Bob. The system is ready.</span>
<span class="c1">// relax&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// To let the compiler supply the parameter implicitly, you must first define a variable of</span>
<span class="c1">// the expected type, which in this case is `PreferredPrompt`.</span>
<span class="k">object</span> <span class="nc">JoesPrefs</span> <span class="o">{</span>
  <span class="c1">// Note that the val itself is marked implicit.</span>
  <span class="c1">// If it wasn’t, the compiler would not use it to supply the missing parameter list.</span>
  <span class="k">implicit</span> <span class="k">val</span> <span class="nv">prompt</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PreferredPrompt</span><span class="o">(</span><span class="s">"Yes, master&gt; "</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// It will also not use it if it isn’t in scope as a single identifier.</span>
<span class="k">import</span> <span class="nn">JoesPrefs._</span>

<span class="nv">Greeter</span><span class="o">.</span><span class="py">greet</span><span class="o">(</span><span class="s">"Joe"</span><span class="o">)</span>
<span class="c1">// Welcome, Joe. The system is ready.</span>
<span class="c1">// Yes, master&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p>Note that 8the implicit keyword applies to an entire parameter list*, not to individual parameters.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">PreferredPrompt</span><span class="o">(</span><span class="k">val</span> <span class="nv">preference</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
<span class="k">class</span> <span class="nc">PreferredDrink</span><span class="o">(</span><span class="k">val</span> <span class="nv">preference</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>

<span class="k">object</span> <span class="nc">Greeter</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">greet</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">prompt</span><span class="k">:</span> <span class="kt">PreferredPrompt</span><span class="o">,</span> <span class="n">drink</span><span class="k">:</span> <span class="kt">PreferredDrink</span><span class="o">)</span> <span class="o">{</span>
    <span class="nf">println</span><span class="o">(</span><span class="s">"Welcome, "</span><span class="o">+</span> <span class="n">name</span> <span class="o">+</span><span class="s">". The system is ready."</span><span class="o">)</span>
    <span class="nf">print</span><span class="o">(</span><span class="s">"But while you work, "</span><span class="o">)</span>
    <span class="nf">println</span><span class="o">(</span><span class="s">"why not enjoy a cup of "</span><span class="o">+</span> <span class="nv">drink</span><span class="o">.</span><span class="py">preference</span> <span class="o">+</span><span class="s">"?"</span><span class="o">)</span>
    <span class="nf">println</span><span class="o">(</span><span class="nv">prompt</span><span class="o">.</span><span class="py">preference</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">JoesPrefs</span> <span class="o">{</span>
  <span class="k">implicit</span> <span class="k">val</span> <span class="nv">prompt</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PreferredPrompt</span><span class="o">(</span><span class="s">"Yes, master&gt; "</span><span class="o">)</span>
  <span class="k">implicit</span> <span class="k">val</span> <span class="nv">drink</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PreferredDrink</span><span class="o">(</span><span class="s">"tea"</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="nv">Greeter</span><span class="o">.</span><span class="py">greet</span><span class="o">(</span><span class="s">"Joe"</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">could</span> <span class="kt">not</span> <span class="kt">find</span> <span class="kt">implicit</span> <span class="kt">value</span> <span class="kt">for</span> <span class="kt">parameter</span> <span class="kt">prompt:</span> <span class="kt">PreferredPrompt</span>
       <span class="nv">Greeter</span><span class="o">.</span><span class="py">greet</span><span class="o">(</span><span class="s">"Joe"</span><span class="o">)</span>
                    <span class="o">^</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">JoesPrefs._</span>
<span class="k">import</span> <span class="nn">JoesPrefs._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">Greeter</span><span class="o">.</span><span class="py">greet</span><span class="o">(</span><span class="s">"Joe"</span><span class="o">)(</span><span class="n">prompt</span><span class="o">,</span> <span class="n">drink</span><span class="o">)</span>
<span class="nc">Welcome</span><span class="o">,</span> <span class="nc">Joe</span><span class="o">.</span> <span class="nc">The</span> <span class="n">system</span> <span class="n">is</span> <span class="n">ready</span><span class="o">.</span>
<span class="nc">But</span> <span class="k">while</span> <span class="n">you</span> <span class="n">work</span><span class="o">,</span> <span class="n">why</span> <span class="n">not</span> <span class="n">enjoy</span> <span class="n">a</span> <span class="n">cup</span> <span class="n">of</span> <span class="n">tea</span><span class="o">?</span>
<span class="nc">Yes</span><span class="o">,</span> <span class="n">master</span><span class="o">&gt;</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">Greeter</span><span class="o">.</span><span class="py">greet</span><span class="o">(</span><span class="s">"Joe"</span><span class="o">)</span>
<span class="nc">Welcome</span><span class="o">,</span> <span class="nc">Joe</span><span class="o">.</span> <span class="nc">The</span> <span class="n">system</span> <span class="n">is</span> <span class="n">ready</span><span class="o">.</span>
<span class="nc">But</span> <span class="k">while</span> <span class="n">you</span> <span class="n">work</span><span class="o">,</span> <span class="n">why</span> <span class="n">not</span> <span class="n">enjoy</span> <span class="n">a</span> <span class="n">cup</span> <span class="n">of</span> <span class="n">tea</span><span class="o">?</span>
<span class="nc">Yes</span><span class="o">,</span> <span class="n">master</span><span class="o">&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p>The <strong>compiler selects implicit parameters by matching types</strong> of parameters against types of values in scope.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">greet</span><span class="o">(</span><span class="k">implicit</span> <span class="n">text</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="o">{</span> <span class="nf">println</span><span class="o">(</span><span class="n">text</span><span class="o">)</span> <span class="o">}</span>
<span class="n">greet</span><span class="k">:</span> <span class="o">(</span><span class="kt">implicit</span> <span class="kt">text:</span> <span class="kt">String</span><span class="o">)</span><span class="kt">Unit</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">implicit</span> <span class="k">val</span> <span class="nv">abcd</span> <span class="k">=</span> <span class="s">"Hello world!"</span>
<span class="n">abcd</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">Hello</span> <span class="n">world</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">greet</span>
<span class="nc">Hello</span> <span class="n">world</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">implicit</span> <span class="k">val</span> <span class="nv">text</span> <span class="k">=</span> <span class="s">"Hello world!"</span>
<span class="n">text</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">Hello</span> <span class="n">world</span><span class="o">!</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">greet</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">15</span><span class="k">:</span> <span class="kt">error:</span> <span class="kt">ambiguous</span> <span class="kt">implicit</span> <span class="kt">values:</span>
 <span class="kt">both</span> <span class="kt">value</span> <span class="kt">abcd</span> <span class="kt">of</span> <span class="k">type</span> <span class="o">=&gt;</span> <span class="nc">String</span>
 <span class="n">and</span> <span class="n">value</span> <span class="n">text</span> <span class="n">of</span> <span class="k">type</span> <span class="o">=&gt;</span> <span class="nc">String</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">class</span> <span class="nc">MyInt</span><span class="o">(</span><span class="k">val</span> <span class="nv">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="n">s</span><span class="s">"MyInt($value)"</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">MyInt</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">value</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// A function with an upper bound.</span>
<span class="k">def</span> <span class="nf">orderedMax</span><span class="o">[</span><span class="kt">T</span> <span class="k">&lt;:</span> <span class="kt">Ordered</span><span class="o">[</span><span class="kt">T</span><span class="o">]](</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=</span> <span class="nf">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="o">)</span> <span class="n">x</span> <span class="k">else</span> <span class="n">y</span>

<span class="k">val</span> <span class="nv">m1</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">m2</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>

<span class="c1">// error: inferred type arguments [this.MyInt] do not conform to method orderedMax's type parameter bounds [T &lt;: Ordered[T]]</span>
<span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"orderedMax($m1, $m2) is ${orderedMax(m1, m2)}"</span><span class="o">)</span>

<span class="k">class</span> <span class="nc">OrderedMyInt</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Ordered</span><span class="o">[</span><span class="kt">MyInt</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">compare</span><span class="o">(</span><span class="n">y</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span> <span class="k">=</span> <span class="nv">x</span><span class="o">.</span><span class="py">value</span> <span class="o">-</span> <span class="nv">y</span><span class="o">.</span><span class="py">value</span>
<span class="o">}</span>

<span class="k">implicit</span> <span class="k">def</span> <span class="nf">myInt2Ordered</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">OrderedMyInt</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>

<span class="c1">// A function with an implicit parameter.</span>
<span class="k">def</span> <span class="nf">max</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">T</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">orderer</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=&gt;</span> <span class="nc">Ordered</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="nf">if</span> <span class="o">(</span><span class="nf">orderer</span><span class="o">(</span><span class="n">x</span><span class="o">)</span> <span class="o">&gt;</span> <span class="n">y</span><span class="o">)</span> <span class="n">x</span> <span class="k">else</span> <span class="n">y</span>

<span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"max($m1, $m2) is ${max(m1, m2)}"</span><span class="o">)</span>
<span class="c1">// max(MyInt(1), MyInt(2)) is MyInt(2)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="view-bounds">21.5. View bounds</h3>
<div class="ulist">
<ul>
<li>
<p>Note that when you use implicit on a parameter, then not only will the compiler try to supply that parameter with an implicit value, but the compiler will also use that parameter as an available implicit in the body of the method! Thus, both uses of orderer within the body of the method can be left out.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A function that uses an implicit parameter internally.</span>
<span class="c1">//</span>
<span class="c1">// There is not a single mention of the orderer parameter in the text of the method.</span>
<span class="c1">// All uses of orderer are implicit.</span>
<span class="c1">// Surprisingly, this coding pattern is actually fairly common.</span>
<span class="c1">// The implicit parameter is used only for conversions, and so it can itself be used implicitly.</span>
<span class="k">def</span> <span class="nf">max</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">T</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">orderer</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=&gt;</span> <span class="nc">Ordered</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="nf">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="o">)</span> <span class="n">x</span> <span class="k">else</span> <span class="n">y</span></code></pre>
</div>
</div>
</li>
<li>
<p>Now, because the parameter name is never used explicitly, the name could have been anything or nothing using a <strong>view bound</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// A function with a view bound.</span>
<span class="c1">//</span>
<span class="c1">// You can think of “T &lt;% Ordered[T]” as saying, “I can use any T,</span>
<span class="c1">//   so long as T can be treated as an Ordered[T].”</span>
<span class="c1">// This is different from saying that T is an Ordered[T],</span>
<span class="c1">//   which is what an upper bound, “T &lt;: Ordered[T]”, would say.</span>
<span class="k">def</span> <span class="nf">max</span><span class="o">[</span><span class="kt">T</span> <span class="k">&lt;%</span> <span class="kt">Ordered</span><span class="o">[</span><span class="kt">T</span><span class="o">]](</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="nf">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="o">)</span> <span class="n">x</span> <span class="k">else</span> <span class="n">y</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="debugging-implicits">21.6. Debugging implicits</h3>
<div class="paragraph">
<p>When you are debugging a program, it can sometimes help to see what implicit conversions the compiler is inserting. The <strong>-Xprint:typer</strong> option to the compiler is useful for this. If you run scalac with this option, then the compiler will show you what your code looks like after all implicit conversions have been added by the type checker.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// Max.scala</span>
<span class="k">class</span> <span class="nc">MyInt</span><span class="o">(</span><span class="k">val</span> <span class="nv">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="n">s</span><span class="s">"MyInt($value)"</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">MyInt</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">value</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">OrderedMyInt</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Ordered</span><span class="o">[</span><span class="kt">MyInt</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">compare</span><span class="o">(</span><span class="n">y</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span> <span class="k">=</span> <span class="nv">x</span><span class="o">.</span><span class="py">value</span> <span class="o">-</span> <span class="nv">y</span><span class="o">.</span><span class="py">value</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="k">implicit</span> <span class="k">def</span> <span class="nf">myInt2Ordered</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">OrderedMyInt</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>

  <span class="k">def</span> <span class="nf">max</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">T</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">orderer</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=&gt;</span> <span class="nc">Ordered</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="nf">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="o">)</span> <span class="n">x</span> <span class="k">else</span> <span class="n">y</span>

  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">m1</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="k">val</span> <span class="nv">m2</span> <span class="k">=</span> <span class="nc">MyInt</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="nf">max</span><span class="o">(</span><span class="n">m1</span><span class="o">,</span> <span class="n">m2</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// $ scalac -Xprint:typer Max.scala</span>
<span class="o">[[</span><span class="kt">syntax</span> <span class="kt">trees</span> <span class="kt">at</span> <span class="kt">end</span> <span class="kt">of</span>                     <span class="k">type</span><span class="kt">r</span><span class="o">]]</span> <span class="c1">// Max.scala</span>
<span class="k">package</span> <span class="err">&lt;</span><span class="nn">empty</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="k">class</span> <span class="nc">MyInt</span> <span class="k">extends</span> <span class="nv">scala</span><span class="o">.</span><span class="py">AnyRef</span> <span class="o">{</span>
    <span class="o">&lt;</span><span class="n">paramaccessor</span><span class="o">&gt;</span> <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">val</span> <span class="nv">value</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="k">_</span><span class="o">;</span>
    <span class="o">&lt;</span><span class="n">stable</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">accessor</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">paramaccessor</span><span class="o">&gt;</span> <span class="k">def</span> <span class="nf">value</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="nv">MyInt</span><span class="o">.</span><span class="py">this</span><span class="o">.</span><span class="py">value</span><span class="o">;</span>
    <span class="k">def</span> <span class="nf">&lt;</span><span class="n">init</span><span class="o">&gt;(</span><span class="n">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">MyInt</span> <span class="o">=</span> <span class="o">{</span>
      <span class="nv">MyInt</span><span class="o">.</span><span class="py">super</span><span class="o">.&lt;</span><span class="n">init</span><span class="o">&gt;();</span>
      <span class="o">()</span>
    <span class="o">};</span>
    <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nv">scala</span><span class="o">.</span><span class="py">StringContext</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="s">"MyInt("</span><span class="o">,</span> <span class="s">")"</span><span class="o">).</span><span class="py">s</span><span class="o">(</span><span class="nv">MyInt</span><span class="o">.</span><span class="py">this</span><span class="o">.</span><span class="py">value</span><span class="o">)</span>
  <span class="o">};</span>
  <span class="k">object</span> <span class="nc">MyInt</span> <span class="k">extends</span> <span class="nv">scala</span><span class="o">.</span><span class="py">AnyRef</span> <span class="o">{</span>
    <span class="k">def</span> <span class="nf">&lt;</span><span class="n">init</span><span class="o">&gt;()</span><span class="k">:</span> <span class="kt">MyInt.</span><span class="k">type</span> <span class="o">=</span> <span class="o">{</span>
      <span class="nv">MyInt</span><span class="o">.</span><span class="py">super</span><span class="o">.&lt;</span><span class="n">init</span><span class="o">&gt;();</span>
      <span class="o">()</span>
    <span class="o">};</span>
    <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">MyInt</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyInt</span><span class="o">(</span><span class="n">value</span><span class="o">)</span>
  <span class="o">};</span>
  <span class="k">class</span> <span class="nc">OrderedMyInt</span> <span class="k">extends</span> <span class="nc">AnyRef</span> <span class="k">with</span> <span class="nc">Ordered</span><span class="o">[</span><span class="kt">MyInt</span><span class="o">]</span> <span class="o">{</span>
    <span class="o">&lt;</span><span class="n">paramaccessor</span><span class="o">&gt;</span> <span class="k">private</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">val</span> <span class="nv">x</span><span class="k">:</span> <span class="kt">MyInt</span> <span class="o">=</span> <span class="k">_</span><span class="o">;</span>
    <span class="k">def</span> <span class="nf">&lt;</span><span class="n">init</span><span class="o">&gt;(</span><span class="n">x</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span><span class="k">:</span> <span class="kt">OrderedMyInt</span> <span class="o">=</span> <span class="o">{</span>
      <span class="nv">OrderedMyInt</span><span class="o">.</span><span class="py">super</span><span class="o">.&lt;</span><span class="n">init</span><span class="o">&gt;();</span>
      <span class="o">()</span>
    <span class="o">};</span>
    <span class="k">override</span> <span class="k">def</span> <span class="nf">compare</span><span class="o">(</span><span class="n">y</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="nv">OrderedMyInt</span><span class="o">.</span><span class="py">this</span><span class="o">.</span><span class="py">x</span><span class="o">.</span><span class="py">value</span><span class="o">.-(</span><span class="nv">y</span><span class="o">.</span><span class="py">value</span><span class="o">)</span>
  <span class="o">};</span>
  <span class="k">object</span> <span class="nc">Main</span> <span class="k">extends</span> <span class="nv">scala</span><span class="o">.</span><span class="py">AnyRef</span> <span class="o">{</span>
    <span class="k">def</span> <span class="nf">&lt;</span><span class="n">init</span><span class="o">&gt;()</span><span class="k">:</span> <span class="kt">Main.</span><span class="k">type</span> <span class="o">=</span> <span class="o">{</span>
      <span class="nv">Main</span><span class="o">.</span><span class="py">super</span><span class="o">.&lt;</span><span class="n">init</span><span class="o">&gt;();</span>
      <span class="o">()</span>
    <span class="o">};</span>
    <span class="k">implicit</span> <span class="k">def</span> <span class="nf">myInt2Ordered</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span><span class="k">:</span> <span class="kt">OrderedMyInt</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderedMyInt</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
    <span class="k">def</span> <span class="nf">max</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">T</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">orderer</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=&gt;</span> <span class="nc">Ordered</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="nf">if</span> <span class="o">(</span><span class="nv">orderer</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="n">x</span><span class="o">).&gt;(</span><span class="n">y</span><span class="o">))</span>
      <span class="n">x</span>
    <span class="k">else</span>
      <span class="n">y</span><span class="o">;</span>
    <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="nv">m1</span><span class="k">:</span> <span class="kt">MyInt</span> <span class="o">=</span> <span class="nv">MyInt</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
      <span class="k">val</span> <span class="nv">m2</span><span class="k">:</span> <span class="kt">MyInt</span> <span class="o">=</span> <span class="nv">MyInt</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
      <span class="o">{</span>
        <span class="nv">Main</span><span class="o">.</span><span class="py">this</span><span class="o">.</span><span class="py">max</span><span class="o">[</span><span class="kt">MyInt</span><span class="o">](</span><span class="n">m1</span><span class="o">,</span> <span class="n">m2</span><span class="o">)({</span>
          <span class="o">((</span><span class="n">x</span><span class="k">:</span> <span class="kt">MyInt</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nv">Main</span><span class="o">.</span><span class="py">this</span><span class="o">.</span><span class="py">myInt2Ordered</span><span class="o">(</span><span class="n">x</span><span class="o">))</span>
        <span class="o">});</span>
        <span class="o">()</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-scala-collections-api">22. The Scala Collections API</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="collection-hierarchy">22.1. Collection hierarchy</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nc">Traversable</span>
  <span class="nc">Iterable</span>
    <span class="nc">Seq</span>
      <span class="nc">IndexedSeq</span>
        <span class="nc">Vector</span>
        <span class="nc">ResizableArray</span>
        <span class="nc">GenericArray</span>
    <span class="nc">LinearSeq</span>
      <span class="nc">MutableList</span>
      <span class="nc">List</span>
      <span class="nc">Stream</span>
    <span class="nc">Buffer</span>
      <span class="nc">ListBuffer</span>
      <span class="nc">ArrayBuffer</span>
    <span class="nc">Set</span>
      <span class="nc">SortedSet</span>
        <span class="nc">TreeSet</span>
      <span class="nc">HashSet</span> <span class="o">(</span><span class="n">mutable</span><span class="o">)</span>
      <span class="nc">LinkedHashSet</span>
      <span class="nc">HashSet</span> <span class="o">(</span><span class="n">immutable</span><span class="o">)</span>
      <span class="nc">BitSet</span>
      <span class="nc">EmptySet</span><span class="o">,</span> <span class="nc">Set1</span><span class="o">,</span> <span class="nc">Set2</span><span class="o">,</span> <span class="nc">Set3</span><span class="o">,</span> <span class="nc">Set4</span>
    <span class="nc">Map</span>
      <span class="nc">SortedMap</span>
        <span class="nc">TreeMap</span>
      <span class="nc">HashMap</span> <span class="o">(</span><span class="n">mutable</span><span class="o">)</span>
      <span class="nc">LinkedHashMap</span> <span class="o">(</span><span class="n">mutable</span><span class="o">)</span>
      <span class="nc">HashMap</span> <span class="o">(</span><span class="n">immutable</span><span class="o">)</span>
      <span class="nc">EmptyMap</span><span class="o">,</span> <span class="nc">Map1</span><span class="o">,</span> <span class="nc">Map2</span><span class="o">,</span> <span class="nc">Map3</span><span class="o">,</span> <span class="nc">Map4</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extractors">23. Extractors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An <strong>extractor</strong> in Scala is an object that has a method called <strong>unapply</strong> as one of its members.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The purpose of that unapply method is to match a value and take it apart.</p>
</li>
<li>
<p>Often, the extractor object also defines a dual method <strong>apply</strong> for building values, but this is not required.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="c1">// The EMail string extractor object.</span>
<span class="k">object</span> <span class="nc">EMail</span> <span class="o">{</span>
  <span class="c1">// The injection method (optional)</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">user</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">domain</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="n">user</span> <span class="o">+</span><span class="s">"@"</span><span class="o">+</span> <span class="n">domain</span>

  <span class="c1">// The extraction method (mandatory)</span>
  <span class="k">def</span> <span class="nf">unapply</span><span class="o">(</span><span class="n">str</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">parts</span> <span class="k">=</span> <span class="n">str</span> <span class="n">split</span> <span class="s">"@"</span>
    <span class="nf">if</span> <span class="o">(</span><span class="nv">parts</span><span class="o">.</span><span class="py">length</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span> <span class="nc">Some</span><span class="o">(</span><span class="nf">parts</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="nf">parts</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span> <span class="k">else</span> <span class="nc">None</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To make this more explicit, you could also let EMail inherit from Scala’s function type, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">object</span> <span class="nc">EMail</span> <span class="nf">extends</span> <span class="o">((</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">String</span><span class="o">)</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
<span class="c1">// $ scalap EMail</span>
<span class="c1">// object EMail extends scala.AnyRef with scala.Function2[scala.Predef.String, scala.Predef.String, scala.Predef.String] {</span>
<span class="c1">//   def this() = { /* compiled code */ }</span>
<span class="c1">//   def apply(user: scala.Predef.String, domain: scala.Predef.String): java.lang.String = { /* compiled code */ }</span>
<span class="c1">//   def unapply(str: scala.Predef.String): scala.Option[scala.Tuple2[scala.Predef.String, scala.Predef.String]] = { /* compiled code */ }</span>
<span class="c1">// }</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <strong>(String, String) =&gt; String</strong> portion of the previous object declaration means the same as <strong>Function2[String, String, String]</strong>, which declares an abstract <strong>apply</strong> method that EMail implements.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now, whenever <strong>pattern matching</strong> encounters a pattern referring to an extractor object, it invokes the extractor’s unapply method on the selector expression. For instance, executing the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="n">selectorString</span> <span class="k">match</span> <span class="o">{</span> <span class="k">case</span> <span class="nc">EMail</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="n">domain</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">...</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>would lead to the call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nv">EMail</span><span class="o">.</span><span class="py">unapply</span><span class="o">(</span><span class="n">selectorString</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In object EMail, the apply method is called an <strong>injection</strong>, because it takes some arguments and yields an element of a given set (in our case: the set of strings that are email addresses). The unapply method is called an <strong>extraction</strong>, because it takes an element of the same set and extracts some of its parts (in our case: the user and domain substrings).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Injections and extractions are often grouped together in one object, because then you can use the object’s name for both a constructor and a pattern, which simulates the convention for pattern matching with case classes.</p>
</li>
<li>
<p>However, it is also possible to define an extraction in an object without a corresponding injection. The object itself is called an <strong>extractor</strong>, regardless of whether or not it has an apply method.</p>
</li>
<li>
<p>If an injection method is included, it should be the dual to the extraction method.</p>
<div class="paragraph">
<p>For instance, a call of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nv">EMail</span><span class="o">.</span><span class="py">unapply</span><span class="o">(</span><span class="nv">EMail</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="n">domain</span><span class="o">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>should return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nc">Some</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="n">domain</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>i.e., the same sequence of arguments wrapped in a Some.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To return just <strong>one pattern element</strong>, the unapply method simply wraps the element itself in a Some.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">object</span> <span class="nc">Twice</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">s</span>

  <span class="k">def</span> <span class="nf">unapply</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">len</span> <span class="k">=</span> <span class="nv">s</span><span class="o">.</span><span class="py">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">val</span> <span class="nv">half</span> <span class="k">=</span> <span class="nv">s</span><span class="o">.</span><span class="py">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">len</span><span class="o">)</span>
    <span class="nf">if</span> <span class="o">(</span><span class="n">half</span> <span class="o">==</span> <span class="nv">s</span><span class="o">.</span><span class="py">substring</span><span class="o">(</span><span class="n">len</span><span class="o">))</span> <span class="nc">Some</span><span class="o">(</span><span class="n">half</span><span class="o">)</span> <span class="k">else</span> <span class="nc">None</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Scala lets you define a different extraction method named <strong>unapplySeq</strong> specifically for vararg matching.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="annotations">24. Annotations</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="asn1">Annotation       ::=  ‘@’ SimpleType {ArgumentExprs}
ConstrAnnotation ::=  ‘@’ SimpleType ArgumentExprs</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="definition">24.1. Definition</h3>
<div class="ulist">
<ul>
<li>
<p>Annotations associate <strong>meta-information</strong> with definitions.</p>
</li>
<li>
<p>A simple annotation has the form <code>@𝑐</code> or <code>@𝑐(𝑎1,…,𝑎𝑛)</code>. Here, <code>𝑐</code> is a constructor of a class <code>𝐶</code> , which must conform to the class <code>scala.Annotation</code>.</p>
</li>
<li>
<p>Annotations may apply to definitions or declarations, types, or expressions.</p>
<div class="ulist">
<ul>
<li>
<p>An annotation of a definition or declaration appears in front of that definition.</p>
</li>
<li>
<p>An annotation of a type appears after that type.</p>
</li>
<li>
<p>An annotation of an expression 𝑒 appears after the expression 𝑒, separated by a colon.</p>
</li>
</ul>
</div>
</li>
<li>
<p>More than one annotation clause may apply to an entity. The order in which these annotations are given does not matter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nd">@deprecated</span><span class="o">(</span><span class="s">"Use D"</span><span class="o">,</span> <span class="s">"1.0"</span><span class="o">)</span> <span class="k">class</span> <span class="nc">C</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span> <span class="c1">// Class annotation</span>
<span class="nd">@transient</span> <span class="nd">@volatile</span> <span class="k">var</span> <span class="n">m</span><span class="k">:</span> <span class="kt">Int</span>             <span class="c1">// Variable annotation</span>
<span class="nc">String</span> <span class="nd">@local</span>                               <span class="c1">// Type annotation</span>
<span class="o">(</span><span class="n">e</span><span class="k">:</span> <span class="kt">@unchecked</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>               <span class="c1">// Expression annotation</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="predefined-annotations">24.2. Predefined Annotations</h3>
<div class="sect3">
<h4 id="java-platform-annotations">24.2.1. Java Platform Annotations</h4>
<div class="paragraph">
<p>The meaning of annotation clauses is implementation-dependent. On the Java platform, the following annotations have a standard meaning.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>@transient</strong></p>
<div class="paragraph">
<p>Marks a field to be non-persistent; this is equivalent to the transient modifier in Java.</p>
</div>
</li>
<li>
<p><strong>@volatile</strong></p>
<div class="paragraph">
<p>Marks a field which can change its value outside the control of the program; this is equivalent to the volatile modifier in Java.</p>
</div>
</li>
<li>
<p><strong>@SerialVersionUID(&lt;longlit&gt;)</strong></p>
<div class="paragraph">
<p>Attaches a serial version identifier (a long constant) to a class. This is equivalent to a the following field definition in Java:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">private</span> <span class="k">final</span> <span class="n">static</span> <span class="nc">SerialVersionUID</span> <span class="k">=</span> <span class="o">&lt;</span><span class="n">longlit</span><span class="o">&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>@throws(&lt;classlit&gt;)</strong></p>
<div class="paragraph">
<p>A Java compiler checks that a program contains handlers for checked exceptions by analyzing which checked exceptions can result from execution of a method or constructor. For each checked exception which is a possible result, the throws clause for the method or constructor must mention the class of that exception or one of the superclasses of the class of that exception.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="java-beans-annotations">24.2.2. Java Beans Annotations</h4>
<div class="ulist">
<ul>
<li>
<p><strong>@scala.beans.BeanProperty</strong></p>
<div class="paragraph">
<p>When prefixed to a definition of some variable X, this annotation causes getter and setter methods getX, setX in the Java bean style to be added in the class containing the variable. The first letter of the variable appears capitalized after the get or set. When the annotation is added to the definition of an immutable value definition X, only a getter is generated. The construction of these methods is part of code-generation; therefore, these methods become visible only once a classfile for the containing class is generated.</p>
</div>
</li>
<li>
<p><strong>@scala.beans.BooleanBeanProperty</strong></p>
<div class="paragraph">
<p>This annotation is equivalent to scala.<span class="line-through">reflect</span> beans.BeanProperty, but the generated getter method is named isX instead of getX.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deprecation-annotations">24.2.3. Deprecation Annotations</h4>
<div class="ulist">
<ul>
<li>
<p><strong>@deprecated(message: &lt;stringlit&gt;, since: &lt;stringlit&gt;)</strong></p>
<div class="paragraph">
<p>Marks a definition as deprecated. Accesses to the defined entity will then cause a deprecated warning mentioning the message &lt;stringlit&gt; to be issued from the compiler. The argument since documents since when the definition should be considered deprecated.</p>
</div>
<div class="paragraph">
<p>Deprecated warnings are suppressed in code that belongs itself to a definition that is labeled deprecated.</p>
</div>
</li>
<li>
<p><strong>@deprecatedName(name: &lt;symbollit&gt;)</strong></p>
<div class="paragraph">
<p>Marks a formal parameter name as deprecated. Invocations of this entity using named parameter syntax refering to the deprecated parameter name cause a deprecation warning.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="scala-compiler-annotations">24.2.4. Scala Compiler Annotations</h4>
<div class="ulist">
<ul>
<li>
<p><strong>@unchecked</strong></p>
<div class="paragraph">
<p>When applied to the selector of a match expression, this attribute suppresses any warnings about non-exhaustive pattern matches which would otherwise be emitted. For instance, no warnings would be produced for the method definition below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">def</span> <span class="nf">f</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">@unchecked</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">Some</span><span class="o">(</span><span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">y</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Without the @unchecked annotation, a Scala compiler could infer that the pattern match is non-exhaustive, and could produce a warning because Option is a sealed class.</p>
</div>
</li>
<li>
<p><strong>@uncheckedStable</strong></p>
<div class="paragraph">
<p>When applied a value declaration or definition, it allows the defined value to appear in a path, even if its type is volatile. For instance, the following member definitions are legal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">type</span> <span class="kt">A</span> <span class="o">{</span> <span class="k">type</span> <span class="kt">T</span> <span class="o">}</span>
<span class="k">type</span> <span class="kt">B</span>
<span class="nd">@uncheckedStable</span> <span class="k">val</span> <span class="nv">x</span><span class="k">:</span> <span class="kt">A</span> <span class="kt">with</span> <span class="kt">B</span> <span class="c1">// volatile type</span>
<span class="k">val</span> <span class="nv">y</span><span class="k">:</span> <span class="kt">x.T</span>                       <span class="c1">// OK since `x' is still a path</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Without the @uncheckedStable annotation, the designator x would not be a path since its type A with B is volatile. Hence, the reference x.T would be malformed.</p>
</div>
<div class="paragraph">
<p>When applied to value declarations or definitions that have non-volatile types, the annotation has no effect.</p>
</div>
</li>
<li>
<p><strong>@specialized</strong></p>
<div class="paragraph">
<p>When applied to the definition of a type parameter, this annotation causes the compiler to generate specialized definitions for primitive types. An optional list of primitive types may be given, in which case specialization takes into account only those types. For instance, the following code would generate specialized traits for Unit, Int and Double</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">trait</span> <span class="nc">Function0</span><span class="o">[</span><span class="kt">@specialized</span><span class="o">(</span><span class="kt">Unit</span>, <span class="kt">Int</span>, <span class="kt">Double</span><span class="o">)</span> <span class="kt">T</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="k">:</span> <span class="kt">T</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Whenever the static type of an expression matches a specialized variant of a definition, the compiler will instead use the specialized version. See the specialization sid for more details of the implementation.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="user-defined-annotations">24.3. User-defined Annotations</h3>
<div class="paragraph">
<p>Other annotations may be interpreted by platform- or application-dependent tools.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Class <strong>scala.Annotation</strong> has two sub-traits which are used to indicate how these annotations are retained.</p>
<div class="ulist">
<ul>
<li>
<p>Instances of an annotation class inheriting from trait <strong>scala.ClassfileAnnotation</strong> will be stored in the generated class files.</p>
</li>
<li>
<p>Instances of an annotation class inheriting from trait <strong>scala.StaticAnnotation</strong> will be visible to the <strong>Scala type-checker</strong> in every compilation unit where the annotated symbol is accessed.</p>
</li>
<li>
<p>An annotation class can inherit from both scala.ClassfileAnnotation and scala.StaticAnnotation.</p>
<div class="paragraph">
<p>If an annotation class inherits from neither scala.ClassfileAnnotation nor scala.StaticAnnotation, its instances are visible only locally during the compilation run that analyzes them.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Classes inheriting from scala.ClassfileAnnotation may be subject to further restrictions in order to assure that they can be mapped to the host environment. In particular, on both the Java and the .NET platforms, such classes must be toplevel; i.e. they may not be contained in another class or object. Additionally, on both Java and .NET, all constructor arguments must be constant expressions.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="object-equality">25. Object Equality</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="equality-in-scala">25.1. Equality in Scala</h3>
<div class="paragraph">
<p>Java has two equality comparisons: the <strong>==</strong> operator, which is the natural equality for value types and object identity for reference types, and the <strong>equals</strong> method, which is (user-defined) canonical equality for reference types. This convention is problematic, because the more natural symbol, <strong>==,</strong> does not always correspond to the natural notion of equality. When programming in Java, a common pitfall for beginners is to compare objects with == when they should have been compared with equals. For instance, comparing two strings x and y using “x == y” might well yield false in Java, even if x and y have exactly the same characters in the same order.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Eq</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">str1</span> <span class="o">=</span> <span class="s">"Hello"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">str2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">str1</span><span class="o">);</span>

        <span class="kt">boolean</span> <span class="n">b1</span> <span class="o">=</span>  <span class="n">str1</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">str2</span><span class="o">);</span>    <span class="c1">// true</span>
        <span class="kt">boolean</span> <span class="n">b2</span> <span class="o">=</span>  <span class="n">str1</span> <span class="o">==</span> <span class="n">str2</span><span class="o">;</span>         <span class="c1">// false</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Scala also has an equality method signifying object identity, but it is not used much. That kind of equality, written “<strong>x eq y</strong>”, is true if x and y reference the same object. The <strong>==</strong> equality is reserved in Scala for the “natural” equality of each type. For value types, == is value comparison, just like in Java. For reference types, == is the same as equals in Scala. You can redefine the behavior of == for new types by overriding the equals method, which is always inherited from class Any. The inherited equals, which takes effect unless overridden, is object identity, as is the case in Java. So equals (and with it, ==) is by default the same as eq, but you can change its behavior by overriding the equals method in the classes you define. It is not possible to override == directly, as it is defined as a final method in class Any. That is, Scala treats == as if it were defined as follows in class Any:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">final</span> <span class="k">def</span> <span class="nf">==</span> <span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span>
  <span class="nf">if</span> <span class="o">(</span><span class="kc">null</span> <span class="n">eq</span> <span class="k">this</span><span class="o">)</span> <span class="o">{</span><span class="kc">null</span> <span class="n">eq</span> <span class="n">that</span><span class="o">}</span> <span class="k">else</span> <span class="o">{</span><span class="k">this</span> <span class="n">equals</span> <span class="n">that</span><span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">object</span> <span class="nc">Eq</span> <span class="o">{</span>
    <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
        <span class="k">val</span> <span class="nv">str1</span> <span class="k">=</span> <span class="s">"Hello"</span>
        <span class="k">val</span> <span class="nv">str2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">str1</span><span class="o">)</span>

        <span class="k">val</span> <span class="nv">b1</span> <span class="k">=</span>  <span class="nv">str1</span><span class="o">.</span><span class="py">equals</span><span class="o">(</span><span class="n">str2</span><span class="o">)</span>   <span class="c1">// true</span>
        <span class="k">val</span> <span class="nv">b2</span> <span class="k">=</span>  <span class="n">str1</span> <span class="o">==</span> <span class="n">str2</span>        <span class="c1">// true</span>
        <span class="k">val</span> <span class="nv">b3</span> <span class="k">=</span>  <span class="n">str1</span> <span class="n">eq</span> <span class="n">str2</span>        <span class="c1">// false</span>

        <span class="nf">println</span><span class="o">(</span><span class="n">b1</span><span class="o">,</span> <span class="n">b2</span><span class="o">,</span> <span class="n">b3</span><span class="o">)</span>           <span class="c1">// (true,true,false)</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="actors-and-concurrency">26. Actors and Concurrency</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Java platform comes with a built-in threading model based on <strong>shared data and locks</strong>.</p>
</div>
<div class="paragraph">
<p>Scala&#8217;s actors library does address the fundamental problem by providing an alternative, <strong>share-nothing, message-passing model</strong>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Starting with Scala 2.11.0, the Scala <a href="https://docs.scala-lang.org/overviews/core/actors.html">Actors</a> library is deprecated. Already in Scala 2.10.0 the default actor library is <a href="https://akka.io/">Akka</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><a href="https://docs.scala-lang.org/overviews/core/actors-migration-guide.html" class="bare">https://docs.scala-lang.org/overviews/core/actors-migration-guide.html</a></p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bibliography">27. Bibliography</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Martin Odersky, Lex Spoon and Bill Venners. "Programming in Scala, second edition."</p>
</li>
</ul>
</div>
</div>
</div>
  </div>

  <ul class="post-navigation">
    <li>
      
      <a href="/2022/03/08/network-latency-vs-throughput-vs-bandwidth/">&laquo; Network Latency vs. Throughput vs. Bandwidth</a>
      
    </li>
    <li>
      
      <a href="/2022/05/20/what-is-postgresql/">What Is PostgreSQL &raquo;</a>
      
    </li>
  </ul>
</article>

      </div>
    </div>

    <footer class="site-footer">
  <div class="license">
    <span>Article licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></span>
  </div>
  
  <details open>
    <summary>Extral Links</summary>
    <div>
      
      <a href="https://jekyllrb.com/">Jekyll</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://shopify.github.io/">Liquid</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://docs.asciidoctor.org/">Asciidoctor</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://github.com/qqbuby/">GitHub</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="/feed.xml">RSS</a>
      
      
    </div>
  </details>
  
</footer>


<!-- https://github.com/bryanbraun/anchorjs -->
<script src="/js/anchor.min.js"></script>
<script>
  anchors.add();
  anchors.remove(".site-title");
</script>




  </body>

</html>

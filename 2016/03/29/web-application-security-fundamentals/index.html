<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bing WebMaster -->
  <meta name="msvalidate.01" content="AB2FFF876C37F59D9121882CC8395DE5" />

  <title>Web 应用安全基础</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://blog.codefarm.me/2016/03/29/web-application-security-fundamentals/">
  <link rel="alternate" type="application/rss+xml" title="CODE FARM" href="https://blog.codefarm.me/feed.xml">

  <!-- https://cdn.jsdelivr.net/gh/lurongkai/anti-baidu/js/anti-baidu-latest.min.js -->
<script type="text/javascript" src="/js/anti-baidu.min.js" charset="UTF-8"></script>

  
<!-- Google Analytics Website tracking -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83971182-1', 'auto');
  ga('send', 'pageview');

</script>


  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SN88FJ18E5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SN88FJ18E5');
</script>



</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <h2 class="site-title">
      <a class="site-title" href="/">CODE FARM</a>
    </h2>

     <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
        <div class="trigger">
            <ul>
                <li><a href="/">home</a>
                <li><a href="/category">category</a>
                <li><a href="/tag">tag</a>
                <li><a href="/archive">archive</a>
                <li><a href="/about">about</a>
                <li><a href="https://resume.github.io/?qqbuby" target="_blank">R&eacute;sum&eacute;</a>
            </ul>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Web 应用安全基础</h1>
    
    
    <p class="post-meta"><time datetime="2016-03-29T20:55:16+08:00" itemprop="datePublished">Mar 29, 2016</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>关于Web应用的安全性，我们会想到的有网站污损，盗取信用卡号码，拒绝服务攻击（DoS），病毒，特洛伊木马，蠕虫……，而这些问题中最大的问是对安全的无知。</p>

<p><strong>我们是安全的？我们有防火墙</strong></p>

<p>这是一个普遍的误解，因为防火墙的安全性要取决于威胁的类型。例如，防火墙无法检测发送到Web应用的恶意输入。</p>

<p>防火墙在于封锁端口，是安全的一个组成部分，并不是一个完整的解决方案。</p>

<p>这同样适用于安全套接字层（SSL），SSL在于网络流量的加密，但它不会验证应用程序的输入或保护配置不当的服务器。</p>

<p><strong>什么是我们所指的安全？</strong></p>

<p>安全的根本在于保护资产。资产可以是有形的，如网页或者客户的数据，也可以是无形的，比如公司的声誉。</p>

<p>安全是没有终点的征程。通过分析基础设施与应用程序，可以找出潜在的威胁以及了解威胁的风险程度。安全是关于风险的管理与有效对策的实施。</p>

<p><strong><em>安全基础</em></strong></p>

<ul>
  <li>
    <p>认证（Authentication）</p>

    <p>认证要解决的问题是：你是谁？（贫僧乃东土大唐差往西天取经者。路过此间，……）。它是应用程序对户端（包括终端用户，其他的服务，进程或计算机)的唯一性标识。对客户端的认证是安全方面的基础。</p>
  </li>
  <li>
    <p>授权（Authorization）</p>

    <p>授权解决的问题是：你能做什么？它是对认证的客户端在资源的支配和操作的访问过程中的许可认证。资源包括文件，数据库，表，行等，以及系统级资源，如注册表，配置数据。资源的操作包括交易的执行，如产品的购买，账户资金的转移，客户信用评级的增加等。</p>
  </li>
  <li>
    <p>审计（Auditing）</p>

    <p>有效的审计和日志是不可抵赖性的关键。不可抵赖性保证用户无法对执行的操作进行否认。例如，在电子商务系统中，需要不可抵赖机制，以确保消费者不能否认100份特定书籍的订购。</p>
  </li>
  <li>
    <p>保密（Confidentiality）</p>

    <p>保密性，也被称为私密性（privacy），用于确保数据的隐私与保密，以及确保数据在网络传输的过程中不会被非授权用户偷听或查看。加密常用于保密性的增强，而访问控制列表（ACL）是另一种手段。</p>
  </li>
  <li>
    <p>完整性（Integrity）</p>

    <p>完整性保护数据不被意外或者有意的篡改。就像保密性（privacy），完整性也是一个关键的问题点，特别是数据在网络传输的过程中。通常使用散列（hashing）和消息码认证（message authentication codes）提供数据的完整性。</p>
  </li>
  <li>
    <p>可用性（Availability）</p>

    <p>从安全的角度看，可用性是指应用程序对用户的可用性保证。拒绝服务攻击（DoS）的目的是整垮应用程序或者耗尽系统资源，使应用程序无法被其他的用户访问。</p>
  </li>
</ul>

<p><strong>威胁，漏洞和攻击的定义</strong></p>

<p>威胁是对资产潜在的，恶意的或其他对资产有害的任何事情。</p>

<p>漏洞是可能产生威胁的一种缺陷。这可能是不良的设计，错误的配置或不适当和不安全的编码技术。</p>

<p>攻击是一种探测漏洞或发现威胁的行为。攻击的例子包括向应用程序发送恶意的输入或用于拒绝服务的网络洪水攻击。</p>

<p><strong>如何建立安全的Web应用程序？</strong></p>

<p>设计和构建安全的Web应用程序之前，你需要知道你所面对的威胁。一个重要的准则就是在应用程序的设计阶段进行威胁建模（threat modeling）。威胁建模的目的是分析应用程序的架构和设计，并识别破坏系统安全的潜在漏洞，如用户的误操作，恶意目的攻击。</p>

<p>在系统设计的时候，可以应用安全原则进行系统安全性设计的考量。作为开发人员，你需要遵循安全的编码技术，开发安全，稳定的解决方案。应用层的软件设计与开发须由软件部署的服务器的安全的网络，主机和配置的支持。</p>

<p><strong>网络，主机和应用程序的安全</strong></p>

<p><em>“A vulnerability in a network will allow a malicious user to exploit a host or an application. A vulnerability in a host will allow a malicious user to exploit a network or an application. A vulnerability in an application will allow a malicious user to exploit a network or a host.”</em></p>

<p><em>Carlos Lyons, Corporate Security, Microsoft</em></p>

<p>要构建安全的Web应用程序，需要对应用程序安全做到统筹兼顾，并且安全必须应用到所有的三层（网络，主机和应用程序）。</p>

<p><img src="https://msdn.microsoft.com/dynimg/IC97872.gif" alt="A holistic approach to security" /></p>

<p><strong><em>Figure 1.1 A holistic approach to security</em></strong></p>

<p><strong>网络安全</strong></p>

<p>安全的Web应用依赖于一个安全的网络基础设施。网络基础设施由路由器，防火墙和交换机构成。网络安全的作用不仅是保护自己免受基于TCP/IP的攻击，也是如安全的管理接口和强密码等应对措施的实现。网络安全也负责其转发流量的完整性。</p>

<p><strong>网络组件的类别</strong></p>

<ul>
  <li>
    <p>路由器（Router）</p>

    <p>路由器是网络的最外一环。路由器根据应用程序需要的协议和端口设定数据包的网络路径。常见的TCP/IP漏洞在这一环得到限制。</p>
  </li>
  <li>
    <p>防火墙（Firewall）</p>

    <p>防火墙用于限制应用程序不使用的协议和端口。此外，防火墙可根据特定程序的过滤规则，限制恶意的网络通信，保护网络流量的安全。</p>
  </li>
  <li>
    <p>交换机（Switch）</p>

    <p>交换机用于网段的划分。它们通常是被忽视的或被过于信任的。</p>
  </li>
</ul>

<p><strong>主机安全</strong></p>

<p>在主机安全中，无论是Web服务器，应用服务器或数据库服务器，通过将安全设置进行分类，你可以专注于特定类别的安全审查或针对特定的安全类别应用相关的安全设置
。</p>

<p><img src="https://msdn.microsoft.com/dynimg/IC44962.gif" alt="" /></p>

<p><strong><em>Figure 1.2 Host security categories</em></strong></p>

<ul>
  <li>
    <p>补丁和更新</p>

    <p>漏洞的发布以及被众所周知，导致存在许多的安全风险。当新的漏洞被发现并首次用于攻击成功时，这些漏洞代码在数小时内就会被发布于互联网的公告板上。对服务器的软件的补丁修订或更新，是对服务器安全保护的第一步。如果不对服务器进行补丁修订或更新，这会为恶意代码和攻击者提供更多潜在的机会。</p>
  </li>
  <li>
    <p>服务</p>

    <p>通过禁用不必要和不使用的服务，可以轻易的减少攻击面。</p>
  </li>
  <li>
    <p>协议</p>

    <p>通过禁用不必要或不使用的网络协议，可以减少攻击者的攻击面和攻击途径。</p>
  </li>
  <li>
    <p>账户</p>

    <p>访问服务器的各种账户应限制在必要的服务与用户的账户组内。另外，你应该执行适当的账户策略，如强制使用强密码。</p>
  </li>
  <li>
    <p>文件和目录</p>

    <p>文件和目录应该使用文件系统（ext2/3/4，NTFS，FAT）的权限系统进行限制。</p>
  </li>
  <li>
    <p>共享</p>

    <p>删除所有不必要的文件共享，包括不需要的默认共享。使用文件系统的权限系统保护文件的共享。</p>
  </li>
  <li>
    <p>端口</p>

    <p>服务在运行的服务器侦听特定的端口处理传入的请求。服务器打开的端口须定期的审查，以确保不被不安全的服务用于侦听并用于网络通信。</p>
  </li>
  <li>
    <p>审计和日志</p>

    <p>审计是确认入侵或攻击的一种重要辅助。日志记录入侵或攻击的行为和方式。</p>
  </li>
  <li>
    <p>注册表（Windows）</p>

    <p>许多安全相关的设置被保存在注册表中。通过应用受限的Windows ACL并阻止远程注册表的管理保护注册表的安全。</p>
  </li>
</ul>

<p><strong>应用程序安全</strong></p>

<ul>
  <li>
    <p>输入校验（Input Validation）</p>

    <p>输入校验是指应用程序对输入进行处理之前，进行有效性和安全性的检查，如过滤，打磨或拒绝输入。</p>
  </li>
  <li>
    <p>认证</p>

    <p>“Who are you?” 认证是通常使用用户名和密码对实体进行身份证实的过程。</p>
  </li>
  <li>
    <p>授权</p>

    <p>“What can you do?” 授权是应用程序对资源和操作的访问控制。</p>
  </li>
  <li>
    <p>配置管理</p>

    <p>Who does your application run as? Which databases does it connect to? How is your application administered? How are these settings secured?</p>
  </li>
  <li>
    <p>敏感数据</p>

    <p>敏感数据是指应用程序对内存中，网络中或持久化存储的数据的安全保护。</p>
  </li>
  <li>
    <p>会话管理</p>

    <p>会话是指用户和Web应用之间一系列相关的交互。会话管理是指应用程序如何处理并保护这些交互。</p>
  </li>
  <li>
    <p>加密</p>

    <p>如何保护密码，隐私？如何防止数据或资料库篡改（数据的完整性）？如何提供用于增强加密的随机数的种子？加密是指应用程序如何增强保密和隐私。</p>
  </li>
  <li>
    <p>参数处理</p>

    <p>表单字段，查询字符串参数和Cookie值常常作为应用程序的参数。参数处理是指如何保护参数值不被篡改和应用程序如何对处理参数的输入。</p>
  </li>
  <li>
    <p>错误（异常）管理</p>

    <p>When a method call in your application fails, what does your application do? How much do you reveal? Do you return friendly error information to end users? Do you pass valuable exception information back to the caller? Does your application fail gracefully?</p>
  </li>
  <li>
    <p>审计和日志</p>

    <p>Who did what and when? Auditing and logging refer to how your application records security-related events.</p>
  </li>
</ul>

<p><strong>安全准则</strong></p>

<ul>
  <li>
    <p>隔离（Compartmentalize）</p>
  </li>
  <li>
    <p>最低权限（Use least privilege）</p>
  </li>
  <li>
    <p>深度防御（Apply defense in depth）</p>
  </li>
  <li>
    <p>不要相信用户的输入（Do not trust user input）</p>
  </li>
  <li>
    <p>检查入口（Check at the gate）</p>
  </li>
  <li>
    <p>安全的失败（Fail securely）</p>
  </li>
  <li>
    <p>保护脆弱的结点（Secure the weakest link）</p>
  </li>
  <li>
    <p>创建安全的缺省（Create secure defaults）</p>
  </li>
  <li>
    <p>减小攻击面（Reduce your attack surface）</p>

    <p>If you don’t use it, remove it or disable it.</p>
  </li>
</ul>

<hr />

<h3 id="references">References</h3>

<ul>
  <li><a href="https://msdn.microsoft.com/en-us/library/ff648636.aspx#c01618429_004">Chapter 1- Web Application Security Fundamentals</a></li>
</ul>

  </div>

  <ul class="post-navigation">
    <li>
      
      <a href="/2016/03/28/goroutine-uder-the-hood/">&laquo; goroutine 背后的系统知识</a>
      
    </li>
    <li>
      
      <a href="/2016/04/02/database-index-and-data-structure/">Database index and data structure &raquo;</a>
      
    </li>
  </ul>
</article>

      </div>
    </div>

    <footer class="site-footer">
  <div class="license">
    <span>Article licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></span>
  </div>
  
  <details open>
    <summary>Extral Links</summary>
    <div>
      
      <a href="https://jekyllrb.com/">Jekyll</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://shopify.github.io/">Liquid</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://docs.asciidoctor.org/">Asciidoctor</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://github.com/qqbuby/">GitHub</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="/feed.xml">RSS</a>
      
      
    </div>
  </details>
  
</footer>


<!-- https://github.com/bryanbraun/anchorjs -->
<script src="/js/anchor.min.js"></script>
<script>
  anchors.add();
  anchors.remove(".site-title");
</script>




  </body>

</html>

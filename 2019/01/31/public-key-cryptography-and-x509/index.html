<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bing WebMaster -->
  <meta name="msvalidate.01" content="AB2FFF876C37F59D9121882CC8395DE5" />

  <title>Cryptography and Public Key Infrastructure</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://blog.codefarm.me/2019/01/31/public-key-cryptography-and-x509/">
  <link rel="alternate" type="application/rss+xml" title="CODE FARM" href="https://blog.codefarm.me/feed.xml">

  <!-- https://cdn.jsdelivr.net/gh/lurongkai/anti-baidu/js/anti-baidu-latest.min.js -->
<script type="text/javascript" src="/js/anti-baidu.min.js" charset="UTF-8"></script>

  
<!-- Google Analytics Website tracking -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83971182-1', 'auto');
  ga('send', 'pageview');

</script>


  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SN88FJ18E5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SN88FJ18E5');
</script>



</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <h2 class="site-title">
      <a class="site-title" href="/">CODE FARM</a>
    </h2>

     <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
        <div class="trigger">
            <ul>
                <li><a href="/">home</a>
                <li><a href="/category">category</a>
                <li><a href="/tag">tag</a>
                <li><a href="/archive">archive</a>
                <li><a href="/about">about</a>
                <li><a href="https://resume.github.io/?qqbuby" target="_blank">R&eacute;sum&eacute;</a>
            </ul>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Cryptography and Public Key Infrastructure</h1>
    
    
    <p class="post-meta"><time datetime="2019-01-31T14:31:20+08:00" itemprop="datePublished">Dec 21, 2021</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#cryptography">1. Cryptography</a>
<ul class="sectlevel2">
<li><a href="#symmetric-encryption">1.1. Symmetric Encryption</a></li>
<li><a href="#asymmetric-encryption">1.2. Asymmetric Encryption</a>
<ul class="sectlevel3">
<li><a href="#asymmetric-signing">1.2.1. Asymmetric Signing</a></li>
<li><a href="#rsa-rivest-shamir-adleman">1.2.2. RSA (Rivest-Shamir-Adleman)</a></li>
</ul>
</li>
<li><a href="#combining-symmetric-and-asymmetric-encryption">1.3. Combining Symmetric and Asymmetric Encryption</a></li>
<li><a href="#signing">1.4. Signing</a></li>
</ul>
</li>
<li><a href="#asn-1-der-and-pem">2. ASN.1, DER and PEM</a>
<ul class="sectlevel2">
<li><a href="#abstract-syntax-notation-one-asn-1">2.1. Abstract Syntax Notation One (<strong>ASN.1</strong>)</a></li>
<li><a href="#x-690-ber-cer-der">2.2. X.690 BER CER <strong>DER</strong></a></li>
<li><a href="#privacy-enhanced-mail-pem">2.3. Privacy-Enhanced Mail (<strong>PEM</strong>)</a></li>
</ul>
</li>
<li><a href="#public-key-cryptography-standards-pkcs">3. Public Key Cryptography Standards (<strong>PKCS</strong>)</a>
<ul class="sectlevel2">
<li><a href="#pkcs-1">3.1. PKCS #1</a></li>
<li><a href="#pkcs-7">3.2. PKCS #7</a></li>
<li><a href="#pkcs-8">3.3. PKCS #8</a></li>
<li><a href="#pkcs-10">3.4. PKCS #10</a></li>
</ul>
</li>
<li><a href="#public-key-certificates">4. Public Key Certificates</a></li>
<li><a href="#x-509-public-key-certificates">5. X.509 Public Key Certificates</a>
<ul class="sectlevel2">
<li><a href="#certificate-fields">5.1. Certificate Fields</a></li>
<li><a href="#certificate-formats">5.2. Certificate Formats</a></li>
</ul>
</li>
<li><a href="#openssl">6. OpenSSL</a>
<ul class="sectlevel2">
<li><a href="#self-signed-certificate">6.1. Self-signed Certificate</a></li>
<li><a href="#show-certificate">6.2. Show Certificate:</a></li>
<li><a href="#sign-certificate-signing-request">6.3. Sign Certificate Signing Request</a></li>
<li><a href="#verify-certificate-signature">6.4. Verify Certificate Signature</a></li>
<li><a href="#generate-certificate-with-subjectaltname">6.5. Generate Certificate with <code>subjectAltName</code></a></li>
<li><a href="#create-csr-with-config-file">6.6. Create CSR with Config File</a></li>
<li><a href="#how-to-convert-a-certificate-into-the-appropriate-format">6.7. How to Convert a Certificate into the Appropriate Format</a></li>
</ul>
</li>
<li><a href="#references">7. References</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="cryptography">1. Cryptography</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Cryptography</strong> is used to protect information and communications.</p>
</div>
<div class="paragraph">
<p>This is typically done by using cryptographic techniques to scramble plaintext (ordinary text) into ciphertext (encoded text) and back again.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This scrambling process is called <strong>encryption</strong>.</p>
</li>
<li>
<p>The reverse process is called <strong>decryption</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Cryptography is concerned with the following objectives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Confidentiality</strong>: The information can be understood by only the intended audience.</p>
</li>
<li>
<p><strong>Integrity</strong>: The information cannot be altered in storage or in transit.</p>
</li>
<li>
<p><strong>Non-repudiation</strong>: The creator of information cannot later deny that creation.</p>
</li>
<li>
<p><strong>Authentication</strong>: The sender and receiver can confirm each other&#8217;s identity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>encryption</strong> process requires an algorithm and a key.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>algorithm</strong> defines how data is transformed from plaintext into ciphertext and back to plaintext.</p>
</li>
<li>
<p>A <strong>key</strong> is a random string of data used as input to the algorithm.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of the security of the process is contained in the key. Therefore, the key must be stored securely. The details of the most popular algorithms, however, are publicly available.</p>
</div>
<div class="paragraph">
<p>There are two types of encryption.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Symmetric encryption</strong> uses the same key for both encryption and decryption.</p>
</li>
<li>
<p><strong>Asymmetric encryption</strong> uses different but mathematically related keys to perform encryption and decryption.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In cryptography, a <strong>cryptosystem</strong> is a suite of cryptographic algorithms needed to implement a particular security service, most commonly for achieving confidentiality (encryption).</p>
</div>
<div class="paragraph">
<p>Typically, a cryptosystem consists of three algorithms: one for <a href="https://en.wikipedia.org/wiki/Key_generation">key generation</a>, one for encryption, and one for decryption.</p>
</div>
<div class="paragraph">
<p>The term <em>cipher</em> (sometimes <em>cypher</em>) is often used to refer to a pair of algorithms, one for encryption and one for decryption. Therefore, the term <em>cryptosystem</em> is most often used when the key generation algorithm is important. For this reason, the term <em>cryptosystem</em> is commonly used to refer to <a href="https://en.wikipedia.org/wiki/Public_key_cryptography">public key</a> techniques; however both "cipher" and "cryptosystem" are used for <a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm">symmetric key</a> techniques.</p>
</div>
<div class="sect2">
<h3 id="symmetric-encryption">1.1. Symmetric Encryption</h3>
<div class="paragraph">
<p><strong>Symmetric encryption</strong> uses the same key to encrypt plaintext into ciphertext and decrypt ciphertext back into plaintext. The necessary length of the key, expressed in number of bits, is determined by the algorithm. After the key is used to encrypt plaintext, the encrypted message is sent to the recipient who then decrypts the ciphertext.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://docs.microsoft.com/en-us/azure/iot-hub/media/tutorial-x509-introduction/symmetric-keys.png" alt="symmetric keys" width="65%" height="65%">
</div>
</div>
<div class="paragraph">
<p><strong>Symmetric-key algorithms</strong> are algorithms for cryptography that use the same <a href="https://en.wikipedia.org/wiki/Key_(cryptography)">cryptographic keys</a> for both encryption of <a href="https://en.wikipedia.org/wiki/Plaintext">plaintext</a> and decryption of <a href="https://en.wikipedia.org/wiki/Ciphertext">ciphertext</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The keys may be identical or there may be a simple transformation to go between the two keys.</p>
</li>
<li>
<p>The keys, in practice, represent a <a href="https://en.wikipedia.org/wiki/Shared_secret">shared secret</a> between two or more parties that can be used to maintain a private information link.</p>
<div class="paragraph">
<p>This requirement that both parties have access to the secret key is one of the main drawbacks of symmetric key encryption, in comparison to <a href="https://en.wikipedia.org/wiki/Public_key_encryption">public-key encryption</a> (also known as asymmetric key encryption).</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="asymmetric-encryption">1.2. Asymmetric Encryption</h3>
<div class="paragraph">
<p>If only symmetric encryption is used, the problem is that all parties to the communication must possess the private key. However, it is possible that unauthorized third parties can capture the key during transmission to authorized users. To address this issue, use asymmetric or public key cryptography instead.</p>
</div>
<div class="paragraph">
<p>In asymmetric cryptography, every user has two mathematically related keys called a key pair. One key is public and the other key is private. The key pair ensures that only the recipient has access to the private key needed to decrypt the data. The following illustration summarizes the asymmetric encryption process.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://docs.microsoft.com/en-us/azure/iot-hub/media/tutorial-x509-introduction/asymmetric-keys.png" alt="asymmetric keys" width="55%" height="55%">
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The recipient creates a public-private key pair and sends the <strong>public key</strong> to a CA.
<div class="paragraph">
<p>The <strong>CA</strong> packages the public key in an <strong>X.509 certificate</strong>.</p>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The sending party obtains the recipient&#8217;s public key from the CA.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The sender encrypts plaintext data using an encryption algorithm.
<div class="paragraph">
<p>The recipient&#8217;s public key is used to perform encryption.</p>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The sender transmits the ciphertext to the recipient.
<div class="paragraph">
<p>It isn&#8217;t necessary to send the key because the recipient already has the private key needed to decrypt the ciphertext.</p>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The recipient decrypts the ciphertext by using the specified asymmetric algorithm and the <strong>private key</strong>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Public-key cryptography</strong>, or <strong>asymmetric cryptography</strong>, is a cryptographic system that uses public-private key pair of <a href="https://en.wikipedia.org/wiki/Cryptographic_key">keys</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>public keys</strong> which may be disseminated widely,</p>
</li>
<li>
<p>and <strong>private keys</strong> which are known only to the owner.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The generation of such keys depends on cryptographic algorithms based on mathematical problems to produce one-way functions. Effective security only requires keeping the private key private; the public key can be openly distributed without compromising security.</p>
</div>
<div class="paragraph">
<p>In such a system, any person can encrypt a message using the receiver&#8217;s <em>public key</em>, but that encrypted message can only be decrypted with the receiver&#8217;s <em>private key</em>.</p>
</div>
<div class="sect3">
<h4 id="asymmetric-signing">1.2.1. Asymmetric Signing</h4>
<div class="paragraph">
<p>Asymmetric algorithms can be used to protect data from modification (integrity) and prove the identity of the data creator (non-repudiation). The following illustration shows how asymmetric signing helps prove the sender&#8217;s identity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://docs.microsoft.com/en-us/azure/iot-hub/media/tutorial-x509-introduction/asymmetric-signing.png" alt="asymmetric signing" width="45%" height="45%">
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The sender passes plaintext data through an asymmetric encryption algorithm, using the private key for encryption.
<div class="paragraph">
<p>Notice that this scenario reverses use of the private and public keys outlined in the preceding section that detailed asymmetric encryption.</p>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The resulting ciphertext is sent to the recipient.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The recipient obtains the originator&#8217;s public key from a directory.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The recipient decrypts the ciphertext by using the originator&#8217;s public key.
<div class="paragraph">
<p>The resulting plaintext proves the originator&#8217;s identity because only the originator has access to the private key that initially encrypted the original text.</p>
</div></td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rsa-rivest-shamir-adleman">1.2.2. RSA (Rivest-Shamir-Adleman)</h4>
<div class="paragraph">
<p><strong>RSA (Rivest&#8212;&#8203;Shamir&#8212;&#8203;Adleman)</strong> is one of the first <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public-key cryptosystems</a> and is widely used for secure data transmission.</p>
</div>
<div class="paragraph">
<p>In such a <a href="https://en.wikipedia.org/wiki/Cryptosystem">cryptosystem</a>, the <a href="https://en.wikipedia.org/wiki/Encryption_key">encryption key</a> is public and it is different from the <a href="https://en.wikipedia.org/wiki/Decryption_key">decryption key</a> which is kept secret (private).</p>
</div>
<div class="paragraph">
<p>The acronym RSA is made of the initial letters of the surnames of Ron Rivest, Adi Shamir, and Leonard Adleman, who first publicly described the algorithm in 1978.</p>
</div>
<div class="paragraph">
<p>RSA is a relatively slow algorithm, and because of this, it is less commonly used to directly encrypt user data.</p>
</div>
<div class="paragraph">
<p>More often, RSA passes encrypted shared keys for <a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm">symmetric key</a> cryptography which in turn can perform bulk encryption-decryption operations at much higher speed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="combining-symmetric-and-asymmetric-encryption">1.3. Combining Symmetric and Asymmetric Encryption</h3>
<div class="paragraph">
<p>Symmetric and asymmetric encryption can be combined to take advantage of their relative strengths.</p>
</div>
<div class="paragraph">
<p>Symmetric encryption is much faster than asymmetric but, because of the necessity of sending private keys to other parties, is not as secure.</p>
</div>
<div class="paragraph">
<p>To combine the two types together,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>symmetric encryption can be used to convert plaintext to ciphertext.</p>
</li>
<li>
<p>Asymmetric encryption is used to exchange the symmetric key.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is demonstrated by the following diagram.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://docs.microsoft.com/en-us/azure/iot-hub/media/tutorial-x509-introduction/symmetric-asymmetric-encryption.png" alt="symmetric asymmetric encryption" width="65%" height="65%">
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The sender retrieves the recipient&#8217;s public key.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The sender generates a symmetric key and uses it to encrypt the original data.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The sender uses the recipient&#8217;s public key to encrypt the symmetric key.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The sender transmits the encrypted symmetric key and the ciphertext to the intended recipient.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The recipient uses the private key that matches the recipient&#8217;s public key to decrypt the sender&#8217;s symmetric key.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The recipient uses the symmetric key to decrypt the ciphertext.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="signing">1.4. Signing</h3>
<div class="paragraph">
<p><strong>Digital signing</strong> can be used to determine whether the data has been modified in transit or at rest.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The data is passed through a <strong>hash algorithm</strong>, a one-way function that produces a mathematical result from the given message.</p>
</li>
<li>
<p>The result is called a <strong>hash value</strong>, <strong>message digest</strong>, <strong>digest</strong>, <strong>signature</strong>, or <strong>thumbprint</strong>.</p>
</li>
<li>
<p>A hash value cannot be reversed to obtain the original message.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because a small change in the message results in a significant change in the thumbprint, the hash value can be used to determine whether a message has been altered.</p>
</div>
<div class="paragraph">
<p>The following illustration shows how asymmetric encryption and hash algorithms can be used to verify that a message has not been modified.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://docs.microsoft.com/en-us/azure/iot-hub/media/tutorial-x509-introduction/signing.png" alt="signing" width="75%" height="75%">
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The sender creates a <strong>plaintext message</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The sender hashes the plaintext message to create a <strong>message digest</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The sender encrypts the digest using a <strong>private key</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The sender transmits the plaintext message and the encrypted digest to the intended recipient.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The recipient decrypts the digest by using the sender&#8217;s <strong>public key</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The recipient runs the same <strong>hash algorithm</strong> that the sender used over the message.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The recipient compares the resulting signature to the decrypted signature.
<div class="paragraph">
<p>If the digests are the same, the message was not modified during transmission.</p>
</div></td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="asn-1-der-and-pem">2. ASN.1, DER and PEM</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="abstract-syntax-notation-one-asn-1">2.1. Abstract Syntax Notation One (<strong>ASN.1</strong>)</h3>
<div class="paragraph">
<p>Abstract Syntax Notation One (<strong>ASN.1</strong>) is a standard interface description language for defining data structures that can be serialized and deserialized in a cross-platform way.</p>
</div>
<div class="paragraph">
<p>It is broadly used in telecommunications and computer networking, and especially in cryptography.</p>
</div>
<div class="paragraph">
<p>The advantage is that the ASN.1 description of the data encoding is independent of a particular computer or programming language.</p>
</div>
<div class="paragraph">
<p>Because ASN.1 is both human-readable and machine-readable, an ASN.1 compiler can compile modules into libraries of code, codecs, that decode or encode the data structures.</p>
</div>
</div>
<div class="sect2">
<h3 id="x-690-ber-cer-der">2.2. X.690 BER CER <strong>DER</strong></h3>
<div class="paragraph">
<p>X.690 is an ITU-T standard specifying several <strong>ASN.1</strong> encoding formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Basic Encoding Rules (BER)</p>
</li>
<li>
<p>Canonical Encoding Rules (<strong>CER</strong>)</p>
</li>
<li>
<p>Distinguished Encoding Rules (<strong>DER</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>Basic Encoding Rules</strong> were the original rules laid out by the <strong>ASN.1</strong> standard for <strong>encoding</strong> abstract information into a concrete <strong>data stream</strong>.</p>
</div>
<div class="paragraph">
<p>The rules, collectively referred to as a transfer syntax in ASN.1 parlance, specify the exact octet sequences which are used to encode a given data item.</p>
</div>
<div class="paragraph">
<p>The syntax defines such elements as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the representations for basic data types,</p>
</li>
<li>
<p>the structure of length information,</p>
</li>
<li>
<p>and the means for defining complex or compound types based on more primitive types.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The BER syntax, along with two subsets of BER (the <strong>CER</strong> and the <strong>DER</strong>), are defined by the ITU-T&#8217;s X.690 standards document, which is part of the ASN.1 document series.</p>
</div>
</div>
<div class="sect2">
<h3 id="privacy-enhanced-mail-pem">2.3. Privacy-Enhanced Mail (<strong>PEM</strong>)</h3>
<div class="paragraph">
<p>Privacy-Enhanced Mail (<strong>PEM</strong>) is a de facto file format for storing and sending cryptographic <strong>keys</strong>, <strong>certificates</strong>, and other data, based on a set of 1993 IETF standards defining "privacy-enhanced mail."</p>
</div>
<div class="paragraph">
<p>Many cryptography standards use <strong>ASN.1</strong> to define their data structures, and Distinguished Encoding Rules (<strong>DER</strong>) to serialize those structures.</p>
</div>
<div class="paragraph">
<p>Because DER produces binary output, it can be challenging to transmit the resulting files through systems, like electronic mail, that only support ASCII.</p>
</div>
<div class="paragraph">
<p>The PEM format solves this problem by encoding the binary data using <strong>base64</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PEM also defines a one-line header, consisting of <strong>-----BEGIN, a label, and -----</strong>, and a one-line footer, consisting of <strong>-----END, a label, and -----</strong>.</p>
</li>
<li>
<p>The label determines the type of message encoded.</p>
</li>
<li>
<p>Common labels include <strong>CERTIFICATE</strong>, <strong>CERTIFICATE REQUEST</strong>, <strong>PRIVATE KEY</strong> and <strong>X509 CRL</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>PEM data is commonly stored in files with a</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"<strong>.pem</strong>" suffix, a "<strong>.cer</strong>"</p>
</li>
<li>
<p>or "<strong>.crt</strong>" suffix (for certificates),</p>
</li>
<li>
<p>or a "<strong>.key</strong>" suffix (for public or private keys).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>label</strong> inside a PEM file represents the type of the data more accurately than the file suffix, since many different types of data can be saved in a ".pem" file.</p>
</div>
<div class="paragraph">
<p>In particular PEM refers to the header and base64 wrapper for a binary format contained within, but does not specify any type or format for the binary data, so that a PEM file may contain "almost anything base64 encoded and wrapped with BEGIN and END lines".</p>
</div>
<div class="paragraph">
<p>A PEM file may contain multiple instances.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For instance, an operating system might provide a file containing a list of trusted CA certificates,</p>
</li>
<li>
<p>or a web server might be configured with a "chain" file containing an end-entity certificate plus a list of intermediate certificates.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="public-key-cryptography-standards-pkcs">3. Public Key Cryptography Standards (<strong>PKCS</strong>)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In cryptography, <a href="https://en.wikipedia.org/wiki/PKCS"><strong>PKCS</strong></a> stands for "Public Key Cryptography Standards".</p>
</div>
<div class="paragraph">
<p>These are a group of public-key cryptography standards devised and published by RSA Security LLC, starting in the early 1990s.</p>
</div>
<div class="paragraph">
<p>The company published the standards to promote the use of the cryptography techniques to which they had patents, such as the RSA algorithm, the Schnorr signature algorithm and several others.</p>
</div>
<div class="paragraph">
<p>Though not industry standards (because the company retained control over them), some of the standards in recent years have begun to move into the "standards-track" processes of relevant standards organizations such as the IETF and the PKIX working-group.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 22.2222%;">
<col style="width: 55.5556%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS #1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSA Cryptography Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See RFC 8017. Defines the mathematical properties and format of RSA public and private keys (ASN.1-encoded in clear-text), and the basic algorithms and encoding/padding schemes for performing RSA encryption, decryption, and producing and verifying signatures.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS #7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cryptographic Message Syntax Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See RFC 2315. Used to sign and/or encrypt messages under a PKI. Used also for certificate dissemination (for instance as a response to a PKCS #10 message). Formed the basis for S/MIME, which is as of 2010 based on RFC 5652, an updated Cryptographic Message Syntax Standard (CMS). Often used for single sign-on.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS #8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private-Key Information Syntax Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See RFC 5958. Used to carry private certificate keypairs (encrypted or unencrypted).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS #10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certification Request Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See RFC 2986. Format of messages sent to a certification authority to request certification of a public key. See certificate signing request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS #12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Personal Information Exchange Syntax Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See RFC 7292. Defines a file format commonly used to store private keys with accompanying public key certificates, protected with a password-based symmetric key. <strong>PFX</strong> is a predecessor to PKCS #12.
+
This container format can contain multiple embedded objects, such as multiple certificates. Usually protected/encrypted with a password.</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="pkcs-1">3.1. PKCS #1</h3>
<div class="paragraph">
<p>In cryptography, <strong>PKCS #1</strong> is the first of a family of standards called Public-Key Cryptography Standards (PKCS), published by <a href="https://en.wikipedia.org/wiki/RSA_Laboratories">RSA Laboratories</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It provides the basic definitions of and recommendations for implementing the <strong>RSA</strong> algorithm for public-key cryptography.</p>
</li>
<li>
<p>It defines</p>
<div class="ulist">
<ul>
<li>
<p>the mathematical properties of public and private keys,</p>
</li>
<li>
<p>primitive operations for encryption and signatures,</p>
</li>
<li>
<p>secure cryptographic schemes,</p>
</li>
<li>
<p>and related <strong>ASN.1</strong> syntax representations.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>openssl genrsa <span class="nt">-out</span> pkc1.pem 512
<span class="go">Generating RSA private key, 512 bit long modulus (2 primes)
.....+++++++++++++++++++++++++++
.........+++++++++++++++++++++++++++
e is 65537 (0x010001)

</span><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>pkc1.pem
<span class="go">-----BEGIN RSA PRIVATE KEY-----
MIIBOwIBAAJBAPpyrGCXa2k1hGUuGSDTVxGKoWzBO+YHKZ7xdkxnvqWJyHnvxXQS
06DmVFRt20LYtgAx3TN/C4dz98C/FW/Ryc0CAwEAAQJBAJa0Il4NP6kTdxObZauH
AMGhdfmHXY/Rh44JJnJbizD4Q1pTglSMLPDWMMZP2ojlNlTJINN+BsuotCnyeUXj
QFECIQD9qfYNkn5e5PRfSsySjT/wKgyEwvDGXpFU8LXJWC454wIhAPzBIVacmP2L
B9YOiJWxrXJk9otG/c5GnqhndCB+LPyPAiA773W43T1ItLZc8bKGiiNqXrUYhWsY
o+2Y8UsyqMg7WwIhAK5dIX2ZnGVUszw1XH5AS5JeGkLs34yc5Tjx3YfI44n7AiBL
Q60mfKn/P4J4aVzYqTkFLPpprieOTbveV4vUlqf7/Q==
-----END RSA PRIVATE KEY-----

</span><span class="gp">$</span><span class="w"> </span>openssl pkcs8 <span class="nt">-in</span> rsa.pem <span class="nt">-topk8</span> <span class="nt">-nocrypt</span>
<span class="go">-----BEGIN PRIVATE KEY-----
MIIBVQIBADANBgkqhkiG9w0BAQEFAASCAT8wggE7AgEAAkEAtiT1WDsvrECjWC2n
At+yPN/fWl7jWHHOEd0XH3ra5A9QEw9tR59AJiqE+HlveygetOHp399VHOFmsdQp
4AeYnwIDAQABAkEAi2bx11tE+0JlQaF/BvYJxglZOiMRQKmpG4booZE3Yf8DGG78
rxwTGvyPFQhv+rrDeeqtW+snMZbBNXZvjYtGYQIhAOViHfmDXQ5qEVlc3NLgWBG1
+l7oh7ZiMZHUr5faOtl5AiEAy0eZTXoV0fM4yygvX54i+jhfjxjnGCq/aiamj5Kp
lNcCIQCVyr4CS4uANzm/HopB1ykL38dxJO5C5tqx/a7xPhyCGQIgJ5J6n4CCuupU
Rgg+oKiSOo+62oqIgkXgGXQIvK5aYOUCIEAoNlXayIK3vB4GNDtnNkOp+sW23fw8
X4CTyXy2l/Qi
-----END PRIVATE KEY-----</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pkcs-7">3.2. PKCS #7</h3>
<div class="paragraph">
<p>In cryptography, "<strong>PKCS #7</strong>: Cryptographic Message Syntax" (a.k.a. "CMS") is a standard syntax for storing signed and/or encrypted data.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PKCS #7 files may be stored both as raw <strong>DER</strong> format or as <strong>PEM</strong> format.</p>
</li>
<li>
<p>PEM format is the same as DER format but wrapped inside Base64 encoding and sandwiched in between ----BEGIN PKCS7---- and ----END PKCS7----.</p>
</li>
<li>
<p>Windows uses the "<strong>.p7b</strong>" file name extension for both these encodings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A typical use of a PKCS #7 file would be to store certificates and/or certificate revocation lists.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of how to first download a certificate, then wrap it inside a PKCS #7 archive and then read from that archive:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>openssl s_client <span class="nt">-connect</span> local.io:443 <span class="nt">-xcertform</span> PEM &lt;/dev/null 2&gt;/dev/null  | openssl x509 <span class="o">&gt;</span> local.io.pem
<span class="go">
</span><span class="gp">$</span><span class="w"> </span>openssl crl2pkcs7 <span class="nt">-nocrl</span> <span class="nt">-certfile</span> local.io.pem <span class="nt">-out</span> local.io.p7b
<span class="go">
</span><span class="gp">$</span><span class="w"> </span>openssl pkcs7 <span class="nt">-in</span> local.io.p7b <span class="nt">-noout</span> <span class="nt">-print_certs</span>
<span class="go">subject=C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = *.local.io

issuer=C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = *.local.io</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pkcs-8">3.3. PKCS #8</h3>
<div class="paragraph">
<p>In cryptography, <strong>PKCS #8</strong> is a standard syntax for storing private key information.</p>
</div>
<div class="paragraph">
<p>The PKCS #8 private key may be encrypted with a <strong>passphrase</strong> using the PKCS #5 standards, which supports multiple ciphers.</p>
</div>
<div class="paragraph">
<p>PKCS #8 private keys are typically exchanged in the PEM base64-encoded format, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>openssl genpkey <span class="nt">-algorithm</span> RSA <span class="se">\</span>
<span class="gp">    -pkeyopt rsa_keygen_bits:512 -out key.pem   #</span><span class="w"> </span>512 bits is a weak key, please specify 2048+ bits.
<span class="go">.................+++++++++++++++++++++++++++
........+++++++++++++++++++++++++++

</span><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>key.pem
<span class="go">-----BEGIN PRIVATE KEY-----
MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAuGVDfMa5TyUZIEW0
pgvlN/xajzoaDe9yV6GDqqUHdBU/NtaynIXSkxEoupkGUBGama0OXI8TzpUJCjcR
IkkAbwIDAQABAkBhPy6HaLqkLdmBdqGeDJn3m8Qa0zaYcNaptomc/mne4svm2K1x
GVaNAFBlS3eFd8u/gYJHpCKBlVcBmWkabZhxAiEA6fOr7roNKOM9OyM3//sWhT0Z
B0uthEo4GLqRCgdt9/kCIQDJxf7v7UtUIPeYm+fSYaL4kb35RBpr1zsm77w6YC9l
pwIhAN8/ARA7RheAUIvAHc4Ngf3+wYVut9OHJ2Shk4nocQ2xAiAfY1ikVEK6pKI/
sEkg1iV3C50E8M43ZnUCOpsKbboR0wIgYIjtYrXncmuxnSnUXrr3A0yEU5feX1h6
n+hSMkACSC4=
-----END PRIVATE KEY-----

</span><span class="gp">$</span><span class="w"> </span>openssl pkey <span class="nt">-in</span> key.pem <span class="nt">-pubout</span>
<span class="go">-----BEGIN PUBLIC KEY-----
MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALhlQ3zGuU8lGSBFtKYL5Tf8Wo86Gg3v
clehg6qlB3QVPzbWspyF0pMRKLqZBlARmpmtDlyPE86VCQo3ESJJAG8CAwEAAQ==
-----END PUBLIC KEY-----

</span><span class="gp">$</span><span class="w"> </span>openssl pkcs8 <span class="nt">-in</span> key.pem <span class="nt">-topk8</span>
<span class="go">Enter Encryption Password:
Verifying - Enter Encryption Password:
-----BEGIN ENCRYPTED PRIVATE KEY-----
MIIBvTBXBgkqhkiG9w0BBQ0wSjApBgkqhkiG9w0BBQwwHAQIrXICjrjhXx8CAggA
MAwGCCqGSIb3DQIJBQAwHQYJYIZIAWUDBAEqBBCGwam45e0nuiAGJLqz/7UcBIIB
YCgOeAEb8rCnnVSeiL5jzD0KxUAA9PQ8FHTFjrrSeFHkUF3FTdJDxFgCeXyhErtJ
ty4X9jf28+l9x9FYZoqrB9LiIX+ntMhtmEiAj5n0vML1FCheGdXstJC2v3l4f0x3
u/Fv5DJaVnYKKECo62xDDE41eZHTJLZDUdJTo7r210M6hopxL4fnwvekEQF7Awi3
eQBR6uif5uTUlidw0czvEt5YLeOURzXW9y9AvM7onx32sU/mmqc8Gp2i/0hOs0SG
0XC5LYmnZ/5WJSn0lwtoNl1ZAmOA73/D8cO6mHp1+pBT2jM3tWpXy7Cywb4OAHQy
8Gg6A5HmULKf5hzQBGjWiD2ZD2fEHQP8rmilE0s+JvifWmmFfLiTuO4xCgH82XE9
77Hj7yk1Rp4ewQpfau58yKxjjETHRTOosM/rWaC9oDCzSuOuuPApiQyHdYD9/Ylg
m1SedRD9NuA2pE3oK3X42yM=
-----END ENCRYPTED PRIVATE KEY-----</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pkcs-10">3.4. PKCS #10</h3>
<div class="paragraph">
<p>In public key infrastructure (PKI) systems, a <strong>certificate signing request</strong> (also <strong>CSR</strong> or <strong>certification request</strong>) is a message sent from an applicant to a {certificate_authority}[certificate authority] in order to apply for a <a href="https://en.wikipedia.org/wiki/Public_key_certificate">digital identity certificate</a>.</p>
</div>
<div class="paragraph">
<p>It usually contains the <strong>public key</strong> for which the certificate should be issued, <strong>identifying information</strong> (such as a domain name) and <strong>integrity protection</strong> (e.g., a digital signature).</p>
</div>
<div class="paragraph">
<p>The most common format for CSRs is the <strong>PKCS #10</strong> specification and another is the Signed Public Key and Challenge SPKAC format generated by some web browsers.</p>
</div>
<div class="paragraph">
<p>Before creating a CSR, the applicant first generates a <strong>key pair</strong>, keeping the private key secret.</p>
</div>
<div class="paragraph">
<p>The CSR contains information identifying the applicant (such as a <strong>distinguished name</strong> in the case of an X.509 certificate) which must be signed using the applicant&#8217;s <strong>private key</strong>.</p>
</div>
<div class="paragraph">
<p>The CSR also contains the <strong>public key</strong> chosen by the applicant.</p>
</div>
<div class="paragraph">
<p>The CSR may be accompanied by other credentials or proofs of identity required by the <strong>certificate authority</strong>, and the certificate authority may contact the applicant for further information.</p>
</div>
<div class="paragraph">
<p>A certification request consists of three main parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the certification request information,</p>
</li>
<li>
<p>a signature algorithm identifier,</p>
</li>
<li>
<p>and a digital signature on the certification request information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first part contains the significant information, including the public key.</p>
</div>
<div class="paragraph">
<p>The signature by the requester prevents an entity from requesting a bogus certificate of someone else&#8217;s public key. Thus the private key is needed to produce, but it is not part of, the CSR.</p>
</div>
<div class="paragraph">
<p>The PKCS#10 standard defines a binary format (<strong>DER</strong>) for encoding CSRs expressed in <strong>ASN.1</strong>.</p>
</div>
<div class="paragraph">
<p>A CSR may also be represented as a Base64 encoded PKCS#10 (<strong>PEM</strong>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>openssl genrsa <span class="nt">-out</span> key.pem 2048
<span class="go">Generating RSA private key, 2048 bit long modulus (2 primes)
.............................+++++
....+++++
e is 65537 (0x010001)

</span><span class="gp">$</span><span class="w"> </span>openssl req <span class="nt">-x509</span> <span class="nt">-new</span> <span class="nt">-key</span> key.pem <span class="nt">-subj</span> <span class="s2">"/CN=example.com"</span> <span class="nt">-out</span> req.pem
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>req.pem
<span class="go">-----BEGIN CERTIFICATE-----
MIIDDTCCAfWgAwIBAgIUQ7SPGfNcoaVJ5m/I6Hyley7IG2gwDQYJKoZIhvcNAQEL
BQAwFjEUMBIGA1UEAwwLZXhhbXBsZS5jb20wHhcNMjExMjIxMDcyMTIyWhcNMjIw
MTIwMDcyMTIyWjAWMRQwEgYDVQQDDAtleGFtcGxlLmNvbTCCASIwDQYJKoZIhvcN
AQEBBQADggEPADCCAQoCggEBALSzGjH++EooGvOGZgkfOBWGHMc8GXnMS1Pst+S8
O/IgF1rsDffGOFLtKCsMoSIwc6qq3Et8N9mnwORITjp1fVdhAToeWAsGim4evRRf
1YUSghtbO/BGeu19sbgnGHqA3ExO5lm2zcE3TxgIZkOkYQAgLbR/svav922xj85Z
HsuvnOPxemWNUxCCBsucu95QhQ5CLTjNDkxfPV9B9V6OfdhpoOtQowKt5ueUvLqt
1L+EgetUxnHz9+rPBBgO22qgvcVnkIn0oAJ8/s8s1BUhtNdvILZ1cAwEOGqNbya2
IL0Z5U+UUhiprC4o80K9EBDvU/xQUX524EjlD0wZq7Ncn2MCAwEAAaNTMFEwHQYD
VR0OBBYEFL6KbULLcDDedyr4opkFYg6owGOBMB8GA1UdIwQYMBaAFL6KbULLcDDe
dyr4opkFYg6owGOBMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEB
AKnFgZPtyU9UXNxoO4C2vOxTix9oVwx02q2oQJpwZdviO83r8Z8FE6/ZX+GdVEAz
g9btu/relajtaZwUzz9PSAA7W6j123tzu8USU7iROaRFFV6zejk/qxk0ahibNato
WQCxemcIev1FiA9bR9m3q84K7etEb9+mO+MYXPzvOZsRE/g52h9X34+ZuRlxCutC
oI6Nv4Bj61t5a/7jcBBDJCXQ4iI6GhVyYw/o2NeYpjmLVrxbDu4+oQ9l/JQYMBz9
9JcZOp5K5HL4fLj6UJYP/o0tJSBar2Db08Z16btSFnBXlnR02elfeLYx9mz6fdlt
/268X2cHeQJtLTfNvk5LFuU=
-----END CERTIFICATE-----

</span><span class="gp">$</span><span class="w"> </span>openssl asn1parse <span class="nt">-i</span> <span class="nt">-in</span> req.pem
<span class="go">    0:d=0  hl=4 l= 781 cons: SEQUENCE
    4:d=1  hl=4 l= 501 cons:  SEQUENCE
    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]
   10:d=3  hl=2 l=   1 prim:    INTEGER           :02
   13:d=2  hl=2 l=  20 prim:   INTEGER           :43B48F19F35CA1A549E66FC8E87CA57B2EC81B68
   35:d=2  hl=2 l=  13 cons:   SEQUENCE
   37:d=3  hl=2 l=   9 prim:    OBJECT            :sha256WithRSAEncryption
   48:d=3  hl=2 l=   0 prim:    NULL
   50:d=2  hl=2 l=  22 cons:   SEQUENCE
   52:d=3  hl=2 l=  20 cons:    SET
   54:d=4  hl=2 l=  18 cons:     SEQUENCE
   56:d=5  hl=2 l=   3 prim:      OBJECT            :commonName
   61:d=5  hl=2 l=  11 prim:      UTF8STRING        :example.com
</span><span class="c">   ...</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="public-key-certificates">4. Public Key Certificates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <a href="https://en.wikipedia.org/wiki/Cryptography">cryptography</a>, a <strong>public key certificate</strong>, also known as a <strong>digital certificate</strong> or <strong>identity certificate</strong>, is an electronic document used to prove the ownership of a <a href="https://en.wikipedia.org/wiki/Key_authentication">public key</a>.</p>
</div>
<div class="paragraph">
<p>The certificate includes information about the <strong>key</strong>, information about the identity of its owner (called the <strong>subject</strong>), and the <a href="https://en.wikipedia.org/wiki/Digital_signature">digital <strong>signature</strong></a> of an entity that has verified the certificate&#8217;s contents (called the <strong>issuer</strong>).</p>
</div>
<div class="paragraph">
<p>If the signature is valid, and the software examining the certificate trusts the issuer, then it can use that key to communicate securely with the certificate&#8217;s subject.</p>
</div>
<div class="paragraph">
<p>In email encryption, code signing, and e-signature systems, a certificate&#8217;s subject is typically a person or organization.</p>
</div>
<div class="paragraph">
<p>However, in <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer Security (<strong>TLS</strong>)</a> a certificate&#8217;s subject is typically a computer or other device, though TLS certificates may identify organizations or individuals in addition to their core role in identifying devices.</p>
</div>
<div class="paragraph">
<p>TLS, sometimes called by its older name Secure Sockets Layer (SSL), is notable for being a part of <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a>, a protocol for securely browsing the web.</p>
</div>
<div class="paragraph">
<p>In a typical <a href="https://en.wikipedia.org/wiki/Public-key_infrastructure">public-key infrastructure</a> (PKI) scheme, the certificate issuer is a <a href="https://en.wikipedia.org/wiki/Certificate_authority">certificate authority</a> (CA), usually a company that charges customers to issue certificates for them. By contrast, in a web of trust scheme, individuals sign each other&#8217;s keys directly, in a format that performs a similar function to a public key certificate.</p>
</div>
<div class="paragraph">
<p>The most common format for public key certificates is defined by X.509.</p>
</div>
<div class="paragraph">
<p>Because X.509 is very general, the format is further constrained by profiles defined for certain use cases, such as <a href="https://en.wikipedia.org/wiki/PKIX">Public Key Infrastructure (X.509)</a> as defined in <a href="https://tools.ietf.org/html/rfc5280">RFC 5280</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="x-509-public-key-certificates">5. X.509 Public Key Certificates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <a href="https://en.wikipedia.org/wiki/Cryptography">cryptography</a>, <strong>X.509</strong> is a standard defining the format of <a href="https://en.wikipedia.org/wiki/Public_key_certificate">public key certificates</a>.</p>
</div>
<div class="paragraph">
<p>X.509 certificates are used in many Internet protocols, including <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">TLS/SSL</a>, which is the basis for HTTPS, the secure protocol for browsing the web.</p>
</div>
<div class="paragraph">
<p>They are also used in offline applications, like <a href="https://en.wikipedia.org/wiki/Electronic_signature">electronic signatures</a>.</p>
</div>
<div class="paragraph">
<p>X.509 certificates are digital documents that represent a user, computer, service, or device.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They are issued by a <a href="https://en.wikipedia.org/wiki/Certificate_authority">certification authority</a> (CA), subordinate CA, or registration authority or self-signed and contain the public key of the certificate subject.</p>
</li>
<li>
<p>They do not contain the subject&#8217;s private key which must be stored securely.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Public key certificates are documented by <a href="https://tools.ietf.org/html/rfc5280">RFC 5280</a>. They are digitally signed and, in general, contain the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Information about the certificate <strong>subject</strong></p>
</li>
<li>
<p>The <strong>public key</strong> that corresponds to the subject&#8217;s private key</p>
</li>
<li>
<p>Information about the issuing <strong>CA</strong></p>
</li>
<li>
<p>The supported encryption and/or digital <strong>signing algorithms</strong></p>
</li>
<li>
<p>Information to determine the <strong>revocation and validity status</strong> of the certificate</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a certificate is signed by a trusted certificate authority, or validated by other means, someone holding that certificate can rely on the public key it contains to establish secure communications with another party, or validate documents <a href="https://en.wikipedia.org/wiki/Digital_signature">digitally signed</a> by the corresponding private key.</p>
</div>
<div class="sect2">
<h3 id="certificate-fields">5.1. Certificate Fields</h3>
<div class="paragraph">
<p>Over time there have been three certificate versions. Each version adds fields to the one before. Version 3 is current and contains version 1 and version 2 fields in addition to version 3 fields.</p>
</div>
<div class="paragraph">
<p><mark><strong>Version 1</strong></mark> defined the following fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Version</strong>: A value (1, 2, or 3) that identifies the version number of the certificate</p>
</li>
<li>
<p><strong>Serial Number</strong>: A unique number for each certificate issued by a CA</p>
</li>
<li>
<p><strong>CA Signature Algorithm</strong>: Name of the algorithm the CA uses to sign the certificate contents</p>
</li>
<li>
<p><strong>Issuer Name</strong>: The distinguished name (DN) of the certificate&#8217;s issuing CA</p>
</li>
<li>
<p><strong>Validity Period</strong>: The time period for which the certificate is considered valid</p>
</li>
<li>
<p><strong>Subject Name</strong>: Name of the entity represented by the certificate</p>
</li>
<li>
<p><strong>Subject Public Key Info</strong>: Public key owned by the certificate subject</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><mark><strong>Version 2</strong></mark> added the following fields containing information about the certificate issuer. These fields are, however, rarely used.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Issuer Unique ID</strong>: A unique identifier for the issuing CA as defined by the CA</p>
</li>
<li>
<p><strong>Subject Unique ID</strong>: A unique identifier for the certificate subject as defined by the issuing CA</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><mark><strong>Version 3</strong></mark> certificates added the following extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Authority Key Identifier</strong>: This can be one of two values:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>The subject of the CA and serial number of the CA certificate that issued this certificate</p>
</li>
<li>
<p>A hash of the public key of the CA that issued this certificate</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p><strong>Subject Key Identifier</strong>: Hash of the current certificate&#8217;s public key</p>
</li>
<li>
<p><strong>Key Usage</strong> Defines the service for which a certificate can be used.</p>
<div class="paragraph">
<p>This can be one or more of the following values:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>Digital Signature</strong></p>
</li>
<li>
<p><strong>Non-Repudiation</strong></p>
</li>
<li>
<p><strong>Key Encipherment</strong></p>
</li>
<li>
<p><strong>Data Encipherment</strong></p>
</li>
<li>
<p><strong>Key Agreement</strong></p>
</li>
<li>
<p><strong>Key Cert Sign</strong></p>
</li>
<li>
<p><strong>CRL Sign</strong></p>
</li>
<li>
<p><strong>Encipher Only</strong></p>
</li>
<li>
<p><strong>Decipher Only</strong></p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p><strong>Private Key Usage Period</strong>: Validity period for the private key portion of a key pair</p>
</li>
<li>
<p><strong>Certificate Policies</strong>: Policies used to validate the certificate subject</p>
</li>
<li>
<p><strong>Policy Mappings</strong>: Maps a policy in one organization to policy in another</p>
</li>
<li>
<p><strong>Subject Alternative Name</strong>: List of alternate names for the subject</p>
</li>
<li>
<p><strong>Issuer Alternative Name</strong>: List of alternate names for the issuing CA</p>
</li>
<li>
<p><strong>Subject Dir Attribute</strong>: Attributes from an X.500 or LDAP directory</p>
</li>
<li>
<p><strong>Basic Constraints</strong>: Allows the certificate to designate whether it is issued to a CA, or to a user, computer, device, or service.</p>
<div class="paragraph">
<p>This extension also includes a path length constraint that limits the number of subordinate CAs that can exist.</p>
</div>
</li>
<li>
<p><strong>Name Constraints</strong>: Designates which namespaces are allowed in a CA-issued certificate</p>
</li>
<li>
<p><strong>Policy Constraints</strong>: Can be used to prohibit policy mappings between CAs</p>
</li>
<li>
<p><strong>Extended Key Usage</strong>: Indicates how a certificate&#8217;s public key can be used beyond the purposes identified in the <strong>Key Usage</strong> extension</p>
</li>
<li>
<p><strong>CRL Distribution Points</strong>: Contains one or more URLs where the base certificate revocation list (CRL) is published</p>
</li>
<li>
<p><strong>Inhibit anyPolicy</strong>: Inhibits the use of the All Issuance Policies OID (2.5.29.32.0) in subordinate CA certificates</p>
</li>
<li>
<p><strong>Freshest CRL</strong>: Contains one or more URLs where the issuing CA&#8217;s delta CRL is published</p>
</li>
<li>
<p><strong>Authority Information Access</strong>: Contains one or more URLs where the issuing CA certificate is published</p>
</li>
<li>
<p><strong>Subject Information Access</strong>: Contains information about how to retrieve additional details for a certificate subject</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="certificate-formats">5.2. Certificate Formats</h3>
<div class="paragraph">
<p>There are several commonly used filename extensions for X.509 certificates.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>.pem</strong> – (<a href="https://en.wikipedia.org/wiki/Privacy-enhanced_Electronic_Mail">Privacy-enhanced Electronic Mail</a>) <strong>Base64</strong> encoded <a href="https://en.wikipedia.org/wiki/Distinguished_Encoding_Rules"><strong>DER</strong></a> certificate, enclosed between "-----BEGIN CERTIFICATE-----" and "-----END CERTIFICATE-----"</p>
</li>
<li>
<p><strong>.cer</strong>, <strong>.crt</strong>, <strong>.der</strong> – usually in binary DER form, but Base64-encoded certificates are common too</p>
</li>
<li>
<p><strong>.p7b</strong>, <strong>.p7c</strong> – <a href="https://en.wikipedia.org/wiki/PKCS7">PKCS#7</a> SignedData structure without data, just certificate(s) or CRL(s)</p>
</li>
<li>
<p><strong>.p12</strong> – <a href="https://en.wikipedia.org/wiki/PKCS12">PKCS#12</a>, may contain certificate(s) (public) and private keys (password protected)</p>
</li>
<li>
<p><strong>.pfx</strong> – PFX, predecessor of <a href="https://en.wikipedia.org/wiki/PKCS12">PKCS#12</a> (usually contains data in PKCS#12 format, e.g., with PFX files generated in IIS)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/PKCS7">PKCS#7</a> is a standard for signing or encrypting (officially called "enveloping") data. Since the certificate is needed to verify signed data, it is possible to include them in the SignedData structure. A <code>.P7C</code> file is a degenerated SignedData structure, without any data to sign.</p>
</div>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/PKCS12">PKCS#12</a> evolved from the personal information exchange (<strong>PFX</strong>) standard and is used to exchange public and private objects in a single file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="openssl">6. OpenSSL</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>OpenSSL</strong> is a software library for applications that secure communications over computer networks against eavesdropping or need to identify the party at the other end. It is widely used in Internet web servers, serving a majority of all web sites.</p>
</div>
<div class="paragraph">
<p>OpenSSL contains an open-source implementation of the SSL and TLS protocols. The core library, written in the C programming language, implements basic cryptographic functions and provides various utility functions. Wrappers allowing the use of the OpenSSL library in a variety of computer languages are available.</p>
</div>
<div class="paragraph">
<p>The OpenSSL Software Foundation (OSF) represents the OpenSSL project in most legal capacities including contributor license agreements, managing donations, and so on. OpenSSL Software Services (OSS) also represents the OpenSSL project, for Support Contracts.</p>
</div>
<div class="paragraph">
<p>Versions are available for most Unix and Unix-like operating systems (including Solaris, Linux, macOS, QNX, and the various open-source BSD operating systems), OpenVMS and Microsoft Windows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="man">OPENSSL(1SSL)                                                                 OpenSSL                                                                 OPENSSL(1SSL)

NAME
       openssl - OpenSSL command line tool

SYNOPSIS
       openssl command [ command_opts ] [ command_args ]

       openssl list [ standard-commands | digest-commands | cipher-commands | cipher-algorithms | digest-algorithms | public-key-algorithms]

       openssl no-XXX [ arbitrary options ]

DESCRIPTION
       OpenSSL is a cryptography toolkit implementing the Secure Sockets Layer (SSL v2/v3) and Transport Layer Security (TLS v1) network protocols and related
       cryptography standards required by them.

       The openssl program is a command line tool for using the various cryptography functions of OpenSSL's crypto library from the shell.  It can be used for

        o  Creation and management of private keys, public keys and parameters
        o  Public key cryptographic operations
        o  Creation of X.509 certificates, CSRs and CRLs
        o  Calculation of Message Digests
        o  Encryption and Decryption with Ciphers
        o  SSL/TLS Client and Server Tests
        o  Handling of S/MIME signed or encrypted mail
        o  Time Stamp requests, generation and verification

COMMAND SUMMARY
       The openssl program provides a rich variety of commands (command in the SYNOPSIS above), each of which often has a wealth of options and arguments
       (command_opts and command_args in the SYNOPSIS).

       Detailed documentation and use cases for most standard subcommands are available (e.g., x509(1) or openssl-x509(1)).

   Standard Commands
       asn1parse
           Parse an ASN.1 sequence.

       genpkey
           Generation of Private Key or Parameters.

       pkcs12
           PKCS#12 Data Management.

       pkcs7
           PKCS#7 Data Management.

       pkcs8
           PKCS#8 format private key conversion tool.

       pkey
           Public and private key management.

       pkeyutl
           Public key algorithm cryptographic operation utility.

       req
           PKCS#10 X.509 Certificate Signing Request (CSR) Management.

       s_client
           This implements a generic SSL/TLS client which can establish a transparent connection to a remote server speaking SSL/TLS. It's intended for testing
           purposes only and provides only rudimentary interface functionality but internally uses mostly all functionality of the OpenSSL ssl library.

       x509
           X.509 Certificate Data Management.</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="self-signed-certificate">6.1. Self-signed Certificate</h3>
<div class="ulist">
<ul>
<li>
<p>Generate a self signed root certificate</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl req <span class="nt">-x509</span> <span class="se">\</span>
    <span class="nt">-nodes</span> <span class="se">\</span>
    <span class="nt">-newkey</span> rsa:2048 <span class="nt">-keyout</span> key.pem <span class="se">\</span>
    <span class="nt">-days</span> 30 <span class="se">\</span>
    <span class="nt">-out</span> cert.pem <span class="se">\</span>
    <span class="nt">-subj</span> <span class="s2">"/C=CN/ST=Shanghai/L=Shanghai/O=Global Security/OU=IT Department/CN=example.com"</span> <span class="se">\</span>
    <span class="nt">-addext</span> <span class="s2">"subjectAltName=DNS:example.com,DNS:*.example.com"</span></code></pre>
</div>
</div>
</li>
<li>
<p>Generate a self signed root certificate from a private key</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># Generate a 2048 bit RSA key (same as: openssl genrsa -out key.pem 2048)</span>
openssl genpkey <span class="se">\</span>
    <span class="nt">-algorithm</span> RSA <span class="se">\</span>
    <span class="nt">-pkeyopt</span> rsa_keygen_bits:2048 <span class="se">\</span>
    <span class="nt">-out</span> key.pem

<span class="c"># Generate a certificate request from a private key</span>
openssl req <span class="nt">-x509</span> <span class="se">\</span>
    <span class="nt">-new</span> <span class="se">\</span>
    <span class="nt">-key</span> key.pem <span class="se">\</span>
    <span class="nt">-subj</span> <span class="s2">"/C=CN/ST=Shanghai/L=Shanghai/O=Global Security/OU=IT Department/CN=example.com"</span> <span class="se">\</span>
    <span class="nt">-addext</span> <span class="s2">"subjectAltName=DNS:example.com,DNS:*.example.com"</span> <span class="se">\</span>
    <span class="nt">-out</span> cert.pem
<span class="c"># Display the subject and fingerprint of the cert cert.pem</span>
openssl x509 <span class="nt">-in</span> cert.pem <span class="nt">-subject</span> <span class="nt">-ext</span> subjectAltName <span class="nt">-fingerprint</span> <span class="nt">-noout</span> 2&gt;/dev/null</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">subject=C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = example.com
X509v3 Subject Alternative Name:
    DNS:example.com, DNS:*.example.com
SHA1 Fingerprint=43:FA:67:3F:45:95:93:5D:25:BE:15:2E:F1:C4:98:1D:8F:52:77:07</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">#</span><span class="w"> </span>Calculate the fingerprint/thumbprint with .der format
<span class="gp">$</span><span class="w"> </span>openssl x509 <span class="nt">-in</span> baidu.pem <span class="nt">-outform</span> der | <span class="nb">sha1sum</span>
<span class="go">43fa673f4595935d25be152ef1c4981d8f527707  -</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="show-certificate">6.2. Show Certificate:</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>openssl x509 <span class="nt">-in</span> cert.pem <span class="nt">-noout</span> <span class="nt">-issuer</span>
<span class="go">issuer=C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = example.com

</span><span class="gp">$</span><span class="w"> </span>openssl x509 <span class="nt">-in</span> cert.pem <span class="nt">-noout</span> <span class="nt">-subject</span>
<span class="go">subject=C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = example.com

</span><span class="gp">$</span><span class="w"> </span>openssl x509 <span class="nt">-in</span> cert.pem <span class="nt">-noout</span> <span class="nt">-fingerprint</span>
<span class="go">SHA1 Fingerprint=1A:EB:13:40:38:AD:2E:42:57:A6:8A:BB:09:7A:5B:70:8B:69:C6:20

</span><span class="gp">$</span><span class="w"> </span>openssl x509 <span class="nt">-in</span> cert.pem <span class="nt">-noout</span> <span class="nt">-dates</span>
<span class="go">notBefore=Nov  9 06:46:15 2021 GMT
notAfter=Dec  9 06:46:15 2021 GMT

</span><span class="gp">$</span><span class="w"> </span>openssl x509 <span class="nt">-in</span> cert.pem <span class="nt">-noout</span> <span class="nt">-text</span>
<span class="go">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            6d:5e:9d:a3:cc:6f:b8:51:13:46:f6:70:74:cd:3b:6f:ef:5c:6d:6f
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = example.com
        Validity
            Not Before: Dec 21 07:49:22 2021 GMT
            Not After : Jan 20 07:49:22 2022 GMT
        Subject: C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = example.com
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    00:e3:af:8b:6a:2d:63:57:d8:66:01:68:1d:00:39:
                    15:82:e9:d2:9b:8c:77:2b:94:99:6f:b3:b4:43:d5:
                    0e:64:07:32:82:2b:09:96:ce:1f:16:3b:39:dc:13:
                    77:76:a9:3f:52:09:6f:5c:c8:35:cc:06:b0:a0:39:
                    38:ed:37:19:32:fb:6c:37:6f:d8:e5:1c:d0:52:eb:
                    be:c5:de:df:90:8d:3e:cc:0a:1a:d8:ce:27:06:54:
                    5e:b5:d6:68:89:2d:80:d3:09:ef:92:5a:ed:7a:d4:
                    e6:7f:dc:6c:9b:cc:a3:63:fc:9a:cf:98:30:b1:26:
                    a2:25:a4:ea:87:d0:de:d8:b3:83:0b:09:35:34:4b:
                    84:20:dd:dd:4c:67:88:a6:bf:84:b6:2d:0f:62:e1:
                    19:08:f0:f7:05:45:3f:9a:cf:28:33:58:e1:ad:43:
                    bc:b0:51:36:e0:5e:22:f6:95:2f:6a:e3:67:a4:9a:
                    c2:91:fa:d4:94:27:09:4f:56:d1:57:76:c3:0d:d0:
                    74:10:f4:02:44:21:4e:b6:29:50:02:8a:01:3e:60:
                    41:83:af:d2:13:96:05:ad:9f:07:41:2f:ca:f5:67:
                    d5:75:97:48:5a:8f:70:a4:34:df:24:e6:d0:30:6a:
                    c3:a4:7c:7f:5f:34:ac:12:aa:f8:60:72:77:00:93:
                    63:bd
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier:
                DB:44:E6:DA:66:DB:31:57:9D:CF:33:FF:36:3A:D3:B8:4F:6D:E0:86
            X509v3 Authority Key Identifier:
                keyid:DB:44:E6:DA:66:DB:31:57:9D:CF:33:FF:36:3A:D3:B8:4F:6D:E0:86

            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Subject Alternative Name:
                DNS:example.com, DNS:*.example.com
    Signature Algorithm: sha256WithRSAEncryption
         d5:89:de:d1:1d:7a:f2:87:76:32:9c:5a:79:8a:af:0f:6a:44:
         e5:cb:d5:85:14:5f:a5:f6:08:6c:30:82:ad:99:c2:1f:ca:a2:
         56:51:fa:f6:db:64:cd:cf:f4:72:c7:50:84:2d:6f:c6:bf:fa:
         fd:ca:36:80:2a:d1:35:71:87:7f:c2:49:aa:bf:23:da:0b:76:
         3b:75:d7:20:c1:60:5a:4b:74:35:ac:3a:cc:a3:bc:b8:dd:a9:
         76:93:11:ef:e3:fd:f6:c6:dd:eb:46:f1:e3:98:41:6e:aa:b5:
         69:ee:22:d1:5d:55:8e:db:1f:5b:87:a9:9a:0b:45:20:55:36:
         e1:34:2e:0e:a0:53:79:51:30:e4:48:65:ae:ec:d5:9e:be:48:
         65:2d:ca:86:5d:01:5f:df:46:62:bc:ab:3c:03:67:96:95:81:
         43:1d:05:66:3d:6b:11:30:9e:7f:61:11:89:b8:3c:41:a5:05:
         9f:81:d3:14:5b:6d:63:f7:af:ca:71:3c:51:96:ab:72:9a:29:
         d1:68:e3:43:00:a1:f5:a0:50:39:26:eb:50:28:62:77:31:21:
         52:9d:75:a5:ec:04:0e:da:8a:11:8b:71:07:cc:11:63:c7:e0:
         3c:57:95:f1:e2:11:8a:2e:6e:af:c4:8d:65:e9:82:00:05:81:
         12:93:21:bc</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sign-certificate-signing-request">6.3. Sign Certificate Signing Request</h3>
<div class="ulist">
<ul>
<li>
<p>Generate a self signed root certificate</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl req <span class="se">\</span>
    <span class="nt">-x509</span> <span class="se">\</span>
    <span class="nt">-nodes</span> <span class="se">\</span>
    <span class="nt">-newkey</span> rsa:2048 <span class="nt">-keyout</span> ca.key <span class="se">\</span>
    <span class="nt">-subj</span> <span class="s2">"/C=CN/ST=Shanghai/L=Shanghai/O=Global Security/OU=IT Department/CN=example.com"</span> <span class="se">\</span>
    <span class="nt">-out</span> ca.crt</code></pre>
</div>
</div>
</li>
<li>
<p>Generate a certificate signing request</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl req <span class="nt">-nodes</span> <span class="se">\</span>
    <span class="nt">-newkey</span> rsa:2048 <span class="nt">-keyout</span> localhost.key <span class="se">\</span>
    <span class="nt">-subj</span> <span class="s2">"/C=CN/ST=Shanghai/L=Shanghai/O=Global Security/OU=IT Department/CN=localhost"</span> <span class="se">\</span>
    <span class="nt">-out</span> localhost.csr</code></pre>
</div>
</div>
</li>
<li>
<p>Display the contents of the certificate request</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl req <span class="nt">-in</span> localhost.csr <span class="nt">-noout</span> <span class="nt">-text</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="text">Certificate Request:
    Data:
        Version: 1 (0x0)
        Subject: C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = localhost
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    00:d8:eb:2e:d7:3c:94:92:a2:e7:35:e3:45:78:40:
                    f6:76:73:dc:70:b9:c6:2f:6f:ea:f6:9b:da:d2:58:
                    fd:ed:5f:e4:c6:76:56:25:35:e4:27:7b:6d:58:2b:
                    06:71:17:ae:a3:8a:8e:bd:f2:f4:bc:24:64:7d:ea:
                    4f:8a:2b:66:9d:36:e7:6a:23:0e:02:5a:92:b2:1d:
                    a8:95:33:a6:f5:23:a4:9d:2b:c5:50:69:de:fc:f0:
                    c9:4c:f4:6f:5b:cf:6f:20:3e:52:05:02:32:5e:ae:
                    81:50:69:13:ac:c8:fb:d8:b9:b7:78:24:e7:1f:ea:
                    52:6b:f6:ca:71:3e:9c:0a:91:e9:97:59:07:e9:1b:
                    af:1b:c5:c4:14:83:c2:c8:e5:80:cf:bc:4e:ac:65:
                    0f:d7:69:24:eb:3c:2e:51:c9:88:91:4c:33:10:5e:
                    e3:3d:76:42:e1:e1:65:5b:ef:1a:8c:b9:55:92:b4:
                    6b:d7:a3:86:78:36:b7:58:6b:e5:d5:38:07:fa:52:
                    bb:87:a1:ae:38:ce:0f:a5:44:1f:c6:41:b3:f2:9a:
                    1c:2e:22:ea:aa:9f:b0:ec:4a:3b:b8:86:49:08:8c:
                    f9:81:7a:cd:1b:77:b2:31:5e:69:e4:51:cc:a1:1f:
                    ca:01:ce:c1:3a:d7:c8:cf:76:21:44:b3:ed:fc:b9:
                    91:91
                Exponent: 65537 (0x10001)
        Attributes:
            a0:00
    Signature Algorithm: sha256WithRSAEncryption
         b9:6a:c8:d1:7b:5b:c9:d4:b4:b3:8f:ed:93:4f:16:00:44:f1:
         3f:0a:5b:64:d4:71:f2:d7:5b:71:6e:1e:0e:be:3b:8b:a1:f5:
         89:45:b0:33:6c:cf:c1:56:36:71:1a:54:78:d1:2e:90:f6:86:
         f4:99:8e:c6:ee:d7:64:58:37:22:09:5e:5e:cf:09:eb:06:94:
         3b:bc:e7:cd:55:98:48:cf:3e:4c:0a:bd:b7:c5:8d:03:0a:08:
         1c:35:10:fb:78:e7:16:6e:8d:c5:f3:87:5a:f8:2b:cd:4a:94:
         ca:0a:e8:a1:ba:59:96:e7:3d:62:78:5a:a9:24:78:a1:36:6a:
         c1:2b:4f:6b:54:df:34:41:68:49:01:01:e6:ed:61:c1:8e:80:
         d4:93:68:7e:8a:68:82:24:c0:62:e7:9b:77:b1:b1:6c:e0:40:
         b8:4b:64:1b:de:47:a5:1e:6a:21:82:fd:c8:27:50:3f:62:5f:
         c6:12:89:89:4d:85:82:b6:b9:0b:5f:9e:2a:19:94:13:05:d9:
         bb:cc:db:0b:1d:58:04:bf:99:2b:8f:3e:ba:29:11:68:b0:4d:
         58:d7:07:ac:c1:73:6c:80:a4:3c:ca:19:82:6e:fc:5d:44:ce:
         4b:c3:12:8d:6a:35:12:c9:b0:a8:64:47:f7:6d:49:04:68:01:
         ca:b6:6c:11</code></pre>
</div>
</div>
</li>
<li>
<p>Sign a certificate request using the CA certificate above</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl x509 <span class="se">\</span>
    <span class="nt">-req</span> <span class="se">\</span>
    <span class="nt">-in</span> localhost.csr <span class="se">\</span>
    <span class="nt">-CA</span> ca.crt <span class="se">\</span>
    <span class="nt">-CAkey</span> ca.key <span class="se">\</span>
    <span class="nt">-CAcreateserial</span> <span class="se">\</span>
    <span class="nt">-days</span> 10000 <span class="se">\</span>
    <span class="nt">-out</span> localhost.crt</code></pre>
</div>
</div>
</li>
<li>
<p>Display the contents of the certificate</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>openssl x509 <span class="nt">-in</span> localhost.crt <span class="nt">-subject</span> <span class="nt">-issuer</span> <span class="nt">-noout</span>
<span class="go">subject=C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = localhost
issuer=C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = example.com</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="verify-certificate-signature">6.4. Verify Certificate Signature</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>openssl req <span class="nt">-x509</span> <span class="se">\</span>
<span class="go">    -nodes \
    -newkey rsa:2048 -keyout key.pem \
    -days 30 \
    -out cert.pem \
    -subj "/C=CN/ST=Shanghai/L=Shanghai/O=Global Security/OU=IT Department/CN=example.com" \
    -addext "subjectAltName=DNS:example.com,DNS:*.example.com"
Generating a RSA private key
.........................................................+++++
..................+++++
writing new private key to 'key.pem'
-----

</span><span class="gp">$</span><span class="w"> </span>openssl x509 <span class="se">\</span>
<span class="go">    -in cert.pem \
    -text \
    -noout \
    -certopt ca_default \
    -certopt no_validity \
    -certopt no_serial \
    -certopt no_subject \
    -certopt no_extensions \
    -certopt no_signame | \
    grep -v 'Signature Algorithm' | \
    tr -d '[:space:]:' | \
</span><span class="gp">    xxd -r -p &gt;</span><span class="w"> </span>cert-encrypt-sig.bin
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="nb">od</span> <span class="nt">-x</span> <span class="nt">-A</span> n <span class="nt">--endian</span><span class="o">=</span>big cert-encrypt-sig.bin
<span class="go"> af04 bea5 565e d3af 0156 3796 289e 7860
 ba23 969f 7c85 b832 03fc ddb7 1b92 811c
 3e53 42ed 7405 aa1b af10 b5b9 2fdc c821
 1c47 1783 a78c 9765 7964 b064 9e29 e2f2
 9f53 ba98 a533 7589 c6a9 ccf3 d56f dbdb
 e796 99ba 0b5b 9f55 f6a1 407d 7d09 5117
 e5cc 54a2 1748 ef6b c140 1bce c63c 400d
 6faa f5e8 ea8e 2e16 163a 47df 7446 90c6
 4d41 8365 53c1 5d2e 8834 eb1e 185d 516d
 3b17 5b93 1d71 888e 1a0b 17c4 f861 baac
 af8b 441d 0105 08ba 9f1a a8ba 62a5 45f6
 56d8 9177 7bec 488b 58e0 f4f6 ec90 a2ce
 765b 210b b3bd fbc5 38c5 f884 a362 b4d9
 44d1 6718 a86b 6659 7fef 5a92 989f bba6
 1801 15fd b94a 0c8b c169 944c c68c e4f1
 af9b 6c11 bf58 9f8f 765d 0b35 9b81 0c39

</span><span class="gp">$</span><span class="w"> </span>openssl x509 <span class="nt">-in</span> cert.pem <span class="nt">-noout</span> <span class="nt">-text</span>
<span class="c">    ...
</span><span class="go">    Signature Algorithm: sha256WithRSAEncryption
         af:04:be:a5:56:5e:d3:af:01:56:37:96:28:9e:78:60:ba:23:
         96:9f:7c:85:b8:32:03:fc:dd:b7:1b:92:81:1c:3e:53:42:ed:
         74:05:aa:1b:af:10:b5:b9:2f:dc:c8:21:1c:47:17:83:a7:8c:
         97:65:79:64:b0:64:9e:29:e2:f2:9f:53:ba:98:a5:33:75:89:
         c6:a9:cc:f3:d5:6f:db:db:e7:96:99:ba:0b:5b:9f:55:f6:a1:
         40:7d:7d:09:51:17:e5:cc:54:a2:17:48:ef:6b:c1:40:1b:ce:
         c6:3c:40:0d:6f:aa:f5:e8:ea:8e:2e:16:16:3a:47:df:74:46:
         90:c6:4d:41:83:65:53:c1:5d:2e:88:34:eb:1e:18:5d:51:6d:
         3b:17:5b:93:1d:71:88:8e:1a:0b:17:c4:f8:61:ba:ac:af:8b:
         44:1d:01:05:08:ba:9f:1a:a8:ba:62:a5:45:f6:56:d8:91:77:
         7b:ec:48:8b:58:e0:f4:f6:ec:90:a2:ce:76:5b:21:0b:b3:bd:
         fb:c5:38:c5:f8:84:a3:62:b4:d9:44:d1:67:18:a8:6b:66:59:
         7f:ef:5a:92:98:9f:bb:a6:18:01:15:fd:b9:4a:0c:8b:c1:69:
         94:4c:c6:8c:e4:f1:af:9b:6c:11:bf:58:9f:8f:76:5d:0b:35:
         9b:81:0c:39

</span><span class="gp">$</span><span class="w"> </span>openssl pkeyutl <span class="nt">-decrypt</span> <span class="se">\</span>
<span class="go">    -inkey pkc1-key.pem -pkeyopt rsa_padding_mode:none \
    -in cert-sig-decrypted.bin \
    -out cert-decrypted.bin

</span><span class="gp">$</span><span class="w"> </span>openssl asn1parse <span class="nt">-inform</span> der <span class="nt">-in</span> cert-sig-decrypted.bin
<span class="go">    0:d=0  hl=2 l=  49 cons: SEQUENCE
    2:d=1  hl=2 l=  13 cons: SEQUENCE
    4:d=2  hl=2 l=   9 prim: OBJECT            :sha256
   15:d=2  hl=2 l=   0 prim: NULL
   17:d=1  hl=2 l=  32 prim: OCTET STRING      [HEX DUMP]:886B28CF2FF661E2972966C7E5CC175B393F7620C388B25BA027CE92696856DB

</span><span class="gp">$</span><span class="w"> </span>openssl asn1parse <span class="nt">-inform</span> der <span class="nt">-in</span> cert-sig-decrypted.bin <span class="se">\</span>
<span class="go">    | grep 'HEX DUMP' \
    | cut -d ':' -f4 \
    | tr '[:upper:]' '[:lower:]'
886b28cf2ff661e2972966c7e5cc175b393f7620c388b25ba027ce92696856db

</span><span class="gp">$</span><span class="w"> </span>openssl asn1parse <span class="nt">-in</span> cert.pem <span class="nt">-strparse</span> 4 <span class="nt">-noout</span> <span class="nt">-out</span> - <span class="se">\</span>
<span class="go">    | openssl dgst -sha256 \
    | cut -d ' ' -f2
886b28cf2ff661e2972966c7e5cc175b393f7620c388b25ba027ce92696856db</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="generate-certificate-with-subjectaltname">6.5. Generate Certificate with <code>subjectAltName</code></h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl req <span class="nt">-x509</span> <span class="se">\</span>
  <span class="nt">-nodes</span> <span class="se">\</span>
  <span class="nt">-newkey</span> rsa:4096 <span class="se">\</span>
  <span class="nt">-days</span> 3650 <span class="se">\</span>
  <span class="nt">-keyout</span> loca.io.ca.key <span class="se">\</span>
  <span class="nt">-out</span> local.io.ca.crt <span class="se">\</span>
  <span class="nt">-subj</span> <span class="s2">"/C=CN/ST=Shanghai/L=Shanghai/O=Global Security/OU=IT Department/CN=*.local.io"</span> <span class="se">\</span>
<span class="hll">  <span class="nt">-addext</span> <span class="s2">"subjectAltName=DNS:local.io,DNS:*.local.io"</span>
</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>openssl x509 <span class="nt">-in</span> local.io.ca.crt <span class="nt">-noout</span> <span class="nt">-text</span>
<span class="go">Certificate:</span>
<span class="go">    Data:</span>
<span class="go">        Version: 3 (0x2)</span>
<span class="go">. . .</span>
<span class="go">        Subject: C = CN, ST = Shanghai, L = Shanghai, O = Global Security, OU = IT Department, CN = *.local.io</span>
<span class="go">        X509v3 extensions:</span>
<span class="go">            X509v3 Subject Key Identifier:</span>
<span class="go">                35:67:D0:64:8B:2D:F6:62:78:65:CA:6D:A5:6C:FB:4B:67:7F:61:80</span>
<span class="go">            X509v3 Authority Key Identifier:</span>
<span class="go">                keyid:35:67:D0:64:8B:2D:F6:62:78:65:CA:6D:A5:6C:FB:4B:67:7F:61:80</span>

<span class="go">            X509v3 Basic Constraints: critical</span>
<span class="go">                CA:TRUE</span>
<span class="hll"><span class="go">            X509v3 Subject Alternative Name:</span>
</span><span class="hll"><span class="go">                DNS:local.io, DNS:*.local.io</span>
</span><span class="go">. . .</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-csr-with-config-file">6.6. Create CSR with Config File</h3>
<div class="ulist">
<ul>
<li>
<p>Generate a <code>server.key</code> with 2048bit</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl genrsa <span class="nt">-out</span> server.key 2048</code></pre>
</div>
</div>
</li>
<li>
<p>Create a config file (e.g. <em>csr.conf</em>) for generating a CSR</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="conf"><span class="c"># csr.conf
</span>[ <span class="n">req</span> ]
<span class="n">default_bits</span> = <span class="m">2048</span>
<span class="n">prompt</span> = <span class="n">no</span>
<span class="n">default_md</span> = <span class="n">sha256</span>
<span class="n">req_extensions</span> = <span class="n">req_ext</span>
<span class="n">distinguished_name</span> = <span class="n">dn</span>

[ <span class="n">dn</span> ]
<span class="c"># C = &lt;country&gt;
</span><span class="n">C</span> = <span class="n">CN</span>
<span class="c"># ST = &lt;state&gt;
</span><span class="n">ST</span> = <span class="n">Shanghai</span>
<span class="c"># L = &lt;city&gt;
</span><span class="n">L</span> = <span class="n">Shanghai</span>
<span class="c"># O = &lt;organization&gt;
# 1.O = &lt;organization&gt;
# 2.O = &lt;organization&gt;
</span><span class="n">O</span> = <span class="n">IT</span> <span class="n">Department</span>
<span class="c"># OU = &lt;organization unit&gt;
# 1.OU = &lt;organization unit&gt;
# 2.OU = &lt;organization unit&gt;
</span><span class="n">OU</span> = <span class="n">Developer</span>
<span class="c"># CN = &lt;MASTER_IP&gt;
</span><span class="n">CN</span> = <span class="n">developer</span>

[ <span class="n">req_ext</span> ]
<span class="n">subjectAltName</span> = @<span class="n">alt_names</span>

[ <span class="n">alt_names</span> ]
<span class="n">DNS</span>.<span class="m">1</span> = <span class="n">kubernetes</span>
<span class="n">DNS</span>.<span class="m">2</span> = <span class="n">kubernetes</span>.<span class="n">default</span>
<span class="n">DNS</span>.<span class="m">3</span> = <span class="n">kubernetes</span>.<span class="n">default</span>.<span class="n">svc</span>
<span class="n">DNS</span>.<span class="m">4</span> = <span class="n">kubernetes</span>.<span class="n">default</span>.<span class="n">svc</span>.<span class="n">cluster</span>
<span class="n">DNS</span>.<span class="m">5</span> = <span class="n">kubernetes</span>.<span class="n">default</span>.<span class="n">svc</span>.<span class="n">cluster</span>.<span class="n">local</span>
<span class="c">#IP.1 = &lt;MASTER_IP&gt;
</span><span class="n">IP</span>.<span class="m">1</span> = <span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>
<span class="c">#IP.2 = &lt;MASTER_CLUSTER_IP&gt;
</span><span class="n">IP</span>.<span class="m">2</span> = <span class="m">192</span>.<span class="m">168</span>.<span class="m">91</span>.<span class="m">128</span>

[ <span class="n">v3_ext</span> ]
<span class="n">authorityKeyIdentifier</span>=<span class="n">keyid</span>,<span class="n">issuer</span>:<span class="n">always</span>
<span class="n">basicConstraints</span>=<span class="n">CA</span>:<span class="n">FALSE</span>
<span class="n">keyUsage</span>=<span class="n">keyEncipherment</span>,<span class="n">dataEncipherment</span>
<span class="n">extendedKeyUsage</span>=<span class="n">serverAuth</span>,<span class="n">clientAuth</span>
<span class="n">subjectAltName</span>=@<span class="n">alt_names</span></code></pre>
</div>
</div>
</li>
<li>
<p>Generate the certificate signing request based on the config file</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl req <span class="nt">-new</span> <span class="nt">-key</span> server.key <span class="nt">-out</span> server.csr <span class="nt">-config</span> csr.conf</code></pre>
</div>
</div>
</li>
<li>
<p>Generate the server certificate using the ca.key, ca.crt and server.csr</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl x509 <span class="se">\</span>
    <span class="nt">-req</span> <span class="se">\</span>
    <span class="nt">-in</span> server.csr <span class="se">\</span>
    <span class="nt">-CA</span> ca.crt <span class="nt">-CAkey</span> ca.key <span class="se">\</span>
    <span class="nt">-CAcreateserial</span> <span class="se">\</span>
    <span class="nt">-days</span> 10000 <span class="se">\</span>
    <span class="nt">-extensions</span> v3_ext <span class="se">\</span>
    <span class="nt">-extfile</span> csr.conf <span class="se">\</span>
    <span class="nt">-out</span> server.crt</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="how-to-convert-a-certificate-into-the-appropriate-format">6.7. How to Convert a Certificate into the Appropriate Format</h3>
<div class="paragraph">
<p>If your server/device requires a different certificate format other than Base64 encoded X.509, a third party tool such as <a href="https://www.openssl.org">OpenSSL</a> can be used to convert the certificates into the appropriate format.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <strong>PEM</strong> format is the most common format used for certificates. Extensions used for PEM certificates are cer, crt, and pem. They are Base64 encoded ASCII files.</p>
</div>
<div class="paragraph">
<p>The <strong>DER</strong> format is the binary form of the certificate. DER formatted certificates do not contain the "BEGIN CERTIFICATE/END CERTIFICATE" statements. DER formatted certificates most often use the '.der' extension.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Convert x509 to PEM</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl x509 <span class="nt">-in</span> certificatename.cer <span class="nt">-outform</span> PEM <span class="nt">-out</span> certificatename.pem</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Convert PEM to DER</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl x509 <span class="nt">-outform</span> der <span class="nt">-in</span> certificatename.pem <span class="nt">-out</span> certificatename.der</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Convert DER to PEM</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl x509 <span class="nt">-inform</span> der <span class="nt">-in</span> certificatename.der <span class="nt">-out</span> certificatename.pem</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Convert pfx to PEM</strong></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The PKCS#12 or PFX format is a binary format for storing the server certificate, intermediate certificates, and the private key in one encryptable file. PFX files usually have extensions such as .pfx and .p12. PFX files are typically used on Windows machines to import and export certificates and private keys.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl pkcs12 <span class="nt">-in</span> certificatename.pfx <span class="nt">-out</span> certificatename.pem</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Convert CER and Private Key to PFX</strong></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">openssl pkcs12 <span class="nt">-export</span> <span class="nt">-in</span> certificatename.cer <span class="nt">-inkey</span> privateKey.key <span class="nt">-out</span> certificatename.pfx <span class="nt">-certfile</span>  cacert.cer</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="references">7. References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Cryptosystem" class="bare">https://en.wikipedia.org/wiki/Cryptosystem</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Public-key_cryptography" class="bare">https://en.wikipedia.org/wiki/Public-key_cryptography</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem" class="bare">https://en.wikipedia.org/wiki/RSA_(cryptosystem</a>)</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm" class="bare">https://en.wikipedia.org/wiki/Symmetric-key_algorithm</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/azure/iot-hub/tutorial-x509-introduction" class="bare">https://docs.microsoft.com/en-us/azure/iot-hub/tutorial-x509-introduction</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/azure/iot-hub/tutorial-x509-certificates" class="bare">https://docs.microsoft.com/en-us/azure/iot-hub/tutorial-x509-certificates</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/X.509" class="bare">https://en.wikipedia.org/wiki/X.509</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc5280" class="bare">https://tools.ietf.org/html/rfc5280</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/X.690#DER_encoding" class="bare">https://en.wikipedia.org/wiki/X.690#DER_encoding</a></p>
</li>
<li>
<p><a href="https://en.m.wikipedia.org/wiki/ASN.1" class="bare">https://en.m.wikipedia.org/wiki/ASN.1</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" class="bare">https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/PKCS" class="bare">https://en.wikipedia.org/wiki/PKCS</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Certificate_signing_request" class="bare">https://en.wikipedia.org/wiki/Certificate_signing_request</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/OpenSSL" class="bare">https://en.wikipedia.org/wiki/OpenSSL</a></p>
</li>
<li>
<p><a href="https://www.digicert.com/kb/ssl-support/openssl-quick-reference-guide.htm" class="bare">https://www.digicert.com/kb/ssl-support/openssl-quick-reference-guide.htm</a></p>
</li>
<li>
<p><a href="https://knowledge.digicert.com/solution/SO26449.html" class="bare">https://knowledge.digicert.com/solution/SO26449.html</a></p>
</li>
</ul>
</div>
</div>
</div>
  </div>

  <ul class="post-navigation">
    <li>
      
      <a href="/2019/01/28/bootstrapping-kubernetes-clusters-with-kubeadm/">&laquo; Bootstrapping Kubernetes Clusters with kubeadm</a>
      
    </li>
    <li>
      
      <a href="/2019/02/01/access-kubernetes-api-with-client-certificates/">Access Kubernetes API with Client Certificates &raquo;</a>
      
    </li>
  </ul>
</article>

      </div>
    </div>

    <footer class="site-footer">
  <div class="license">
    <span>Article licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></span>
  </div>
  
  <details open>
    <summary>Extral Links</summary>
    <div>
      
      <a href="https://jekyllrb.com/">Jekyll</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://shopify.github.io/">Liquid</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://docs.asciidoctor.org/">Asciidoctor</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://github.com/qqbuby/">GitHub</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="/feed.xml">RSS</a>
      
      
    </div>
  </details>
  
</footer>


<!-- https://github.com/bryanbraun/anchorjs -->
<script src="/js/anchor.min.js"></script>
<script>
  anchors.add();
  anchors.remove(".site-title");
</script>




  </body>

</html>
